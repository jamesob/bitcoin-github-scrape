[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/631599290",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-631599290",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
    "id": 631599290,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzMTU5OTI5MA==",
    "user": {
      "login": "dongcarl",
      "id": 3445290,
      "node_id": "MDQ6VXNlcjM0NDUyOTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3445290?u=62e3204f6586795420395a7059ec7dc7c4a40c7d&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dongcarl",
      "html_url": "https://github.com/dongcarl",
      "followers_url": "https://api.github.com/users/dongcarl/followers",
      "following_url": "https://api.github.com/users/dongcarl/following{/other_user}",
      "gists_url": "https://api.github.com/users/dongcarl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
      "organizations_url": "https://api.github.com/users/dongcarl/orgs",
      "repos_url": "https://api.github.com/users/dongcarl/repos",
      "events_url": "https://api.github.com/users/dongcarl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dongcarl/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-20T16:55:57Z",
    "updated_at": "2020-05-20T16:55:57Z",
    "author_association": "CONTRIBUTOR",
    "body": "Concept ACK :smile: \r\n\r\nAm I correct in saying that you've replaced `NetworkID` in my implementation with `Bip155NetworkId`? (totally fine btw, just wanted to make sure)",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/631599290/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/631603514",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-631603514",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
    "id": 631603514,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzMTYwMzUxNA==",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?u=13b19d1ff2f5f914e180c41418f451a4ba6f8bd1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-20T17:03:29Z",
    "updated_at": "2020-05-20T17:03:29Z",
    "author_association": "MEMBER",
    "body": "Concept ACK!",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/631603514/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/631641564",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-631641564",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
    "id": 631641564,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzMTY0MTU2NA==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-20T18:17:27Z",
    "updated_at": "2020-05-20T18:17:27Z",
    "author_association": "CONTRIBUTOR",
    "body": "> Am I correct in saying that you've replaced `NetworkID` in my implementation with `Bip155NetworkId`? (totally fine btw, just wanted to make sure)\r\n\r\nYes, thanks for asking!\r\n\r\nIdeally we would have just one `enum` for network types, not two. That would contain the network ids from BIP155 + the other ones we have now - unroutable, internal/name, etc. But the problem is that lots of code relies on the values being sequential - there are loops from `0` to `NET_MAX`. I did not wanted to plant e.g. \"unroutable\" as `0x07` just after `CJDNS` or to change those loops and assumptions because it would bloat this PR too much.\r\n\r\nSo I introduced a second `enum` but made it private inside `CNetAddr` and named it `BIP155...` to denote that it contains just the networks mentioned in BIP155 and nothing else.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/631641564/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/631662338",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-631662338",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
    "id": 631662338,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzMTY2MjMzOA==",
    "user": {
      "login": "DrahtBot",
      "id": 39886733,
      "node_id": "MDQ6VXNlcjM5ODg2NzMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/39886733?u=3c1e73d828cf5a5850dfc25c8397c1cf751db5ac&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DrahtBot",
      "html_url": "https://github.com/DrahtBot",
      "followers_url": "https://api.github.com/users/DrahtBot/followers",
      "following_url": "https://api.github.com/users/DrahtBot/following{/other_user}",
      "gists_url": "https://api.github.com/users/DrahtBot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
      "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
      "repos_url": "https://api.github.com/users/DrahtBot/repos",
      "events_url": "https://api.github.com/users/DrahtBot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-20T18:57:20Z",
    "updated_at": "2020-09-29T02:16:36Z",
    "author_association": "CONTRIBUTOR",
    "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #20028 (test: Check that invalid peer traffic is accounted for by MarcoFalke)\n* #19889 (test: Add consistent formatting for messages.py repr methods by adaminsky)\n* #19763 (net: don't try to relay to the address' originator by vasild)\n* #19315 ([tests] Allow outbound & block-relay-only connections in functional tests. by amitiuttarwar)\n* #19238 (refactor: Replace RecursiveMutex with Mutex in CAddrMan by hebasto)\n* #18642 (Use std::chrono for the time to rotate destination of addr messages + tests by naumenkogs)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/631662338/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/631755683",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-631755683",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
    "id": 631755683,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzMTc1NTY4Mw==",
    "user": {
      "login": "naumenkogs",
      "id": 7975071,
      "node_id": "MDQ6VXNlcjc5NzUwNzE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7975071?u=06eb9ae4f9b3f954056098860decccbf1340e40f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/naumenkogs",
      "html_url": "https://github.com/naumenkogs",
      "followers_url": "https://api.github.com/users/naumenkogs/followers",
      "following_url": "https://api.github.com/users/naumenkogs/following{/other_user}",
      "gists_url": "https://api.github.com/users/naumenkogs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
      "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
      "repos_url": "https://api.github.com/users/naumenkogs/repos",
      "events_url": "https://api.github.com/users/naumenkogs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-20T22:13:21Z",
    "updated_at": "2020-05-20T22:13:21Z",
    "author_association": "MEMBER",
    "body": "Concept ACK. WIll do a good review later.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/631755683/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/638844175",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-638844175",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
    "id": 638844175,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzODg0NDE3NQ==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-06-04T13:23:13Z",
    "updated_at": "2020-06-04T13:23:13Z",
    "author_association": "CONTRIBUTOR",
    "body": "Rebased.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/638844175/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/641499477",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-641499477",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
    "id": 641499477,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY0MTQ5OTQ3Nw==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-06-09T18:40:39Z",
    "updated_at": "2020-06-09T18:40:39Z",
    "author_association": "CONTRIBUTOR",
    "body": "Changed the implementation to use dedicated message `sendaddrv2` for signaling support instead of a service bit. The code complexity is about the same, the dedicated message needs a few more lines, [d85215213..9a526f22b](https://github.com/bitcoin/bitcoin/compare/d85215213..9a526f22b):\r\n```\r\n src/init.cpp                                |  2 +-\r\n src/net.h                                   |  3 ++-\r\n src/net_processing.cpp                      | 10 +++++++++-\r\n src/protocol.cpp                            |  3 ++-\r\n src/protocol.h                              |  8 ++++++--\r\n test/functional/p2p_leak.py                 |  1 +\r\n test/functional/p2p_node_network_limited.py |  4 ++--\r\n test/functional/test_framework/messages.py  | 18 +++++++++++++++++-\r\n test/functional/test_framework/mininode.py  |  3 +++\r\n 9 files changed, 43 insertions(+), 9 deletions(-)\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/641499477/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/641506189",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-641506189",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
    "id": 641506189,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY0MTUwNjE4OQ==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-06-09T18:54:38Z",
    "updated_at": "2020-06-09T18:54:38Z",
    "author_association": "CONTRIBUTOR",
    "body": "Rebased.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/641506189/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/641772444",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-641772444",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
    "id": 641772444,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY0MTc3MjQ0NA==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-06-10T06:58:33Z",
    "updated_at": "2020-06-10T06:58:33Z",
    "author_association": "CONTRIBUTOR",
    "body": "Rebased.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/641772444/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/641942869",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-641942869",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
    "id": 641942869,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY0MTk0Mjg2OQ==",
    "user": {
      "login": "naumenkogs",
      "id": 7975071,
      "node_id": "MDQ6VXNlcjc5NzUwNzE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7975071?u=06eb9ae4f9b3f954056098860decccbf1340e40f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/naumenkogs",
      "html_url": "https://github.com/naumenkogs",
      "followers_url": "https://api.github.com/users/naumenkogs/followers",
      "following_url": "https://api.github.com/users/naumenkogs/following{/other_user}",
      "gists_url": "https://api.github.com/users/naumenkogs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
      "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
      "repos_url": "https://api.github.com/users/naumenkogs/repos",
      "events_url": "https://api.github.com/users/naumenkogs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-06-10T11:34:04Z",
    "updated_at": "2020-06-10T11:34:04Z",
    "author_association": "MEMBER",
    "body": "I reviewed the code and it looks sane.\r\n\r\nI believe all the questionable parts about BIP155 are not included here? Making this PR more or less ready to review without high-level discussions.\r\n\r\nWe probably need much more eyes, there's just too much low level code changes.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/641942869/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/641979759",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-641979759",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
    "id": 641979759,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY0MTk3OTc1OQ==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-06-10T12:40:28Z",
    "updated_at": "2020-06-10T12:40:28Z",
    "author_association": "CONTRIBUTOR",
    "body": "> I believe all the questionable parts about BIP155 are not included here? Making this PR more or less ready to review without high-level discussions.\r\n\r\nThis PR is a full implementation of ADDRv2. However:\r\n\r\n* The maximum length of an address, mentioned in BIP155 is 32 bytes, whereas this PR has set it to 512 bytes.\r\n* Signaling for ADDRv2 support is done by a protocol version bump in BIP155, whereas this PR does it by a new dedicated message `sendaddrv2`.\r\n\r\nhttps://github.com/bitcoin/bips/pull/907 should align the code and the spec.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/641979759/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/646633241",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-646633241",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
    "id": 646633241,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY0NjYzMzI0MQ==",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?u=3f68150a5f30acd541d1ed279376cd20b78046b1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-06-19T13:23:06Z",
    "updated_at": "2020-06-19T13:23:06Z",
    "author_association": "MEMBER",
    "body": "Concept ACK. At a high level the code looks well-done. Looked through the BIP and the previous PR.\r\n\r\nI wonder if this would make faster progress if it was turned into a master roadmap PR and split into easier-to-review PRs similar to what we've seen with the serialization refactoring. (A possible key to consider in making that work, if you do it, may be to take the time to set a clear map from the start so as to not change it midway, have to backtrack, or invalidate in-progress review.)",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/646633241/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/647531927",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-647531927",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
    "id": 647531927,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY0NzUzMTkyNw==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-06-22T13:49:49Z",
    "updated_at": "2020-06-22T13:49:49Z",
    "author_association": "CONTRIBUTOR",
    "body": "> I wonder if this would make faster progress if ... split into easier-to-review PRs ...\r\n\r\nMy thought exactly! Let's start with something small and see how it goes: https://github.com/bitcoin/bitcoin/pull/19351.\r\n\r\nI updated the roadmap at: https://github.com/bitcoin/bitcoin/issues/18884, this PR can be split in:\r\n\r\nPreparation cleanup\r\n---\r\n```\r\ntest: add an edge case test for CSubNet\r\nnet: improve encapsulation of CNetAddr\r\nnet: document `enum Network`\r\nnet: save the network type explicitly in CNetAddr\r\n```\r\n\r\nChange `CNetAddr::ip` to have flexible size\r\n---\r\n```\r\nnet: change CNetAddr::ip to have flexible size\r\n```\r\n\r\nImplement `addrv2` (un)serializing\r\n---\r\n```\r\nnet: CAddress & CAddrMan: (un)serialize as ADDRv2\r\nnet: CNetAddr: add support to (un)serialize as ADDRv2\r\ntest: add CAddress serialization tests\r\n```\r\n\r\nAdvertise support for `addrv2` and start sending such messages to peers\r\n---\r\n```\r\nnet: advertise support for ADDRv2 via new message\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/647531927/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/647535424",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-647535424",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
    "id": 647535424,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY0NzUzNTQyNA==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-06-22T13:55:43Z",
    "updated_at": "2020-06-22T13:55:43Z",
    "author_association": "CONTRIBUTOR",
    "body": "Rebased.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/647535424/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/647537878",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-647537878",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
    "id": 647537878,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY0NzUzNzg3OA==",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?u=3f68150a5f30acd541d1ed279376cd20b78046b1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-06-22T13:59:47Z",
    "updated_at": "2020-06-22T14:01:45Z",
    "author_association": "MEMBER",
    "body": "Can you update the PR descriptions of this PR and 18884 with the roadmap and to indicate clearly which PRs correspond to which step and which PR of the 3 that are open should currently be reviewed? Review can be hard to obtain; best to make it easy and clear for your reviewers.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/647537878/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/647738511",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-647738511",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
    "id": 647738511,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY0NzczODUxMQ==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-06-22T19:55:42Z",
    "updated_at": "2020-06-22T19:55:42Z",
    "author_association": "CONTRIBUTOR",
    "body": "Rebased, removing commit `test: add an edge case test for CSubNet` which was merged via https://github.com/bitcoin/bitcoin/pull/19351",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/647738511/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/648192113",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-648192113",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
    "id": 648192113,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY0ODE5MjExMw==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-06-23T14:26:55Z",
    "updated_at": "2020-06-23T14:26:55Z",
    "author_association": "CONTRIBUTOR",
    "body": "> Can you update the PR descriptions...\r\n\r\nDone. In summary - https://github.com/bitcoin/bitcoin/issues/18884 is a roadmap for Tor v3. It is just an issue, does not contain code and this PR is part of that roadmap. https://github.com/bitcoin/bitcoin/pull/19351 already got merged (Thanks!). I chopped off the next one at https://github.com/bitcoin/bitcoin/pull/19360. It is happening!",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/648192113/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/654259883",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-654259883",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
    "id": 654259883,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1NDI1OTg4Mw==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-06T14:04:44Z",
    "updated_at": "2020-07-06T14:04:44Z",
    "author_association": "CONTRIBUTOR",
    "body": "Rebased to restart CI",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/654259883/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/656691574",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-656691574",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
    "id": 656691574,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1NjY5MTU3NA==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-10T13:59:25Z",
    "updated_at": "2020-07-10T13:59:25Z",
    "author_association": "CONTRIBUTOR",
    "body": "I simplified the code a little bit, now that `CNetAddr::GetAddrBytes()` has been added to `master`.\r\n\r\n#19219 introduced a new method [CNetAddr::GetAddrBytes()](https://github.com/bitcoin/bitcoin/blob/0d69fdb/src/netaddress.h#L93) in `master` which does the same thing as [CNetAddr::GetAddrKey()](https://github.com/bitcoin/bitcoin/blob/567f98ea5d33d8cec699148be83b079dd5189101/src/netaddress.cpp#L554) (introduced in this PR).\r\n\r\nSo, change this PR to use the existent `CNetAddr::GetAddrBytes()` and don't introduce a new method.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/656691574/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/656817252",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-656817252",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
    "id": 656817252,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1NjgxNzI1Mg==",
    "user": {
      "login": "Saibato",
      "id": 34917548,
      "node_id": "MDQ6VXNlcjM0OTE3NTQ4",
      "avatar_url": "https://avatars.githubusercontent.com/u/34917548?u=599ab1f4da03ca95d97224c2c2431a52e938d24e&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Saibato",
      "html_url": "https://github.com/Saibato",
      "followers_url": "https://api.github.com/users/Saibato/followers",
      "following_url": "https://api.github.com/users/Saibato/following{/other_user}",
      "gists_url": "https://api.github.com/users/Saibato/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Saibato/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Saibato/subscriptions",
      "organizations_url": "https://api.github.com/users/Saibato/orgs",
      "repos_url": "https://api.github.com/users/Saibato/repos",
      "events_url": "https://api.github.com/users/Saibato/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Saibato/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-10T18:21:41Z",
    "updated_at": "2020-07-10T18:23:11Z",
    "author_association": "CONTRIBUTOR",
    "body": "While testing https://github.com/bitcoin/bitcoin/commit/81780afb3b4575642f74b682327ff1c78b6efaa7\r\nI saw that v3 are advertised as  [::]:0  and ToString resulted also in  [::]:0\r\n\r\n```\r\n2020-07-10T17:43:18Z sending feefilter (8 bytes) peer=0\r\n2020-07-10T17:43:18Z trying connection [::]:0 lastseen=0.0hrs\r\n2020-07-10T17:43:18Z SOCKS5 connecting [::]:0\r\n2020-07-10T17:43:18Z Socks5() connect to [::]:0:18444 failed: general failure\r\n````\r\n\r\nWith that Nit changes in the patch, The correct V3 long address is displayed and get an advertised reconnect at reboot.  \r\nWith that minor changes I had some success and so far https://github.com/bitcoin/bitcoin/commit/81780afb3b4575642f74b682327ff1c78b6efaa7 LGTM\r\n\r\nHope that helps...\r\nBtw. if you  git pull  https://github.com/Saibato/bitcoin add-ed25519 on top you have v3 onion on the fly for testing.  #19485\r\n\r\n\r\n``` Diff\r\ndiff --git a/src/netaddress.cpp b/src/netaddress.cpp\r\nindex 1ac99ddd1..0171b1d80 100644\r\n--- a/src/netaddress.cpp\r\n+++ b/src/netaddress.cpp\r\n@@ -21,6 +21,7 @@ CNetAddr::Bip155NetworkId CNetAddr::ToBIP155NetworkId() const\r\n     case NET_ONION:\r\n         switch (m_addr.size()) {\r\n         case ADDR_TORv2_SIZE: return Bip155NetworkId::TORv2;\r\n+        case ADDR_TORv3_SIZE: return Bip155NetworkId::TORv3;\r\n         default: assert(!\"Unexpected TOR address size\");\r\n         }\r\n     case NET_UNROUTABLE:\r\n@@ -58,6 +59,11 @@ bool CNetAddr::FromBIP155NetworkId(Bip155NetworkId bip155_network_id,\r\n         }\r\n         return false;\r\n     case Bip155NetworkId::TORv3:\r\n+        if (address_size == ADDR_TORv3_SIZE) {\r\n+           net = NET_ONION;\r\n+           return true;\r\n+        }\r\n+        return false;\r\n     case Bip155NetworkId::I2P:\r\n     case Bip155NetworkId::CJDNS:\r\n         return false;\r\n@@ -137,7 +143,7 @@ bool CNetAddr::SetSpecial(const std::string &strName)\r\n {\r\n     if (strName.size()>6 && strName.substr(strName.size() - 6, 6) == \".onion\") {\r\n         std::vector<unsigned char> vchAddr = DecodeBase32(strName.substr(0, strName.size() - 6).c_str());\r\n-        if (vchAddr.size() != ADDR_TORv2_SIZE)\r\n+        if (vchAddr.size() != ADDR_TORv2_SIZE && vchAddr.size() != ADDR_TORv3_SIZE)\r\n             return false;\r\n         m_net = NET_ONION;\r\n         m_addr = vchAddr;\r\ndiff --git a/src/netaddress.h b/src/netaddress.h\r\nindex 0a94f0587..baf7d29a2 100644\r\n--- a/src/netaddress.h\r\n+++ b/src/netaddress.h\r\n@@ -81,6 +81,10 @@ static constexpr size_t ADDR_IPv6_SIZE = 16;\r\n /// Size of TORv2 address (in bytes).\r\n static constexpr size_t ADDR_TORv2_SIZE = 10;\r\n \r\n+/// Size of TORv3 address (in bytes).\r\n+static constexpr size_t ADDR_TORv3_SIZE = 35;\r\n+\r\n+\r\n /// Size of \"internal\" (NET_INTERNAL) address (in bytes).\r\n static constexpr size_t ADDR_INTERNAL_SIZE = 10;\r\n \r\n@@ -259,10 +263,12 @@ class CNetAddr\r\n                 memcpy(arr, m_addr.data(), m_addr.size());\r\n                 break;\r\n             case NET_ONION:\r\n+                if (ToBIP155NetworkId() == Bip155NetworkId::TORv2) {\r\n                 prefix_size = sizeof(TORv2_IN_IPv6_PREFIX);\r\n                 assert(m_addr.size() + prefix_size == sizeof(arr));\r\n                 memcpy(arr, TORv2_IN_IPv6_PREFIX, prefix_size);\r\n                 memcpy(arr + prefix_size, m_addr.data(), m_addr.size());\r\n+                }\r\n                 break;\r\n             case NET_INTERNAL:\r\n                 prefix_size = sizeof(INTERNAL_IN_IPv6_PREFIX);\r\n\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/656817252/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/657058225",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-657058225",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
    "id": 657058225,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1NzA1ODIyNQ==",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?u=3f68150a5f30acd541d1ed279376cd20b78046b1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-11T12:50:04Z",
    "updated_at": "2020-07-11T12:50:04Z",
    "author_association": "MEMBER",
    "body": "Can someone with label permissions add a `Review club` label to this PR?\r\n\r\nResource up soon at https://bitcoincore.reviews/19031.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/657058225/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/657588386",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-657588386",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
    "id": 657588386,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1NzU4ODM4Ng==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-13T14:18:15Z",
    "updated_at": "2020-07-13T14:18:15Z",
    "author_association": "CONTRIBUTOR",
    "body": "@Saibato, thanks for testing this! To get this moving faster, maybe you can review https://github.com/bitcoin/bitcoin/pull/19360?\r\n\r\nThe changes you posted above and some of https://github.com/bitcoin/bitcoin/pull/19485 belong to a \"Tor v3\" implementation, which is out of the scope of this PR. It is the last item in the roadmap at https://github.com/bitcoin/bitcoin/issues/18884, the one that reads \"Implement Tor v3 on top of that\". I wonder if it would be too confusing to create a PR that is based on this PR (contains all of its commits) + more commits for Tor v3 implementation. I have been refraining from doing that as it could cause further confusion and more importantly, would be a distraction at this stage.\r\n\r\nI think the focus now should be on reviewing and testing this PR - addrv2 support for existent networks (e.g. IPv4, IPv6, Torv2).",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/657588386/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/658155790",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-658155790",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
    "id": 658155790,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1ODE1NTc5MA==",
    "user": {
      "login": "Saibato",
      "id": 34917548,
      "node_id": "MDQ6VXNlcjM0OTE3NTQ4",
      "avatar_url": "https://avatars.githubusercontent.com/u/34917548?u=599ab1f4da03ca95d97224c2c2431a52e938d24e&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Saibato",
      "html_url": "https://github.com/Saibato",
      "followers_url": "https://api.github.com/users/Saibato/followers",
      "following_url": "https://api.github.com/users/Saibato/following{/other_user}",
      "gists_url": "https://api.github.com/users/Saibato/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Saibato/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Saibato/subscriptions",
      "organizations_url": "https://api.github.com/users/Saibato/orgs",
      "repos_url": "https://api.github.com/users/Saibato/repos",
      "events_url": "https://api.github.com/users/Saibato/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Saibato/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-14T12:39:47Z",
    "updated_at": "2020-07-14T17:28:19Z",
    "author_association": "CONTRIBUTOR",
    "body": "> #19360\r\n\r\nLast week i stumbled about this and i feel a bit sorry for you and the effort and work you put in this. that i looked not earlier in v3 support in bitcoin for the masses.  I reviewed this as part of https://github.com/bitcoin/bitcoin/commit/2533ce03c71a865ba230b7ff770dd04cd8be5ea1 and although i stated LGTM and that your code works, the whole ADDRv2 thing is a full NACK  and my view on c++ auto const and code tautologies and pointless erotic refactor you know already, i guess, when it comes to replace IP  ( The address as of  RFC 4291 https://tools.ietf.org/html/rfc4291  ) with something else non IP, and call it in the code ip,  i am strong oppose that.\r\n\r\nThe way bitcoin piggy packs right now v2 onions in non routeable ipv6 or ipv4 in ipv6 seems to me the right way to do this for any extension.  Since all those protocols are anyway socks5 kind of proxied FQDN i vote for add fqdn to CNetAddr for local storage and not to change CService and the network ADDR protocol\r\n\r\nAny change at central points make me nervous, so please prove me wrong.\r\nAnd please don't tempt me with you cant do this or that because off *impossible*, i can and I will.\r\n\r\nEDIT: nit when review, and dissam/\r\nI like to mention here how critical it can be to have the correct byte order of ip.\r\n\r\nGuess what *friend* of free uncensored internet registered 1.0.0.0/24 ?\r\n0.0.1.in-addr.arpa.\t3600\tIN\tSOA  jasmine.ns.cloudflare.com. dns.cloudflare.com\r\n\r\nSo if extensive use of library c++ voodoo, make absolutely sure to get i.e. the 127.0.0.1 assembled correctly in the ip  <vector> after <<. it might otherwise resolve in an hopefully unexpected unintended way. :woman_shrugging: \r\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/658155790/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/658739350",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-658739350",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
    "id": 658739350,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1ODczOTM1MA==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-15T12:31:11Z",
    "updated_at": "2020-07-15T12:31:11Z",
    "author_association": "CONTRIBUTOR",
    "body": "@Saibato IMO sending IPv4, Tor or other addresses disguised as IPv6 addresses is a hack and it wastes space and bandwidth (it sends 16 bytes instead of e.g. 4). Furthermore this hack is limited because one cannot send addresses that are longer than 16 bytes.\r\n\r\nADDRv2 solves this in a clean way with the variable address length, allowing us to send longer addresses and also to avoid the 16-instead-of-4 bytes bloat.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/658739350/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/658782327",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-658782327",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
    "id": 658782327,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1ODc4MjMyNw==",
    "user": {
      "login": "Saibato",
      "id": 34917548,
      "node_id": "MDQ6VXNlcjM0OTE3NTQ4",
      "avatar_url": "https://avatars.githubusercontent.com/u/34917548?u=599ab1f4da03ca95d97224c2c2431a52e938d24e&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Saibato",
      "html_url": "https://github.com/Saibato",
      "followers_url": "https://api.github.com/users/Saibato/followers",
      "following_url": "https://api.github.com/users/Saibato/following{/other_user}",
      "gists_url": "https://api.github.com/users/Saibato/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Saibato/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Saibato/subscriptions",
      "organizations_url": "https://api.github.com/users/Saibato/orgs",
      "repos_url": "https://api.github.com/users/Saibato/repos",
      "events_url": "https://api.github.com/users/Saibato/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Saibato/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-15T13:54:52Z",
    "updated_at": "2020-07-15T14:13:39Z",
    "author_association": "CONTRIBUTOR",
    "body": ">  Furthermore this hack is limited because one cannot send addresses that are longer than 16 bytes.\r\n\r\n@vasild at some point. yes and i dont say your work is void, in someway we got futher, but please lock at the diff, it can be done and i have done it. \r\n\r\nOk prob i should hash the seq and send a bit less bytes and do some checking but the patch works right away on top of all nodes out there AFAICS and can support any sort of address.\r\n \r\n<details><summary>Code diff</summary>\r\n\r\n``` Diff\r\ndiff --git a/src/addrman.h b/src/addrman.h\r\nindex 8e82020df..4a810e53f 100644\r\n--- a/src/addrman.h\r\n+++ b/src/addrman.h\r\n@@ -61,6 +61,7 @@ public:\r\n     SERIALIZE_METHODS(CAddrInfo, obj)\r\n     {\r\n         READWRITEAS(CAddress, obj);\r\n+        READWRITEAS(CNetAddr, obj);\r\n         READWRITE(obj.source, obj.nLastSuccess, obj.nAttempts);\r\n     }\r\n \r\ndiff --git a/src/net.cpp b/src/net.cpp\r\nindex 244b0094d..36af03d33 100644\r\n--- a/src/net.cpp\r\n+++ b/src/net.cpp\r\n@@ -156,6 +156,7 @@ static std::vector<CAddress> convertSeed6(const std::vector<SeedSpec6> &vSeedsIn\r\n         struct in6_addr ip;\r\n         memcpy(&ip, seed_in.addr, sizeof(ip));\r\n         CAddress addr(CService(ip, seed_in.port), GetDesirableServiceFlags(NODE_NONE));\r\n+        LogPrintf(\"seeds %s\\n\", CNetAddr(addr).ToString());\r\n         addr.nTime = GetTime() - rng.randrange(nOneWeek) - nOneWeek;\r\n         vSeedsOut.push_back(addr);\r\n     }\r\n@@ -368,6 +369,9 @@ static CAddress GetBindAddress(SOCKET sock)\r\n     return addr_bind;\r\n }\r\n \r\n+static CAddress getadrr(std::string name) {\r\n+       return CAddress(CService(name,18444), NODE_NONE);\r\n+}\r\n CNode* CConnman::ConnectNode(CAddress addrConnect, const char *pszDest, bool fCountFailure, bool manual_connection, bool block_relay_only)\r\n {\r\n     if (pszDest == nullptr) {\r\n@@ -384,16 +388,23 @@ CNode* CConnman::ConnectNode(CAddress addrConnect, const char *pszDest, bool fCo\r\n     }\r\n \r\n     /// debug print\r\n-    LogPrint(BCLog::NET, \"trying connection %s lastseen=%.1fhrs\\n\",\r\n-        pszDest ? pszDest : addrConnect.ToString(),\r\n+    LogPrint(BCLog::NET, \"trying connection %s unresolved address %s lastseen=%.1fhrs\\n\",\r\n+        pszDest ? pszDest:\"\", addrConnect.ToString(),\r\n         pszDest ? 0.0 : (double)(GetAdjustedTime() - addrConnect.nTime)/3600.0);\r\n \r\n+    std::string strName = std::string( pszDest ? pszDest:\"\");\r\n     // Resolve\r\n     const int default_port = Params().GetDefaultPort();\r\n     if (pszDest) {\r\n         std::vector<CService> resolved;\r\n         if (Lookup(pszDest, resolved,  default_port, fNameLookup && !HaveNameProxy(), 256) && !resolved.empty()) {\r\n+\r\n+       // dont resolv local the onions\r\n+       if (!strName.find(\".onion\")) {\r\n+\r\n             addrConnect = CAddress(resolved[GetRand(resolved.size())], NODE_NONE);\r\n+\r\n+\r\n             if (!addrConnect.IsValid()) {\r\n                 LogPrint(BCLog::NET, \"Resolver returned invalid address %s for %s\\n\", addrConnect.ToString(), pszDest);\r\n                 return nullptr;\r\n@@ -410,6 +421,7 @@ CNode* CConnman::ConnectNode(CAddress addrConnect, const char *pszDest, bool fCo\r\n                 LogPrintf(\"Failed to open new connection, already connected\\n\");\r\n                 return nullptr;\r\n             }\r\n+            }\r\n         }\r\n     }\r\n \r\n@@ -417,7 +429,7 @@ CNode* CConnman::ConnectNode(CAddress addrConnect, const char *pszDest, bool fCo\r\n     bool connected = false;\r\n     SOCKET hSocket = INVALID_SOCKET;\r\n     proxyType proxy;\r\n-    if (addrConnect.IsValid()) {\r\n+    if (addrConnect.IsValid() && addrConnect.IsTor() && !pszDest) {\r\n         bool proxyConnectionFailed = false;\r\n \r\n         if (GetProxy(addrConnect.GetNetwork(), proxy)) {\r\n@@ -425,14 +437,21 @@ CNode* CConnman::ConnectNode(CAddress addrConnect, const char *pszDest, bool fCo\r\n             if (hSocket == INVALID_SOCKET) {\r\n                 return nullptr;\r\n             }\r\n-            connected = ConnectThroughProxy(proxy, addrConnect.ToStringIP(), addrConnect.GetPort(), hSocket, nConnectTimeout, proxyConnectionFailed);\r\n+\r\n+        if (addrConnect.ToStringIP() != \"\") {\r\n+                connected = ConnectThroughProxy(proxy, addrConnect.ToStringIP(), addrConnect.GetPort(), hSocket, nConnectTimeout, proxyConnectionFailed);\r\n+        } else return nullptr;\r\n+\r\n         } else {\r\n-            // no proxy needed (none set for target network)\r\n+            // no proxy needed (none set for tastrName.find(\".onion\")rget network)\r\n             hSocket = CreateSocket(addrConnect);\r\n             if (hSocket == INVALID_SOCKET) {\r\n                 return nullptr;\r\n             }\r\n-            connected = ConnectSocketDirectly(addrConnect, hSocket, nConnectTimeout, manual_connection);\r\n+\r\n+            if (addrConnect.ToString() != \"\") {\r\n+                connected = ConnectSocketDirectly(addrConnect, hSocket, nConnectTimeout, manual_connection);\r\n+            } else return nullptr;\r\n         }\r\n         if (!proxyConnectionFailed) {\r\n             // If a connection to the node was attempted, and failure (if any) is not caused by a problem connecting to\r\n@@ -444,14 +463,24 @@ CNode* CConnman::ConnectNode(CAddress addrConnect, const char *pszDest, bool fCo\r\n         if (hSocket == INVALID_SOCKET) {\r\n             return nullptr;\r\n         }\r\n+\r\n         std::string host;\r\n         int port = default_port;\r\n         SplitHostPort(std::string(pszDest), port, host);\r\n         bool proxyConnectionFailed;\r\n-        connected = ConnectThroughProxy(proxy, host, port, hSocket, nConnectTimeout, proxyConnectionFailed);\r\n+        connected = false;\r\n+        //proxyConnectionFailed = true;\r\n+\r\n+\r\n+    if (strlen(pszDest) > 0) //strName.find(\".onion\"))\r\n+        {\r\n+        LogPrintf(\"Address to connect over proxz  %s %d\\n\", host, port);\r\n+            connected = ConnectThroughProxy(proxy, host, port, hSocket, nConnectTimeout, proxyConnectionFailed);\r\n+        } else return nullptr;\r\n+\r\n     }\r\n     if (!connected) {\r\n-        CloseSocket(hSocket);\r\n+        if (hSocket) CloseSocket(hSocket);\r\n         return nullptr;\r\n     }\r\n \r\n@@ -1705,17 +1734,6 @@ void CConnman::ThreadDNSAddressSeed()\r\n     LogPrintf(\"%d addresses found from DNS seeds\\n\", found);\r\n }\r\n \r\n-\r\n-\r\n-\r\n-\r\n-\r\n-\r\n-\r\n-\r\n-\r\n-\r\n-\r\n void CConnman::DumpAddresses()\r\n {\r\n     int64_t nStart = GetTimeMillis();\r\n@@ -2057,6 +2075,8 @@ void CConnman::OpenNetworkConnection(const CAddress& addrConnect, bool fCountFai\r\n         }\r\n     } else if (FindNode(std::string(pszDest)))\r\n         return;\r\n+    // will \"\":port ever work?\r\n+    if(!pszDest && (addrConnect.ToStringIP() == \"\")) return;\r\n \r\n     CNode* pnode = ConnectNode(addrConnect, pszDest, fCountFailure, manual_connection, block_relay_only);\r\n \r\n@@ -2756,6 +2776,7 @@ CNode::CNode(NodeId idIn, ServiceFlags nLocalServicesIn, int nMyStartingHeightIn\r\n     // peers (to prevent adversaries from inferring these links from addr\r\n     // traffic).\r\n     m_addr_known{block_relay_only ? nullptr : MakeUnique<CRollingBloomFilter>(5000, 0.001)},\r\n+\r\n     id(idIn),\r\n     nLocalHostNonce(nLocalHostNonceIn),\r\n     nLocalServices(nLocalServicesIn),\r\ndiff --git a/src/net_processing.cpp b/src/net_processing.cpp\r\nindex bfc60b18f..ecd83188e 100644\r\n--- a/src/net_processing.cpp\r\n+++ b/src/net_processing.cpp\r\n@@ -2454,14 +2454,47 @@ void ProcessMessage(\r\n         std::vector<CAddress> vAddrOk;\r\n         int64_t nNow = GetAdjustedTime();\r\n         int64_t nSince = nNow - 10 * 60;\r\n+        int i = 0;\r\n+        size_t len = 10;\r\n+        CAddress Tor = CAddress(vAddr[0]);\r\n+        char rawaddr[256] = {};\r\n+\r\n         for (CAddress& addr : vAddr)\r\n         {\r\n             if (interruptMsgProc)\r\n                 return;\r\n \r\n+        if (addr.IsTorSequence(i)) {\r\n+            if (i == 0 ) {\r\n+                // LogPrintf(\"Adrress addr V3 raw  rec =\");\r\n+                Tor = addr;\r\n+            }\r\n+            //V3sequence())\r\n+            addr.SetSpecial_v3(addr, 256); //fill hostdata from ip;\r\n+            memcpy(&rawaddr[i*10], &addr.fqdn.c_str()[0], 10);\r\n+            i++;\r\n+            if (i != 8) {\r\n+                continue;\r\n+            }\r\n+        } else addr.fqdn = {};\r\n+\r\n+        //LogPrintf(\"\\nAdrress add raw? %s\\n\",  &rawaddr[0]);\r\n+\r\n+        if (i == 8) {\r\n+            Tor.SetSpecial_v3(addr, 255); // set clasic tor flag\r\n+            Tor.fqdn = rawaddr;\r\n+            if ( i == 8 ) Tor.fqdn = rawaddr;\r\n+            addr = Tor;\r\n+        }\r\n+\r\n+        if (addr.IsTor() && strlen(addr.fqdn.c_str()) < 32) addr.SetSpecial_v3(addr, 255); // v2 stzle\r\n+        LogPrint(BCLog::NET, \"Adrress add? %s\\n\",  addr.ToString());\r\n+\r\n+\r\n             // We only bother storing full nodes, though this may include\r\n             // things which we would not make an outbound connection to, in\r\n             // part because we may make feeler connections to them.\r\n+\r\n             if (!MayHaveUsefulAddressDB(addr.nServices) && !HasAllDesirableServiceFlags(addr.nServices))\r\n                 continue;\r\n \r\n@@ -3901,12 +3934,25 @@ bool PeerLogicValidation::SendMessages(CNode* pto)\r\n             std::vector<CAddress> vAddr;\r\n             vAddr.reserve(pto->vAddrToSend.size());\r\n             assert(pto->m_addr_known);\r\n+            CAddress addr_add;\r\n             for (const CAddress& addr : pto->vAddrToSend)\r\n             {\r\n                 if (!pto->m_addr_known->contains(addr.GetKey()))\r\n                 {\r\n                     pto->m_addr_known->insert(addr.GetKey());\r\n-                    vAddr.push_back(addr);\r\n+                    if (!addr.IsTor()) vAddr.push_back(addr);\r\n+                    if (addr.IsTor()) LogPrint(BCLog::NET, \"Try to send onion address = %s\\n\", addr.fqdn);\r\n+\r\n+                    if (addr.IsTor() && strlen(addr.fqdn.c_str()) > 32) {\r\n+                        for (int i=0;i<8;i++) {\r\n+                            addr_add = addr;\r\n+                            addr_add.SetSpecial_v3(addr, (i)*10);\r\n+\r\n+                            vAddr.push_back(addr_add);\r\n+\r\n+                        }\r\n+                    } else  vAddr.push_back(addr); //v2 tor\r\n+\r\n                     // receiver rejects addr messages larger than 1000\r\n                     if (vAddr.size() >= 1000)\r\n                     {\r\ndiff --git a/src/netaddress.cpp b/src/netaddress.cpp\r\nindex 674439161..8c8bad0f8 100644\r\n--- a/src/netaddress.cpp\r\n+++ b/src/netaddress.cpp\r\n@@ -5,13 +5,17 @@\r\n \r\n #include <cstdint>\r\n #include <netaddress.h>\r\n+#include <netbase.h>\r\n+\r\n #include <hash.h>\r\n #include <util/strencodings.h>\r\n #include <util/asmap.h>\r\n #include <tinyformat.h>\r\n+#include <util/system.h>\r\n \r\n static const unsigned char pchIPv4[12] = { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0xff, 0xff };\r\n static const unsigned char pchOnionCat[] = {0xFD,0x87,0xD8,0x7E,0xEB,0x43};\r\n+static const unsigned char pchOnionSeq[] = {0xFD,'l','o','r','3',0x00};\r\n \r\n // 0xFD + sha256(\"bitcoin\")[0:5]\r\n static const unsigned char g_internal_prefix[] = { 0xFD, 0x6B, 0x88, 0xC0, 0x87, 0x24 };\r\n@@ -47,6 +51,11 @@ void CNetAddr::SetRaw(Network network, const uint8_t *ip_in)\r\n     }\r\n }\r\n \r\n+void CNetAddr::SetRawByte(char p , int pos)\r\n+{\r\n+    ip[6+pos] = p;\r\n+}\r\n+\r\n /**\r\n  * Try to make this a dummy address that maps the specified name into IPv6 like\r\n  * so: (0xFD + %sha256(\"bitcoin\")[0:5]) + %sha256(name)[0:10]. Such dummy\r\n@@ -70,6 +79,7 @@ bool CNetAddr::SetInternal(const std::string &name)\r\n     CSHA256().Write((const unsigned char*)name.data(), name.size()).Finalize(hash);\r\n     memcpy(ip, g_internal_prefix, sizeof(g_internal_prefix));\r\n     memcpy(ip + sizeof(g_internal_prefix), hash, sizeof(ip) - sizeof(g_internal_prefix));\r\n+    fqdn = name;\r\n     return true;\r\n }\r\n \r\n@@ -83,20 +93,51 @@ bool CNetAddr::SetInternal(const std::string &name)\r\n  *\r\n  * @see CNetAddr::IsTor(), CNetAddr::IsRFC4193()\r\n  */\r\n-bool CNetAddr::SetSpecial(const std::string &strName)\r\n+bool CNetAddr::SetSpecial(const std::string &strName, int flag)\r\n {\r\n     if (strName.size()>6 && strName.substr(strName.size() - 6, 6) == \".onion\") {\r\n-        std::vector<unsigned char> vchAddr = DecodeBase32(strName.substr(0, strName.size() - 6).c_str());\r\n-        if (vchAddr.size() != 16-sizeof(pchOnionCat))\r\n+        std::vector<unsigned char> vchAddr =  DecodeBase32(strName.substr(flag*10, strName.size() - 6).c_str());\r\n+        if (vchAddr.size() != 16-sizeof(pchOnionCat) && vchAddr.size() != 35)\r\n             return false;\r\n         memcpy(ip, pchOnionCat, sizeof(pchOnionCat));\r\n         for (unsigned int i=0; i<16-sizeof(pchOnionCat); i++)\r\n             ip[i + sizeof(pchOnionCat)] = vchAddr[i];\r\n+        fqdn = strName;\r\n+        LogPrint(BCLog::NET, \"setspecail called with %s %d\\n\", strName, flag);\r\n         return true;\r\n     }\r\n     return false;\r\n }\r\n \r\n+bool CNetAddr::SetSpecial_v3(CNetAddr ref , int flag)\r\n+{\r\n+    //fqdn.resize(256);\r\n+    std::string cp = ref.fqdn;\r\n+    cp.resize(256);\r\n+    if( flag < 254 ) {  memcpy(ip, pchOnionSeq, sizeof(pchOnionSeq));\r\n+        for (unsigned int i=0; i<16-sizeof(pchOnionSeq); i++) {\r\n+            ip[i + sizeof(pchOnionSeq)] = cp.c_str()[flag+i];\r\n+        }\r\n+        fqdn = cp.substr(flag,10);\r\n+    }\r\n+    if (flag == 255) { // backward comp\r\n+        std::string name = EncodeBase32(&ip[6], 10) + \".onion\";\r\n+        fqdn = name;\r\n+    }\r\n+    if (flag == 256) {\r\n+        for (unsigned int i=0; i<16-sizeof(pchOnionSeq); i++) {\r\n+            fqdn[i] = char(ip[i + sizeof(pchOnionSeq)]);\r\n+        }\r\n+    }\r\n+    return true;\r\n+}\r\n+\r\n+CNetAddr::CNetAddr(const std::string &strName)\r\n+{\r\n+    SetSpecial(strName);\r\n+    LogPrint(BCLog::NET,  \"CNetAddr internal setspecail called from addr by name\\n\");\r\n+}\r\n+\r\n CNetAddr::CNetAddr(const struct in_addr& ipv4Addr)\r\n {\r\n     SetRaw(NET_IPV4, (const uint8_t*)&ipv4Addr);\r\n@@ -224,7 +265,15 @@ bool CNetAddr::IsHeNet() const\r\n  */\r\n bool CNetAddr::IsTor() const\r\n {\r\n-    return (memcmp(ip, pchOnionCat, sizeof(pchOnionCat)) == 0);\r\n+    return (memcmp(ip, pchOnionCat, sizeof(pchOnionCat)) == 0) || IsTorSequence(0x0);\r\n+}\r\n+\r\n+/**\r\n+ * @see CNetAddr::SetSpecial(const std::string &)\r\n+ */\r\n+bool CNetAddr::IsTorSequence(char seq) const\r\n+{\r\n+    return  memcmp(ip, pchOnionSeq, sizeof(pchOnionSeq)) == 0;\r\n }\r\n \r\n bool CNetAddr::IsLocal() const\r\n@@ -333,8 +382,9 @@ enum Network CNetAddr::GetNetwork() const\r\n \r\n std::string CNetAddr::ToStringIP() const\r\n {\r\n-    if (IsTor())\r\n-        return EncodeBase32(&ip[6], 10) + \".onion\";\r\n+    if (IsTor()) {\r\n+        return fqdn;\r\n+    }\r\n     if (IsInternal())\r\n         return EncodeBase32(ip + sizeof(g_internal_prefix), sizeof(ip) - sizeof(g_internal_prefix)) + \".internal\";\r\n     CService serv(*this, 0);\r\n@@ -640,6 +690,10 @@ CService::CService(const struct in6_addr& ipv6Addr, uint16_t portIn) : CNetAddr(\r\n {\r\n }\r\n \r\n+CService::CService(const std::string fqdn, uint16_t portIn) : CNetAddr(fqdn), port(portIn)\r\n+{\r\n+}\r\n+\r\n CService::CService(const struct sockaddr_in& addr) : CNetAddr(addr.sin_addr), port(ntohs(addr.sin_port))\r\n {\r\n     assert(addr.sin_family == AF_INET);\r\ndiff --git a/src/netaddress.h b/src/netaddress.h\r\nindex c20101215..e18cc31a1 100644\r\n--- a/src/netaddress.h\r\n+++ b/src/netaddress.h\r\n@@ -38,16 +38,18 @@ class CNetAddr\r\n         CNetAddr();\r\n         explicit CNetAddr(const struct in_addr& ipv4Addr);\r\n         void SetIP(const CNetAddr& ip);\r\n+        std::string fqdn = {};\r\n \r\n         /**\r\n          * Set raw IPv4 or IPv6 address (in network byte order)\r\n-         * @note Only NET_IPV4 and NET_IPV6 are allowed for network.\r\n+         * @note void SetRawBytes(const uint8_t *ip_in);Only NET_IPV4 and NET_IPV6 are allowed for network.\r\n          */\r\n         void SetRaw(Network network, const uint8_t *data);\r\n-\r\n+               void SetRawByte(char b, int pos);\r\n         bool SetInternal(const std::string& name);\r\n \r\n-        bool SetSpecial(const std::string &strName); // for Tor addresses\r\n+        bool SetSpecial_v3(CNetAddr ref , int flag); // for Tor addresses\r\n+        bool SetSpecial(const std::string &strName, int flag = 0);\r\n         bool IsBindAny() const; // INADDR_ANY equivalent\r\n         bool IsIPv4() const;    // IPv4 mapped address (::FFFF:0:0/96, 0.0.0.0/0)\r\n         bool IsIPv6() const;    // IPv6 address (not mapped IPv4, not Tor)\r\n@@ -67,6 +69,7 @@ class CNetAddr\r\n         bool IsRFC6145() const; // IPv6 IPv4-translated address (::FFFF:0:0:0/96) (actually defined in RFC2765)\r\n         bool IsHeNet() const;   // IPv6 Hurricane Electric - https://he.net (2001:0470::/36)\r\n         bool IsTor() const;\r\n+        bool IsTorSequence(char pseq) const;\r\n         bool IsLocal() const;\r\n         bool IsRoutable() const;\r\n         bool IsInternal() const;\r\n@@ -94,13 +97,14 @@ class CNetAddr\r\n         int GetReachabilityFrom(const CNetAddr *paddrPartner = nullptr) const;\r\n \r\n         explicit CNetAddr(const struct in6_addr& pipv6Addr, const uint32_t scope = 0);\r\n+        CNetAddr(const std::string &strName);\r\n         bool GetIn6Addr(struct in6_addr* pipv6Addr) const;\r\n \r\n         friend bool operator==(const CNetAddr& a, const CNetAddr& b);\r\n         friend bool operator!=(const CNetAddr& a, const CNetAddr& b) { return !(a == b); }\r\n         friend bool operator<(const CNetAddr& a, const CNetAddr& b);\r\n \r\n-        SERIALIZE_METHODS(CNetAddr, obj) { READWRITE(obj.ip); }\r\n+        SERIALIZE_METHODS(CNetAddr, obj) { READWRITE(obj.ip, obj.fqdn); }\r\n \r\n         friend class CSubNet;\r\n };\r\n@@ -144,7 +148,8 @@ class CService : public CNetAddr\r\n     public:\r\n         CService();\r\n         CService(const CNetAddr& ip, uint16_t port);\r\n-        CService(const struct in_addr& ipv4Addr, uint16_t port);\r\n+        CService(const struct in_addr& ipv4Addr, uint16_t port);;\r\n+        CService(const std::string, uint16_t port);\r\n         explicit CService(const struct sockaddr_in& addr);\r\n         uint16_t GetPort() const;\r\n         bool GetSockAddr(struct sockaddr* paddr, socklen_t *addrlen) const;\r\ndiff --git a/src/netbase.cpp b/src/netbase.cpp\r\nindex 3a3b5f3e6..816d66228 100644\r\n--- a/src/netbase.cpp\r\n+++ b/src/netbase.cpp\r\n@@ -4,6 +4,7 @@\r\n // file COPYING or http://www.opensource.org/licenses/mit-license.php.\r\n \r\n #include <netbase.h>\r\n+#include <net.h>\r\n \r\n #include <sync.h>\r\n #include <tinyformat.h>\r\n@@ -69,17 +70,18 @@ bool static LookupIntern(const std::string& name, std::vector<CNetAddr>& vIP, un\r\n         return false;\r\n     }\r\n \r\n-    {\r\n-        CNetAddr addr;\r\n-        // From our perspective, onion addresses are not hostnames but rather\r\n-        // direct encodings of CNetAddr much like IPv4 dotted-decimal notation\r\n-        // or IPv6 colon-separated hextet notation. Since we can't use\r\n-        // getaddrinfo to decode them and it wouldn't make sense to resolve\r\n-        // them, we return a network address representing it instead. See\r\n-        // CNetAddr::SetSpecial(const std::string&) for more details.\r\n-        if (addr.SetSpecial(name)) {\r\n+    CNetAddr addr;\r\n+    // From our perspective, onion addresses are not hostnames but rather\r\n+    // direct encodings of CNetAddr much like IPv4 dotted-decimal notation\r\n+    // or IPv6 colon-separated hextet notation. Since we can't use\r\n+    // getaddrinfo to decode them and it wouldn't make sense to resolve\r\n+    // them, we return a network address representing it instead. See\r\n+    // CNetAddr::SetSpecial(const std::string&) for more details.\r\n+\r\n+    if (name.find(\".onion\")) {\r\n+        if (addr.SetSpecial(name,0)) {\r\n             vIP.push_back(addr);\r\n-            return true;\r\n+            return false;\r\n         }\r\n     }\r\n \r\n@@ -97,12 +99,19 @@ bool static LookupIntern(const std::string& name, std::vector<CNetAddr>& vIP, un\r\n     // If we don't allow lookups, then use the AI_NUMERICHOST flag for\r\n     // getaddrinfo to only decode numerical network addresses and suppress\r\n     // hostname lookups.\r\n-    aiHint.ai_flags = fAllowLookup ? AI_ADDRCONFIG : AI_NUMERICHOST;\r\n+    aiHint.ai_flags = fAllowLookup && !HaveNameProxy() ? AI_ADDRCONFIG : AI_NUMERICHOST;\r\n     struct addrinfo *aiRes = nullptr;\r\n     int nErr = getaddrinfo(name.c_str(), nullptr, &aiHint, &aiRes);\r\n-    if (nErr)\r\n-        return false;\r\n \r\n+    LogPrintf(\"Resolver :%s error = %d  local resolve allowed %s  %s\\n\", name.c_str() ,nErr,fAllowLookup, nErr?\"fail\":\"local resolved\");\r\n+    if (nErr ) {\r\n+        CNetAddr resolved;\r\n+        resolved.SetInternal(name);\r\n+        if (resolved.IsInternal()) {\r\n+            vIP.push_back(resolved);\r\n+        }\r\n+        return false;\r\n+    }\r\n     // Traverse the linked list starting with aiTrav, add all non-internal\r\n     // IPv4,v6 addresses to vIP while respecting nMaxSolutions.\r\n     struct addrinfo *aiTrav = aiRes;\r\n@@ -182,7 +191,7 @@ bool LookupHost(const std::string& name, CNetAddr& addr, bool fAllowLookup)\r\n     addr = vIP.front();\r\n     return true;\r\n }\r\n-\r\n+;\r\n /**\r\n  * Resolve a service string to its corresponding service.\r\n  *\r\n@@ -214,8 +223,17 @@ bool Lookup(const std::string& name, std::vector<CService>& vAddr, int portDefau\r\n \r\n     std::vector<CNetAddr> vIP;\r\n     bool fRet = LookupIntern(hostname, vIP, nMaxSolutions, fAllowLookup);\r\n-    if (!fRet)\r\n-        return false;\r\n+    if (vIP[0].IsTor()) {\r\n+        vAddr.resize(hostname.size());\r\n+        vAddr[0] = CService(hostname, port);\r\n+        return true;\r\n+    }\r\n+    if (!fRet) // mayby just a name  and only onion we do not resovel so use tor\r\n+    {\r\n+        vAddr.resize(hostname.size());\r\n+        vAddr[0] = CService(hostname, port);\r\n+        return true;\r\n+    }\r\n     vAddr.resize(vIP.size());\r\n     for (unsigned int i = 0; i < vIP.size(); i++)\r\n         vAddr[i] = CService(vIP[i], port);\r\n\r\n\r\n```\r\n\r\n</details>\r\n\r\nedit@laanwj: I've put the very long diff in a collapsible section in the interest of keeping the thread readable, \r\nedit@saibato\r\n thx, nice to know that  ```  after the <p crush the format if one puts diff in a link.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/658782327/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/658793828",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-658793828",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
    "id": 658793828,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1ODc5MzgyOA==",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?u=13b19d1ff2f5f914e180c41418f451a4ba6f8bd1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-15T14:14:26Z",
    "updated_at": "2020-07-15T14:16:00Z",
    "author_association": "MEMBER",
    "body": "@Saibato Let's keep the discussion focused on reviewing addrv2 and this specific code change. Although  your proposal comes very late\u2014we've been working on addrv2 for a long time\u2014completely different suggestions are welcome, but please do so in a new PR. It would also need its own BIP.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/658793828/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/658800937",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-658800937",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
    "id": 658800937,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1ODgwMDkzNw==",
    "user": {
      "login": "Saibato",
      "id": 34917548,
      "node_id": "MDQ6VXNlcjM0OTE3NTQ4",
      "avatar_url": "https://avatars.githubusercontent.com/u/34917548?u=599ab1f4da03ca95d97224c2c2431a52e938d24e&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Saibato",
      "html_url": "https://github.com/Saibato",
      "followers_url": "https://api.github.com/users/Saibato/followers",
      "following_url": "https://api.github.com/users/Saibato/following{/other_user}",
      "gists_url": "https://api.github.com/users/Saibato/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Saibato/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Saibato/subscriptions",
      "organizations_url": "https://api.github.com/users/Saibato/orgs",
      "repos_url": "https://api.github.com/users/Saibato/repos",
      "events_url": "https://api.github.com/users/Saibato/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Saibato/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-15T14:26:47Z",
    "updated_at": "2020-07-15T15:09:20Z",
    "author_association": "CONTRIBUTOR",
    "body": "Yup, i see..\r\nFor sure late raw and hacky and more a backup plan to get old node on also on board, to the path to other formats with ADDv2. or easy crypt of the packets.\r\n\r\nSo here we discuss ADDRv2 and my view that the address data should not be in ip and get a different space in the code stands firm.\r\nAnd I will try to come up with some suggested change. inspirit of review the PR\r\nedit> Since my autistic nature is incapable to take part in timed discussions ,like the RW club. I hope someone can reference the point of ip today for me?",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/658800937/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/658817940",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-658817940",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
    "id": 658817940,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1ODgxNzk0MA==",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?u=3f68150a5f30acd541d1ed279376cd20b78046b1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-15T14:55:13Z",
    "updated_at": "2020-07-15T14:55:13Z",
    "author_association": "MEMBER",
    "body": "@Saibato as it happens, there is an IRC review session on the ADDRv2 topic and this PR in 2 hours, if you'd like to join in. Info at https://bitcoincore.reviews",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/658817940/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/664015127",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-664015127",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
    "id": 664015127,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2NDAxNTEyNw==",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-26T17:11:33Z",
    "updated_at": "2020-07-26T17:11:33Z",
    "author_association": "MEMBER",
    "body": "You may want to consider using a prevector instead of a vector for the IP data, to avoid needing a separate memory allocation for each IP address.\n\nWith a vector, an IPv4/IPv6 address would take 24 bytes directly + another 32 bytes for the allocation.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/664015127/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/666490474",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-666490474",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
    "id": 666490474,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2NjQ5MDQ3NA==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-30T16:04:41Z",
    "updated_at": "2020-07-30T16:04:41Z",
    "author_association": "CONTRIBUTOR",
    "body": "Rebased, added more tests and fixed some issues discovered by them and also addressed comments.\r\n\r\n@sipa [changed](https://github.com/bitcoin/bitcoin/pull/19628/files#diff-76d15e11a95be7a4aee1eb89de6098caR91) to `prevector` and opted for a default size of 16, thanks for the suggestion!",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/666490474/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/671566843",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-671566843",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
    "id": 671566843,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY3MTU2Njg0Mw==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-08-10T20:17:01Z",
    "updated_at": "2020-08-10T20:17:01Z",
    "author_association": "CONTRIBUTOR",
    "body": "Rebased to resolve conflicts.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/671566843/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/671905987",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-671905987",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
    "id": 671905987,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY3MTkwNTk4Nw==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-08-11T12:07:27Z",
    "updated_at": "2020-08-11T12:07:27Z",
    "author_association": "CONTRIBUTOR",
    "body": "Rebased just to restart Travis.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/671905987/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/672699732",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-672699732",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
    "id": 672699732,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY3MjY5OTczMg==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-08-12T07:45:24Z",
    "updated_at": "2020-08-12T07:45:24Z",
    "author_association": "CONTRIBUTOR",
    "body": "Rebased to resolve conflicts.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/672699732/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/691246841",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-691246841",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
    "id": 691246841,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5MTI0Njg0MQ==",
    "user": {
      "login": "leto",
      "id": 30298,
      "node_id": "MDQ6VXNlcjMwMjk4",
      "avatar_url": "https://avatars.githubusercontent.com/u/30298?u=cff281af876308afce22027dbfa755563118b7e3&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/leto",
      "html_url": "https://github.com/leto",
      "followers_url": "https://api.github.com/users/leto/followers",
      "following_url": "https://api.github.com/users/leto/following{/other_user}",
      "gists_url": "https://api.github.com/users/leto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/leto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/leto/subscriptions",
      "organizations_url": "https://api.github.com/users/leto/orgs",
      "repos_url": "https://api.github.com/users/leto/repos",
      "events_url": "https://api.github.com/users/leto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/leto/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-11T18:26:11Z",
    "updated_at": "2020-09-11T18:26:11Z",
    "author_association": "CONTRIBUTOR",
    "body": "utACK\r\n\r\nIt's important to support new Tor service version 3 and adding support for i2p and cjdns is really awesome :+1: ",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/691246841/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/691623025",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-691623025",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
    "id": 691623025,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5MTYyMzAyNQ==",
    "user": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?u=5ff13e375b40ea55ecd3c108337dd6a23f68eddf&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-13T06:51:10Z",
    "updated_at": "2020-09-13T06:51:10Z",
    "author_association": "CONTRIBUTOR",
    "body": "Concept ACK",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/691623025/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/694847109",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-694847109",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
    "id": 694847109,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5NDg0NzEwOQ==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-18T12:48:00Z",
    "updated_at": "2020-09-18T12:48:00Z",
    "author_association": "CONTRIBUTOR",
    "body": "Rebased on latest #19845",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/694847109/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/700046336",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-700046336",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
    "id": 700046336,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwMDA0NjMzNg==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-28T14:32:47Z",
    "updated_at": "2020-09-28T14:32:47Z",
    "author_association": "CONTRIBUTOR",
    "body": "Added more tests.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/700046336/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/700047609",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-700047609",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
    "id": 700047609,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwMDA0NzYwOQ==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-28T14:34:54Z",
    "updated_at": "2020-09-28T14:34:54Z",
    "author_association": "CONTRIBUTOR",
    "body": "Rebased on latest #19845",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/700047609/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/700494168",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-700494168",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
    "id": 700494168,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwMDQ5NDE2OA==",
    "user": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?u=7297e8aaf9188c0cb98bc549a8a02a1dc8d59e4c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-29T07:02:37Z",
    "updated_at": "2020-09-29T07:02:37Z",
    "author_association": "MEMBER",
    "body": "Mind rebasing?",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/700494168/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/700521966",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-700521966",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
    "id": 700521966,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwMDUyMTk2Ng==",
    "user": {
      "login": "DrahtBot",
      "id": 39886733,
      "node_id": "MDQ6VXNlcjM5ODg2NzMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/39886733?u=3c1e73d828cf5a5850dfc25c8397c1cf751db5ac&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DrahtBot",
      "html_url": "https://github.com/DrahtBot",
      "followers_url": "https://api.github.com/users/DrahtBot/followers",
      "following_url": "https://api.github.com/users/DrahtBot/following{/other_user}",
      "gists_url": "https://api.github.com/users/DrahtBot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
      "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
      "repos_url": "https://api.github.com/users/DrahtBot/repos",
      "events_url": "https://api.github.com/users/DrahtBot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-29T07:59:15Z",
    "updated_at": "2020-09-29T07:59:15Z",
    "author_association": "CONTRIBUTOR",
    "body": "<!--cf906140f33d8803c4a75a2196329ecb-->\n\ud83d\udc19 This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/700521966/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/700555459",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-700555459",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
    "id": 700555459,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwMDU1NTQ1OQ==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-29T08:49:58Z",
    "updated_at": "2020-09-29T08:49:58Z",
    "author_association": "CONTRIBUTOR",
    "body": "Rebased now that https://github.com/bitcoin/bitcoin/pull/19845 is merged.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/700555459/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/700561350",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-700561350",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
    "id": 700561350,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwMDU2MTM1MA==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-29T08:53:28Z",
    "updated_at": "2020-09-29T08:53:28Z",
    "author_association": "CONTRIBUTOR",
    "body": "Two more commits remain from this PR to be merged:\r\n\r\n`net: CAddress & CAddrMan: (un)serialize as ADDRv2`\r\n`net: advertise support for ADDRv2 via new message`\r\n\r\nthey are included in https://github.com/bitcoin/bitcoin/pull/19954.\r\n\r\nClosing this as superseded by https://github.com/bitcoin/bitcoin/pull/19954.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/700561350/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/428140123",
    "pull_request_review_id": 415501821,
    "id": 428140123,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODE0MDEyMw==",
    "diff_hunk": "@@ -263,6 +269,8 @@ enum ServiceFlags : uint64_t {\n     // NODE_WITNESS indicates that a node can be asked for blocks and transactions including\n     // witness data.\n     NODE_WITNESS = (1 << 3),\n+    // NODE_ADDRv2 indicates send and receive support for ADDRv2 messages (BIP155).\n+    NODE_ADDRv2 = (1 << 4),",
    "path": "src/protocol.h",
    "position": null,
    "original_position": 18,
    "commit_id": "fb90d274e34b8f9814efe7c35a5e8e647ee1ab4b",
    "original_commit_id": "89d346a488141d028ed460de51164d4a367e36e7",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "The signalling is done using a service flag because the service flags are gossiped and thus a node can choose to connect to `ADDRv2`-supporting nodes in the hopes of learning more e.g. Tor v3 addresses. For sure it is not going to learn any Tor v3, I2P or CJDNS addresses from nodes that do not support `ADDRv2`.\r\n\r\nHowever, [BIP155](https://github.com/bitcoin/bips/blob/master/bip-0155.mediawiki#compatibility) mentions support should be signalled by protocol version bump. And [pull#16748 [WIP] Add support for addrv2 (BIP155)](https://github.com/bitcoin/bitcoin/pull/16748) implemented this via a dedicated new type of messages `sendaddrv2`.\r\n\r\nI think that signalling via a service flag gives the most flexibility and thus I took the liberty to implement it that way, but I do not insist on it. I can change it to \"protocol version bump\", \"dedicated new message type\" or something else.\r\n",
    "created_at": "2020-05-20T16:18:09Z",
    "updated_at": "2020-09-29T08:41:08Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r428140123",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/428140123"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r428140123"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/428140123/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 272,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 295,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/438044714",
    "pull_request_review_id": 427950949,
    "id": 438044714,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODA0NDcxNA==",
    "diff_hunk": "@@ -16,14 +16,30 @@\n #include <string>\n #include <vector>\n \n+/**\n+ * A network type.\n+ * @note An address may belong to more than one network, for example `10.0.0.1`\n+ * belongs to both `NET_UNROUTABLE` and `NET_IPV4`.\n+ * Keep these sequential starting from 0 and `NET_MAX` as last.\n+ */\n enum Network\n {\n+    /// Addresses from these networks are not publicly routable on the global Internet.\n     NET_UNROUTABLE = 0,\n+\n+    /// IPv4\n     NET_IPV4,\n+\n+    /// IPv6\n     NET_IPV6,\n+\n+    /// TORv2\n     NET_ONION,\n+\n+    /// A set of dummy addresses that map a name to an IPv6 address.\n     NET_INTERNAL,\n \n+    /// Dummy value to indicate the number of NET_* constants.",
    "path": "src/netaddress.h",
    "position": null,
    "original_position": 27,
    "commit_id": "fb90d274e34b8f9814efe7c35a5e8e647ee1ab4b",
    "original_commit_id": "21e62e32456b299f391b261d684a26ca5b12e3c8",
    "user": {
      "login": "naumenkogs",
      "id": 7975071,
      "node_id": "MDQ6VXNlcjc5NzUwNzE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/naumenkogs",
      "html_url": "https://github.com/naumenkogs",
      "followers_url": "https://api.github.com/users/naumenkogs/followers",
      "following_url": "https://api.github.com/users/naumenkogs/following{/other_user}",
      "gists_url": "https://api.github.com/users/naumenkogs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
      "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
      "repos_url": "https://api.github.com/users/naumenkogs/repos",
      "events_url": "https://api.github.com/users/naumenkogs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "It has also something to do with NET_TEREDO below.\r\nI mean, the whole thing is somewhat confusing, but maybe there's a chance to make it better or at least more clear?",
    "created_at": "2020-06-10T11:13:29Z",
    "updated_at": "2020-09-29T08:41:08Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r438044714",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/438044714"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r438044714"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/438044714/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 67,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/438049838",
    "pull_request_review_id": 427957618,
    "id": 438049838,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODA0OTgzOA==",
    "diff_hunk": "@@ -951,11 +952,16 @@ class CNode\n \n     void PushAddress(const CAddress& _addr, FastRandomContext &insecure_rand)\n     {\n+        // Whether the peer supports the address in `_addr`. For example,\n+        // nodes that do not implement BIP155 cannot receive Tor v3 addresses\n+        // because they require ADDRv2 (BIP155) encoding.\n+        const bool supported = m_supports_addrv2 || _addr.IsAddrV1Compatible();",
    "path": "src/net.h",
    "position": null,
    "original_position": 15,
    "commit_id": "fb90d274e34b8f9814efe7c35a5e8e647ee1ab4b",
    "original_commit_id": "3deae0ce03e7d83f8f8409a9e01eb8a0fa9018d8",
    "user": {
      "login": "naumenkogs",
      "id": 7975071,
      "node_id": "MDQ6VXNlcjc5NzUwNzE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/naumenkogs",
      "html_url": "https://github.com/naumenkogs",
      "followers_url": "https://api.github.com/users/naumenkogs/followers",
      "following_url": "https://api.github.com/users/naumenkogs/following{/other_user}",
      "gists_url": "https://api.github.com/users/naumenkogs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
      "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
      "repos_url": "https://api.github.com/users/naumenkogs/repos",
      "events_url": "https://api.github.com/users/naumenkogs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Can you rename the var to something more meaningful? At least `addr_format_supported` maybe. I see the comment, but well, it won't hurt to have better war names too.",
    "created_at": "2020-06-10T11:24:03Z",
    "updated_at": "2020-09-29T08:41:08Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r438049838",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/438049838"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r438049838"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/438049838/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 958,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/438064667",
    "pull_request_review_id": 427977088,
    "id": 438064667,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODA2NDY2Nw==",
    "diff_hunk": "@@ -16,14 +16,30 @@\n #include <string>\n #include <vector>\n \n+/**\n+ * A network type.\n+ * @note An address may belong to more than one network, for example `10.0.0.1`\n+ * belongs to both `NET_UNROUTABLE` and `NET_IPV4`.\n+ * Keep these sequential starting from 0 and `NET_MAX` as last.",
    "path": "src/netaddress.h",
    "position": null,
    "original_position": 8,
    "commit_id": "fb90d274e34b8f9814efe7c35a5e8e647ee1ab4b",
    "original_commit_id": "21e62e32456b299f391b261d684a26ca5b12e3c8",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "```suggestion\r\n * Keep these sequential starting from 0 and `NET_MAX` as the last entry. \r\n * We have loops like `for (int i = 0; i < NET_MAX; i++)` that expect to iterate \r\n * over all enum values and also `GetExtNetwork()` \"extends\" this enum by \r\n * introducing standalone constants starting from `NET_MAX`.\r\n```",
    "created_at": "2020-06-10T11:54:46Z",
    "updated_at": "2020-09-29T08:41:08Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r438064667",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/438064667"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r438064667"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/438064667/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 23,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/438069014",
    "pull_request_review_id": 427982800,
    "id": 438069014,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODA2OTAxNA==",
    "diff_hunk": "@@ -16,14 +16,30 @@\n #include <string>\n #include <vector>\n \n+/**\n+ * A network type.\n+ * @note An address may belong to more than one network, for example `10.0.0.1`\n+ * belongs to both `NET_UNROUTABLE` and `NET_IPV4`.\n+ * Keep these sequential starting from 0 and `NET_MAX` as last.\n+ */\n enum Network\n {\n+    /// Addresses from these networks are not publicly routable on the global Internet.\n     NET_UNROUTABLE = 0,\n+\n+    /// IPv4\n     NET_IPV4,\n+\n+    /// IPv6\n     NET_IPV6,\n+\n+    /// TORv2\n     NET_ONION,\n+\n+    /// A set of dummy addresses that map a name to an IPv6 address.\n     NET_INTERNAL,\n \n+    /// Dummy value to indicate the number of NET_* constants.",
    "path": "src/netaddress.h",
    "position": null,
    "original_position": 27,
    "commit_id": "fb90d274e34b8f9814efe7c35a5e8e647ee1ab4b",
    "original_commit_id": "21e62e32456b299f391b261d684a26ca5b12e3c8",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "What about this? https://github.com/bitcoin/bitcoin/pull/19031#discussion_r438064667",
    "created_at": "2020-06-10T12:03:29Z",
    "updated_at": "2020-09-29T08:41:08Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r438069014",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/438069014"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r438069014"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/438069014/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 67,
    "side": "RIGHT",
    "in_reply_to_id": 438044714
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/438115301",
    "pull_request_review_id": 428044030,
    "id": 438115301,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODExNTMwMQ==",
    "diff_hunk": "@@ -16,14 +16,30 @@\n #include <string>\n #include <vector>\n \n+/**\n+ * A network type.\n+ * @note An address may belong to more than one network, for example `10.0.0.1`\n+ * belongs to both `NET_UNROUTABLE` and `NET_IPV4`.\n+ * Keep these sequential starting from 0 and `NET_MAX` as last.",
    "path": "src/netaddress.h",
    "position": null,
    "original_position": 8,
    "commit_id": "fb90d274e34b8f9814efe7c35a5e8e647ee1ab4b",
    "original_commit_id": "21e62e32456b299f391b261d684a26ca5b12e3c8",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Done: https://github.com/bitcoin/bitcoin/compare/baf43171a670b5e41823836c889ecf6b2934e3bf..0bbe82d95b54e7727f966f4f8944f126619c9f28",
    "created_at": "2020-06-10T13:20:05Z",
    "updated_at": "2020-09-29T08:41:08Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r438115301",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/438115301"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r438115301"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/438115301/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 23,
    "side": "RIGHT",
    "in_reply_to_id": 438064667
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/438115672",
    "pull_request_review_id": 428044507,
    "id": 438115672,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODExNTY3Mg==",
    "diff_hunk": "@@ -951,11 +952,16 @@ class CNode\n \n     void PushAddress(const CAddress& _addr, FastRandomContext &insecure_rand)\n     {\n+        // Whether the peer supports the address in `_addr`. For example,\n+        // nodes that do not implement BIP155 cannot receive Tor v3 addresses\n+        // because they require ADDRv2 (BIP155) encoding.\n+        const bool supported = m_supports_addrv2 || _addr.IsAddrV1Compatible();",
    "path": "src/net.h",
    "position": null,
    "original_position": 15,
    "commit_id": "fb90d274e34b8f9814efe7c35a5e8e647ee1ab4b",
    "original_commit_id": "3deae0ce03e7d83f8f8409a9e01eb8a0fa9018d8",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Done: https://github.com/bitcoin/bitcoin/compare/baf43171a670b5e41823836c889ecf6b2934e3bf..0bbe82d95b54e7727f966f4f8944f126619c9f28",
    "created_at": "2020-06-10T13:20:37Z",
    "updated_at": "2020-09-29T08:41:08Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r438115672",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/438115672"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r438115672"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/438115672/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 958,
    "side": "RIGHT",
    "in_reply_to_id": 438049838
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/438115800",
    "pull_request_review_id": 428044675,
    "id": 438115800,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODExNTgwMA==",
    "diff_hunk": "@@ -16,14 +16,30 @@\n #include <string>\n #include <vector>\n \n+/**\n+ * A network type.\n+ * @note An address may belong to more than one network, for example `10.0.0.1`\n+ * belongs to both `NET_UNROUTABLE` and `NET_IPV4`.\n+ * Keep these sequential starting from 0 and `NET_MAX` as last.\n+ */\n enum Network\n {\n+    /// Addresses from these networks are not publicly routable on the global Internet.\n     NET_UNROUTABLE = 0,\n+\n+    /// IPv4\n     NET_IPV4,\n+\n+    /// IPv6\n     NET_IPV6,\n+\n+    /// TORv2\n     NET_ONION,\n+\n+    /// A set of dummy addresses that map a name to an IPv6 address.\n     NET_INTERNAL,\n \n+    /// Dummy value to indicate the number of NET_* constants.",
    "path": "src/netaddress.h",
    "position": null,
    "original_position": 27,
    "commit_id": "fb90d274e34b8f9814efe7c35a5e8e647ee1ab4b",
    "original_commit_id": "21e62e32456b299f391b261d684a26ca5b12e3c8",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Done: https://github.com/bitcoin/bitcoin/compare/baf43171a670b5e41823836c889ecf6b2934e3bf..0bbe82d95b54e7727f966f4f8944f126619c9f28",
    "created_at": "2020-06-10T13:20:48Z",
    "updated_at": "2020-09-29T08:41:08Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r438115800",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/438115800"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r438115800"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/438115800/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 67,
    "side": "RIGHT",
    "in_reply_to_id": 438044714
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/450941410",
    "pull_request_review_id": 443990536,
    "id": 450941410,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDk0MTQxMA==",
    "diff_hunk": "@@ -2438,9 +2441,27 @@ void ProcessMessage(\n         return;\n     }\n \n-    if (msg_type == NetMsgType::ADDR) {\n+    if (msg_type == NetMsgType::ADDR || msg_type == NetMsgType::ADDRv2) {\n+        const auto version_orig = vRecv.GetVersion();\n+        if (msg_type == NetMsgType::ADDRv2) {\n+            vRecv.SetVersion(version_orig | ADDRv2_FORMAT);",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 18,
    "commit_id": "fb90d274e34b8f9814efe7c35a5e8e647ee1ab4b",
    "original_commit_id": "6a5f357c9b189c2e427b669cace9d026b0c0e335",
    "user": {
      "login": "naumenkogs",
      "id": 7975071,
      "node_id": "MDQ6VXNlcjc5NzUwNzE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/naumenkogs",
      "html_url": "https://github.com/naumenkogs",
      "followers_url": "https://api.github.com/users/naumenkogs/followers",
      "following_url": "https://api.github.com/users/naumenkogs/following{/other_user}",
      "gists_url": "https://api.github.com/users/naumenkogs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
      "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
      "repos_url": "https://api.github.com/users/naumenkogs/repos",
      "events_url": "https://api.github.com/users/naumenkogs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I have never seen this variable used like this before and I've just spent 10 minutes trying to figure out what's going on, and I'm still a little confused. Maybe worth adding a comment?\r\nI think this code is counter-intuitive atm.",
    "created_at": "2020-07-07T15:12:23Z",
    "updated_at": "2020-09-29T08:41:08Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r450941410",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/450941410"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r450941410"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/450941410/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2604,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/451138256",
    "pull_request_review_id": 444243766,
    "id": 451138256,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTEzODI1Ng==",
    "diff_hunk": "@@ -769,6 +769,7 @@ class CNode\n     bool m_manual_connection{false};\n     bool fClient{false}; // set by version message\n     bool m_limited_node{false}; //after BIP159, set by version message\n+    std::atomic_bool m_supports_addrv2{false};",
    "path": "src/net.h",
    "position": null,
    "original_position": 4,
    "commit_id": "fb90d274e34b8f9814efe7c35a5e8e647ee1ab4b",
    "original_commit_id": "6a5f357c9b189c2e427b669cace9d026b0c0e335",
    "user": {
      "login": "dongcarl",
      "id": 3445290,
      "node_id": "MDQ6VXNlcjM0NDUyOTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3445290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dongcarl",
      "html_url": "https://github.com/dongcarl",
      "followers_url": "https://api.github.com/users/dongcarl/followers",
      "following_url": "https://api.github.com/users/dongcarl/following{/other_user}",
      "gists_url": "https://api.github.com/users/dongcarl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
      "organizations_url": "https://api.github.com/users/dongcarl/orgs",
      "repos_url": "https://api.github.com/users/dongcarl/repos",
      "events_url": "https://api.github.com/users/dongcarl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dongcarl/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I think perhaps `m_wants_addrv2` would be a more appropriate name",
    "created_at": "2020-07-07T20:56:35Z",
    "updated_at": "2020-09-29T08:41:08Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r451138256",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/451138256"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r451138256"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/451138256/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 772,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/451140392",
    "pull_request_review_id": 444243766,
    "id": 451140392,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTE0MDM5Mg==",
    "diff_hunk": "@@ -2438,9 +2441,27 @@ void ProcessMessage(\n         return;\n     }\n \n-    if (msg_type == NetMsgType::ADDR) {\n+    if (msg_type == NetMsgType::ADDR || msg_type == NetMsgType::ADDRv2) {\n+        const auto version_orig = vRecv.GetVersion();\n+        if (msg_type == NetMsgType::ADDRv2) {\n+            vRecv.SetVersion(version_orig | ADDRv2_FORMAT);\n+        }\n         std::vector<CAddress> vAddr;\n-        vRecv >> vAddr;\n+\n+        try {\n+            vRecv >> vAddr;\n+        } catch (const std::exception& e) {\n+            vRecv.SetVersion(version_orig);\n+\n+            LOCK(cs_main);\n+            Misbehaving(pfrom.GetId(), 20,\n+                strprintf(\n+                    \"Supplied us with a message that contains an unparsable address: %s\",\n+                    e.what()));\n+            return;\n+        }",
    "path": "src/net_processing.cpp",
    "position": 36,
    "original_position": 34,
    "commit_id": "fb90d274e34b8f9814efe7c35a5e8e647ee1ab4b",
    "original_commit_id": "6a5f357c9b189c2e427b669cace9d026b0c0e335",
    "user": {
      "login": "dongcarl",
      "id": 3445290,
      "node_id": "MDQ6VXNlcjM0NDUyOTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3445290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dongcarl",
      "html_url": "https://github.com/dongcarl",
      "followers_url": "https://api.github.com/users/dongcarl/followers",
      "following_url": "https://api.github.com/users/dongcarl/following{/other_user}",
      "gists_url": "https://api.github.com/users/dongcarl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
      "organizations_url": "https://api.github.com/users/dongcarl/orgs",
      "repos_url": "https://api.github.com/users/dongcarl/repos",
      "events_url": "https://api.github.com/users/dongcarl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dongcarl/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This part probably deserves some extra scrutiny, I know that it's generally better to avoid exceptions in C++, but when I first wrote this I didn't see another option here for bubbling up an error and handling it.",
    "created_at": "2020-07-07T21:00:35Z",
    "updated_at": "2020-09-29T08:41:08Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r451140392",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/451140392"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r451140392"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/451140392/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": 2597,
    "original_start_line": 2451,
    "start_side": "RIGHT",
    "line": 2608,
    "original_line": 2608,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/451141607",
    "pull_request_review_id": 444243766,
    "id": 451141607,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTE0MTYwNw==",
    "diff_hunk": "@@ -12,6 +12,12 @@\n #include <serialize.h>\n #include <uint256.h>\n \n+/**\n+ * A flag that is ORed into the protocol version to designate that a transaction\n+ * should be (un)serialized without witness data.\n+ * Make sure that this does not collide with any of the values in `version.h`\n+ * or with `ADDRv2_FORMAT`.\n+ */",
    "path": "src/primitives/transaction.h",
    "position": null,
    "original_position": 9,
    "commit_id": "fb90d274e34b8f9814efe7c35a5e8e647ee1ab4b",
    "original_commit_id": "9b94ac3768449fcbaf4368e24abc6790665e8191",
    "user": {
      "login": "dongcarl",
      "id": 3445290,
      "node_id": "MDQ6VXNlcjM0NDUyOTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3445290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dongcarl",
      "html_url": "https://github.com/dongcarl",
      "followers_url": "https://api.github.com/users/dongcarl/followers",
      "following_url": "https://api.github.com/users/dongcarl/following{/other_user}",
      "gists_url": "https://api.github.com/users/dongcarl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
      "organizations_url": "https://api.github.com/users/dongcarl/orgs",
      "repos_url": "https://api.github.com/users/dongcarl/repos",
      "events_url": "https://api.github.com/users/dongcarl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dongcarl/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Potential followup: perhaps there is something cleaner we can do in the future for serialization/deserialization options other than abusing the protocol version.",
    "created_at": "2020-07-07T21:02:54Z",
    "updated_at": "2020-09-29T08:41:08Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r451141607",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/451141607"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r451141607"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/451141607/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 15,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 22,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/452338207",
    "pull_request_review_id": 445774634,
    "id": 452338207,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjMzODIwNw==",
    "diff_hunk": "@@ -2438,9 +2441,27 @@ void ProcessMessage(\n         return;\n     }\n \n-    if (msg_type == NetMsgType::ADDR) {\n+    if (msg_type == NetMsgType::ADDR || msg_type == NetMsgType::ADDRv2) {\n+        const auto version_orig = vRecv.GetVersion();\n+        if (msg_type == NetMsgType::ADDRv2) {\n+            vRecv.SetVersion(version_orig | ADDRv2_FORMAT);",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 18,
    "commit_id": "fb90d274e34b8f9814efe7c35a5e8e647ee1ab4b",
    "original_commit_id": "6a5f357c9b189c2e427b669cace9d026b0c0e335",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Yes, that is a bit hackish but I do not think there is a cleaner way. It is somewhat similar to [iostream::setf()](http://www.cplusplus.com/reference/ios/ios_base/setf/) which is used to configure the stream wrt how data should be parsed or printed, e.g.:\r\n```cpp\r\ncout.setf(ios::boolalpha);\r\ncout << true; // prints (serializes as) \"true\" rather than \"1\"\r\n```\r\n\r\nI added comments like:\r\n```cpp\r\n// Sneak ADDRv2_FORMAT into the version so that the CNetAddr and CAddress\r\n// unserialize methods know that an address in v2 format is coming.\r\n```\r\nto all places where we do that.",
    "created_at": "2020-07-09T16:21:34Z",
    "updated_at": "2020-09-29T08:41:08Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r452338207",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/452338207"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r452338207"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/452338207/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2604,
    "side": "RIGHT",
    "in_reply_to_id": 450941410
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/452338790",
    "pull_request_review_id": 445775473,
    "id": 452338790,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjMzODc5MA==",
    "diff_hunk": "@@ -769,6 +769,7 @@ class CNode\n     bool m_manual_connection{false};\n     bool fClient{false}; // set by version message\n     bool m_limited_node{false}; //after BIP159, set by version message\n+    std::atomic_bool m_supports_addrv2{false};",
    "path": "src/net.h",
    "position": null,
    "original_position": 4,
    "commit_id": "fb90d274e34b8f9814efe7c35a5e8e647ee1ab4b",
    "original_commit_id": "6a5f357c9b189c2e427b669cace9d026b0c0e335",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Renamed to `m_wants_addrv2`.",
    "created_at": "2020-07-09T16:22:40Z",
    "updated_at": "2020-09-29T08:41:08Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r452338790",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/452338790"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r452338790"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/452338790/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 772,
    "side": "RIGHT",
    "in_reply_to_id": 451138256
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/452343713",
    "pull_request_review_id": 445781727,
    "id": 452343713,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjM0MzcxMw==",
    "diff_hunk": "@@ -2438,9 +2441,27 @@ void ProcessMessage(\n         return;\n     }\n \n-    if (msg_type == NetMsgType::ADDR) {\n+    if (msg_type == NetMsgType::ADDR || msg_type == NetMsgType::ADDRv2) {\n+        const auto version_orig = vRecv.GetVersion();\n+        if (msg_type == NetMsgType::ADDRv2) {\n+            vRecv.SetVersion(version_orig | ADDRv2_FORMAT);\n+        }\n         std::vector<CAddress> vAddr;\n-        vRecv >> vAddr;\n+\n+        try {\n+            vRecv >> vAddr;\n+        } catch (const std::exception& e) {\n+            vRecv.SetVersion(version_orig);\n+\n+            LOCK(cs_main);\n+            Misbehaving(pfrom.GetId(), 20,\n+                strprintf(\n+                    \"Supplied us with a message that contains an unparsable address: %s\",\n+                    e.what()));\n+            return;\n+        }",
    "path": "src/net_processing.cpp",
    "position": 36,
    "original_position": 34,
    "commit_id": "fb90d274e34b8f9814efe7c35a5e8e647ee1ab4b",
    "original_commit_id": "6a5f357c9b189c2e427b669cace9d026b0c0e335",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Yes, I also couldn't find a better way to cancel the parsing. I think that is a limitation of our ser/unser framework - its not possible to cancel the parsing of multiple entries in the middle (e.g. when parsing a `std::vector` of `CNetAddr`) without using an exception.\r\n\r\nAnother way, but that's not good, would be to not throw an exception from `CNetAddr` unserialize methods, consume the bogus data from the stream, mark the object as invalid, continue parsing the remaining `CNetAddr` objects and later remove the invalid objects. But that is not good because we do not want to continue parsing the data once we see that it is clearly malformed/malicious.",
    "created_at": "2020-07-09T16:30:32Z",
    "updated_at": "2020-09-29T08:41:08Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r452343713",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/452343713"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r452343713"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/452343713/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": 2597,
    "original_start_line": 2451,
    "start_side": "RIGHT",
    "line": 2608,
    "original_line": 2608,
    "side": "RIGHT",
    "in_reply_to_id": 451140392
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/452451052",
    "pull_request_review_id": 445918780,
    "id": 452451052,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjQ1MTA1Mg==",
    "diff_hunk": "@@ -12,6 +12,12 @@\n #include <serialize.h>\n #include <uint256.h>\n \n+/**\n+ * A flag that is ORed into the protocol version to designate that a transaction\n+ * should be (un)serialized without witness data.\n+ * Make sure that this does not collide with any of the values in `version.h`\n+ * or with `ADDRv2_FORMAT`.\n+ */",
    "path": "src/primitives/transaction.h",
    "position": null,
    "original_position": 9,
    "commit_id": "fb90d274e34b8f9814efe7c35a5e8e647ee1ab4b",
    "original_commit_id": "9b94ac3768449fcbaf4368e24abc6790665e8191",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Right, there is room for improvement here. I opened https://github.com/bitcoin/bitcoin/issues/19477 to track this.",
    "created_at": "2020-07-09T19:47:08Z",
    "updated_at": "2020-09-29T08:41:08Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r452451052",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/452451052"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r452451052"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/452451052/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 15,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 22,
    "side": "RIGHT",
    "in_reply_to_id": 451141607
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/452462111",
    "pull_request_review_id": 445933446,
    "id": 452462111,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjQ2MjExMQ==",
    "diff_hunk": "@@ -2438,9 +2441,27 @@ void ProcessMessage(\n         return;\n     }\n \n-    if (msg_type == NetMsgType::ADDR) {\n+    if (msg_type == NetMsgType::ADDR || msg_type == NetMsgType::ADDRv2) {\n+        const auto version_orig = vRecv.GetVersion();\n+        if (msg_type == NetMsgType::ADDRv2) {\n+            vRecv.SetVersion(version_orig | ADDRv2_FORMAT);\n+        }\n         std::vector<CAddress> vAddr;\n-        vRecv >> vAddr;\n+\n+        try {\n+            vRecv >> vAddr;\n+        } catch (const std::exception& e) {\n+            vRecv.SetVersion(version_orig);\n+\n+            LOCK(cs_main);\n+            Misbehaving(pfrom.GetId(), 20,\n+                strprintf(\n+                    \"Supplied us with a message that contains an unparsable address: %s\",\n+                    e.what()));\n+            return;\n+        }",
    "path": "src/net_processing.cpp",
    "position": 36,
    "original_position": 34,
    "commit_id": "fb90d274e34b8f9814efe7c35a5e8e647ee1ab4b",
    "original_commit_id": "6a5f357c9b189c2e427b669cace9d026b0c0e335",
    "user": {
      "login": "dongcarl",
      "id": 3445290,
      "node_id": "MDQ6VXNlcjM0NDUyOTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3445290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dongcarl",
      "html_url": "https://github.com/dongcarl",
      "followers_url": "https://api.github.com/users/dongcarl/followers",
      "following_url": "https://api.github.com/users/dongcarl/following{/other_user}",
      "gists_url": "https://api.github.com/users/dongcarl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
      "organizations_url": "https://api.github.com/users/dongcarl/orgs",
      "repos_url": "https://api.github.com/users/dongcarl/repos",
      "events_url": "https://api.github.com/users/dongcarl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dongcarl/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "@sipa Could you advise on whether there's another way or if the current way is alright?",
    "created_at": "2020-07-09T20:09:59Z",
    "updated_at": "2020-09-29T08:41:08Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r452462111",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/452462111"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r452462111"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/452462111/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": 2597,
    "original_start_line": 2451,
    "start_side": "RIGHT",
    "line": 2608,
    "original_line": 2608,
    "side": "RIGHT",
    "in_reply_to_id": 451140392
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/455188027",
    "pull_request_review_id": 449131372,
    "id": 455188027,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTE4ODAyNw==",
    "diff_hunk": "@@ -2405,6 +2405,9 @@ void ProcessMessage(\n                       pfrom.m_tx_relay == nullptr ? \"block-relay\" : \"full-relay\");\n         }\n \n+        // Signal ADDRv2 support (BIP155).\n+        connman->PushMessage(&pfrom, msgMaker.Make(NetMsgType::SENDADDRv2));",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 5,
    "commit_id": "fb90d274e34b8f9814efe7c35a5e8e647ee1ab4b",
    "original_commit_id": "2533ce03c71a865ba230b7ff770dd04cd8be5ea1",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "There are a couple of things to note about this signalling method with our current version handshake:\r\n\r\n1. we currently send a `getaddr` before this, on receipt of the peer's `version` message. If we don't change that, then the peer will receive the `getaddr` _before_ the `sendaddrv2` message, and will therefore respond with an `addr` message. We only ever send one `getaddr` message per peer to get the large list of addresses.\r\n\r\n2. we also add our own address to `vAddrToSend` on receipt of the `version` message to advertise our address to the peer. That gets sent out in an `addr` message in the `SendMessages()` loop on the `m_next_addr_send` loop. I expect that will be on the first call time through `SendMessages()` since `m_next_addr_send` is initialized to 0. That means we'll advertise our local address using an `add` message because we won't have received our peer's `sendaddrv2` message yet.",
    "created_at": "2020-07-15T16:45:20Z",
    "updated_at": "2020-09-29T08:41:08Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r455188027",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/455188027"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r455188027"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/455188027/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2435,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/458896584",
    "pull_request_review_id": 453453128,
    "id": 458896584,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODg5NjU4NA==",
    "diff_hunk": "@@ -2405,6 +2405,9 @@ void ProcessMessage(\n                       pfrom.m_tx_relay == nullptr ? \"block-relay\" : \"full-relay\");\n         }\n \n+        // Signal ADDRv2 support (BIP155).\n+        connman->PushMessage(&pfrom, msgMaker.Make(NetMsgType::SENDADDRv2));",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 5,
    "commit_id": "fb90d274e34b8f9814efe7c35a5e8e647ee1ab4b",
    "original_commit_id": "2533ce03c71a865ba230b7ff770dd04cd8be5ea1",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "The first point is easy to fix:\r\n\r\n<details>\r\n<summary>patch to change the order of initial messages</summary>\r\n\r\n```diff\r\ndiff --git i/src/net_processing.cpp w/src/net_processing.cpp\r\nindex 5af63acc4..296237075 100644\r\n--- i/src/net_processing.cpp\r\n+++ w/src/net_processing.cpp\r\n@@ -2318,12 +2318,15 @@ void ProcessMessage(\r\n         // Be shy and don't send version until we hear\r\n         if (pfrom.fInbound)\r\n             PushNodeVersion(pfrom, connman, GetAdjustedTime());\r\n \r\n         connman.PushMessage(&pfrom, CNetMsgMaker(INIT_PROTO_VERSION).Make(NetMsgType::VERACK));\r\n \r\n+        // Signal ADDRv2 support (BIP155).\r\n+        connman.PushMessage(&pfrom, CNetMsgMaker(INIT_PROTO_VERSION).Make(NetMsgType::SENDADDRv2));\r\n+\r\n         pfrom.nServices = nServices;\r\n         pfrom.SetAddrLocal(addrMe);\r\n         {\r\n             LOCK(pfrom.cs_SubVer);\r\n             pfrom.cleanSubVer = cleanSubVer;\r\n         }\r\n@@ -2428,15 +2431,12 @@ void ProcessMessage(\r\n             LogPrintf(\"New outbound peer connected: version: %d, blocks=%d, peer=%d%s (%s)\\n\",\r\n                       pfrom.nVersion.load(), pfrom.nStartingHeight,\r\n                       pfrom.GetId(), (fLogIPs ? strprintf(\", peeraddr=%s\", pfrom.addr.ToString()) : \"\"),\r\n                       pfrom.m_tx_relay == nullptr ? \"block-relay\" : \"full-relay\");\r\n         }\r\n \r\n-        // Signal ADDRv2 support (BIP155).\r\n-        connman.PushMessage(&pfrom, msgMaker.Make(NetMsgType::SENDADDRv2));\r\n-\r\n         if (pfrom.nVersion >= SENDHEADERS_VERSION) {\r\n             // Tell our peer we prefer to receive headers rather than inv's\r\n             // We send this to non-NODE NETWORK peers as well, because even\r\n             // non-NODE NETWORK peers can announce blocks (such as pruning\r\n             // nodes)\r\n             connman.PushMessage(&pfrom, msgMaker.Make(NetMsgType::SENDHEADERS));\r\n```\r\n</details>\r\n\r\nwould change the order of sent messages from `verack, getaddr, sendaddrv2` to `verack, sendaddrv2, getaddr`.\r\n\r\nFor the second point - the current code in this PR will assume no-addrv2 support when `CNode::PushAddress()` is called early when advertising our address. As a result if our address is e.g. TORv3, then it will not be appended to `vAddrToSend[]`. Hmm...",
    "created_at": "2020-07-22T15:51:30Z",
    "updated_at": "2020-09-29T08:41:08Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r458896584",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/458896584"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r458896584"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/458896584/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2435,
    "side": "RIGHT",
    "in_reply_to_id": 455188027
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/460094264",
    "pull_request_review_id": 454941203,
    "id": 460094264,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDA5NDI2NA==",
    "diff_hunk": "@@ -2405,6 +2405,9 @@ void ProcessMessage(\n                       pfrom.m_tx_relay == nullptr ? \"block-relay\" : \"full-relay\");\n         }\n \n+        // Signal ADDRv2 support (BIP155).\n+        connman->PushMessage(&pfrom, msgMaker.Make(NetMsgType::SENDADDRv2));",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 5,
    "commit_id": "fb90d274e34b8f9814efe7c35a5e8e647ee1ab4b",
    "original_commit_id": "2533ce03c71a865ba230b7ff770dd04cd8be5ea1",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "On the second point:\r\n\r\n> we also add our own address to vAddrToSend on receipt of the version message to advertise our address to the peer.\r\n\r\nRight, that is in `AdvertiseLocal()`, called from `PeerLogicValidation::SendMessages()`\r\n\r\n> That gets sent out in an addr message in the SendMessages() loop on the m_next_addr_send loop.\r\n\r\nNot necessary as an `addr` message - if we have received `sendaddrv2` and thus set `CNode::m_wants_addrv2` to `true`, then we will send `addrv2` message. But see below, you are right that on the first iteration we still have not received `sendaddrv2`.\r\n\r\n> I expect that will be on the first call time through SendMessages() since m_next_addr_send is initialized to 0.\r\n\r\nRight.\r\n\r\n> That means we'll advertise our local address using an addr message because we won't have received our peer's sendaddrv2 message yet.\r\n\r\nYes, for the first call to `AdvertiseLocal()` and only if our address is `addr`-compatible. Notice the following:\r\n\r\n* `AdvertiseLocal()` is being called periodically (`AVG_LOCAL_ADDRESS_BROADCAST_INTERVAL`)\r\n* If our address is `addr`-compatible, then broadcasting it in `addr` message is fine, even if the peer has asked for `addrv2` messages via `sendaddrv2`.\r\n* If our address is not `addr`-compatible (e.g. TORv3) then the first call to `AdvertiseLocal()` will end up being a noop because it will call `CNode::PushAddress()` which will see that the address being pushed is not supported by the peer and so it will not add it to `vAddrToSend[]`.\r\n  * On the next call to `AdvertiseLocal()` we should already have received `sendaddrv2` and thus be aware that the peer supports `addrv2` and so will properly advertise our address in `addrv2` message.\r\n\r\n**Verdict**\r\nA \"problem\" exists only if our address is not `addrv2`-compatible (e.g. TORv3) and that \"problem\" manifests as the advertising of our address to the peer will not be done immediately when the connection is established, but some time later.\r\n\r\nIs that acceptable?",
    "created_at": "2020-07-24T14:38:20Z",
    "updated_at": "2020-09-29T08:41:08Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r460094264",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/460094264"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r460094264"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/460094264/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2435,
    "side": "RIGHT",
    "in_reply_to_id": 455188027
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/460107102",
    "pull_request_review_id": 454958008,
    "id": 460107102,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDEwNzEwMg==",
    "diff_hunk": "@@ -2405,6 +2405,9 @@ void ProcessMessage(\n                       pfrom.m_tx_relay == nullptr ? \"block-relay\" : \"full-relay\");\n         }\n \n+        // Signal ADDRv2 support (BIP155).\n+        connman->PushMessage(&pfrom, msgMaker.Make(NetMsgType::SENDADDRv2));",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 5,
    "commit_id": "fb90d274e34b8f9814efe7c35a5e8e647ee1ab4b",
    "original_commit_id": "2533ce03c71a865ba230b7ff770dd04cd8be5ea1",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I haven't reviewed the implementation, but if it's as you say:\r\n\r\n> - If our address is not addr-compatible (e.g. TORv3) then the first call to AdvertiseLocal() will end up being a noop because it will call CNode::PushAddress() which will see that the address being pushed is not supported by the peer and so it will not add it to vAddrToSend[].\r\n>   - On the next call to AdvertiseLocal() we should already have received sendaddrv2 and thus be aware that the peer supports addrv2 and so will properly advertise our address in addrv2 message.\r\n\r\nthen I think that's fine.\r\n\r\n(My note was more something to be aware of than saying that this would be a serious issue)",
    "created_at": "2020-07-24T14:58:49Z",
    "updated_at": "2020-09-29T08:41:08Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r460107102",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/460107102"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r460107102"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/460107102/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2435,
    "side": "RIGHT",
    "in_reply_to_id": 455188027
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/460120240",
    "pull_request_review_id": 454974907,
    "id": 460120240,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDEyMDI0MA==",
    "diff_hunk": "@@ -2405,6 +2405,9 @@ void ProcessMessage(\n                       pfrom.m_tx_relay == nullptr ? \"block-relay\" : \"full-relay\");\n         }\n \n+        // Signal ADDRv2 support (BIP155).\n+        connman->PushMessage(&pfrom, msgMaker.Make(NetMsgType::SENDADDRv2));",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 5,
    "commit_id": "fb90d274e34b8f9814efe7c35a5e8e647ee1ab4b",
    "original_commit_id": "2533ce03c71a865ba230b7ff770dd04cd8be5ea1",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Yes, here are the changes to `PushAddress()`:\r\n\r\nhttps://github.com/bitcoin/bitcoin/pull/19031/files#diff-1a8b9d1ad0a6fda5e751286c73102fc2R953\r\n\r\nIt will only append the address to `vAddrToSend[]` if it is supported by the peer (which is - either the peer supports `addrv2` or he does not but the address is `addr`-compatible).\r\n\r\nWe can even avoid the delay if we detect that `AdvertiseLocal()` did nothing (due to `addrv2` address and peer that does not support `addrv2` (yet)) and if that is the case then don't update `m_next_local_addr_send` so that the next iteration will also call `AdvertiseLocal()`.",
    "created_at": "2020-07-24T15:19:44Z",
    "updated_at": "2020-09-29T08:41:08Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r460120240",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/460120240"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r460120240"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/460120240/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2435,
    "side": "RIGHT",
    "in_reply_to_id": 455188027
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/463107253",
    "pull_request_review_id": 458547587,
    "id": 463107253,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzEwNzI1Mw==",
    "diff_hunk": "@@ -2405,6 +2405,9 @@ void ProcessMessage(\n                       pfrom.m_tx_relay == nullptr ? \"block-relay\" : \"full-relay\");\n         }\n \n+        // Signal ADDRv2 support (BIP155).\n+        connman->PushMessage(&pfrom, msgMaker.Make(NetMsgType::SENDADDRv2));",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 5,
    "commit_id": "fb90d274e34b8f9814efe7c35a5e8e647ee1ab4b",
    "original_commit_id": "2533ce03c71a865ba230b7ff770dd04cd8be5ea1",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I addressed the first concern and now the order of sent messages is `verack, sendaddrv2, getaddr`.",
    "created_at": "2020-07-30T16:06:11Z",
    "updated_at": "2020-09-29T08:41:08Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r463107253",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/463107253"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r463107253"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/463107253/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2435,
    "side": "RIGHT",
    "in_reply_to_id": 455188027
  }
]