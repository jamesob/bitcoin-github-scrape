amitiuttarwar,2021-07-25 19:07:00,approach ACK :) ,https://github.com/bitcoin/bitcoin/pull/22543#issuecomment-886244568,886244568,
practicalswift,2021-07-25 20:05:05,Concept ACK,https://github.com/bitcoin/bitcoin/pull/22543#issuecomment-886251008,886251008,
DrahtBot,2021-07-28 10:28:36,<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nNo conflicts as of last run.,https://github.com/bitcoin/bitcoin/pull/22543#issuecomment-888200225,888200225,
theStack,2021-07-31 20:18:21,Concept ACK,https://github.com/bitcoin/bitcoin/pull/22543#issuecomment-890399777,890399777,
Zero-1729,2021-08-03 15:22:25,Concept ACK,https://github.com/bitcoin/bitcoin/pull/22543#issuecomment-891938056,891938056,
Shubhankar-Gambhir,2021-08-05 18:45:14,Concept ACK,https://github.com/bitcoin/bitcoin/pull/22543#issuecomment-893695959,893695959,
laanwj,2021-08-16 16:47:23,"> Not sure why CI failed at L71 in mempool_limit.py, locally it checks out (see screenshot below). It looks like CI is reporting 67 for the no of txs in the mempool.\n\nCan't reproduce that locally here either. All the functional tests pass running master with this merged on top. It might be a rare race condition, or something specific to the 32-bit platform though.",https://github.com/bitcoin/bitcoin/pull/22543#issuecomment-899659135,899659135,
amitiuttarwar,2021-08-16 23:24:56,"hm, unfortunately looks like the 32-bit + dash [gui] run is failing on the same assertion ðŸ” ",https://github.com/bitcoin/bitcoin/pull/22543#issuecomment-899881987,899881987,
ShubhamPalriwala,2021-08-17 04:20:33,"It's failing when we take the minimum batch size of 22 transactions, increasing this will increase the test duration but the CI will pass as earlier",https://github.com/bitcoin/bitcoin/pull/22543#issuecomment-899982010,899982010,
ShubhamPalriwala,2021-08-18 10:28:41,"The CI passes now\nPS: Updated the batch size to 25 transactions below\nhttps://github.com/bitcoin/bitcoin/blob/3773532d682a3bfb0cea8898da10caa5f444a23e/test/functional/mempool_limit.py#L67\n\nThe PR is ready for a review",https://github.com/bitcoin/bitcoin/pull/22543#issuecomment-901002209,901002209,
theStack,2021-08-21 21:24:22,"@ShubhamPalriwala: Thanks for the changes. Currently the second commit (subject ""style: mempool_limit.py"") is not showing up any more, you probably forgot it in your latest force-push?",https://github.com/bitcoin/bitcoin/pull/22543#issuecomment-903178101,903178101,
ShubhamPalriwala,2021-08-24 20:27:05,The PR has been rebased and is ready to be reviewed,https://github.com/bitcoin/bitcoin/pull/22543#issuecomment-904951021,904951021,
ShubhamPalriwala,2021-08-26 09:40:48,"Thanks for the suggestions @theStack and @MarcoFalke!\n\nI've made, tested, and pushed the subsequent commits!\nThe PR is ready to be reviewed again :)",https://github.com/bitcoin/bitcoin/pull/22543#issuecomment-906253222,906253222,
ShubhamPalriwala,2021-09-02 10:50:39,"## PR ready for review\n\nThis PR has been made more understandable by the recent reviews! Changes have been made as suggested and it's once again Up for Review.",https://github.com/bitcoin/bitcoin/pull/22543#issuecomment-911529668,911529668,
josibake,2021-09-02 12:14:30,"ACK https://github.com/bitcoin/bitcoin/commit/e8a3ff3b586beb4e2bb2d77a3bf4d7b98a1a2df2\n\nnicely done, happy to see the `send_large_transactions` helper function being added to miniwallet!",https://github.com/bitcoin/bitcoin/pull/22543#issuecomment-911607555,911607555,
ShubhamPalriwala,2021-09-10 11:52:45,"## PR ready for review\n\nThank you to everybody who has reviewed it. However, the recent suggestions made the PR better and more helpful hence the changes as suggested have been implemented.",https://github.com/bitcoin/bitcoin/pull/22543#issuecomment-916845226,916845226,
MarcoFalke,2021-09-13 08:31:02,lmk if you want this merged or address the nits,https://github.com/bitcoin/bitcoin/pull/22543#issuecomment-917963111,917963111,
ShubhamPalriwala,2021-09-13 11:58:48,"@MarcoFalke the nits have been addressed! PTAL.\nThe PR is ready to be merged from my end :)",https://github.com/bitcoin/bitcoin/pull/22543#issuecomment-918119451,918119451,
MarcoFalke,2021-09-13 12:26:17,ack,https://github.com/bitcoin/bitcoin/pull/22543#issuecomment-918140536,918140536,
ShubhamPalriwala,2021-09-13 19:33:00,"Thank you for the git suggestions @amitiuttarwar \nUpdated and force-pushed the commits for a more clear understanding of the changes.\n\n## The PR is once again up for review. Hopefully one last time",https://github.com/bitcoin/bitcoin/pull/22543#issuecomment-918511490,918511490,
amitiuttarwar,2021-09-13 20:02:19,"ACK 08634e8, only git changes since last push (and one new line). ",https://github.com/bitcoin/bitcoin/pull/22543#issuecomment-918530519,918530519,
MarcoFalke,2021-09-14 09:12:49,Thanks for taking the feedback. Looks good now.,https://github.com/bitcoin/bitcoin/pull/22543#issuecomment-918966286,918966286,
theStack,2021-09-14 09:32:09,"Note that the helper `send_large_txs` with its current interface is misleading, as the passed fee_rate is not respected. It is merely passed to MiniWallet's `create_self_transfer`, but this function can't look in the future and thus is unable to know that several outputs are appended to the transaction after, modifying its size and hence also decreasing it's feerate. I'd suggest to either pass an ",https://github.com/bitcoin/bitcoin/pull/22543#issuecomment-918981930,918981930,
MarcoFalke,2021-09-14 09:38:52,"@theStack See also https://github.com/bitcoin/bitcoin/pull/22543#discussion_r701685136 , where I mentioned in-lining helps. I think we should pick the simplest/shortest code to achieve the goal of creating txs with different fee levels. The feerate doesn't need to be exact for the purposes of mempool eviction. The current code achieves its goal, but improvements are welcome if there are any.",https://github.com/bitcoin/bitcoin/pull/22543#issuecomment-918986896,918986896,
theStack,2021-09-14 14:10:34,"@MarcoFalke: Sure, but in this case the fee-rate is not just ""not exact"", but off by several orders of magnitute, considering that the tx's vsize changes from 96 to 67552 vbytes (>700x), and MiniWallet only calculates the fee based on the 96 vbytes. So the value passed to this function is neither really a fee-rate nor an absolute fee, but something weird in-between that has just been increased (by",https://github.com/bitcoin/bitcoin/pull/22543#issuecomment-919189698,919189698,
MarcoFalke,2021-07-28 12:22:39,"please don't commit large style changes in the same commit as refactors/features. This makes review harder because it is not clear what is a refactor/style-change/feature\n\nhttps://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#committing-patches",https://github.com/bitcoin/bitcoin/pull/22543#discussion_r678248900,678248900,test/functional/mempool_limit.py
ShubhamPalriwala,2021-08-03 14:45:41,"Thanks for the feedback, I've appended the commit with the code changes only (removed any ""only style changes"") as of now, hope this makes reviewing the PR easier now.\n\nLooking forward to your review",https://github.com/bitcoin/bitcoin/pull/22543#discussion_r681830378,681830378,test/functional/mempool_limit.py
NikhilBartwal,2021-08-10 20:50:05,"Hey, any specific reason that we are not checking whether the confirmations of the original `tx` are still 0 or not. I couldn't understand looking at the PR updates, so if you could explain :)",https://github.com/bitcoin/bitcoin/pull/22543#discussion_r686312386,686312386,test/functional/mempool_limit.py
NikhilBartwal,2021-08-10 20:51:50,nit: Type-o in `basee_fee` -> `base_fee` :),https://github.com/bitcoin/bitcoin/pull/22543#discussion_r686313503,686313503,test/functional/mempool_limit.py
NikhilBartwal,2021-08-10 20:55:08,"nit: Since, we are bumping up the `fee_rate` as a factor of `base_fee` with the `batch_of_txid`, IMO it would be more intuitive to use `for batch_of_txid in range(1,4):` so that we can simply use:\n```\nminiwallet.create_large_transactions(\n                node, txouts, 30, batch_of_txid * base_fee\n)\n```",https://github.com/bitcoin/bitcoin/pull/22543#discussion_r686315551,686315551,test/functional/mempool_limit.py
NikhilBartwal,2021-08-10 20:57:46,"In extension to the corresponding comment above, maybe we should add the confirmation test, something on the lines of:\n```\ntxdata = node.gettransaction(tx_to_be_evicted)\nassert txdata['confirmations'] == 0\n```",https://github.com/bitcoin/bitcoin/pull/22543#discussion_r686317188,686317188,test/functional/mempool_limit.py
NikhilBartwal,2021-08-10 21:07:21,nit: Type-o in `minrelytxfee` -> `minrelaytxfee` :),https://github.com/bitcoin/bitcoin/pull/22543#discussion_r686322985,686322985,test/functional/mempool_limit.py
ShubhamPalriwala,2021-08-11 04:58:21,"With respect to this and the above comment, `gettransaction(tx_to_be_evicted)` is a method that requires a wallet to be loaded, contradictory to the purpose of this PR. Hence, we're just verifying if it's evicted from the mempool!",https://github.com/bitcoin/bitcoin/pull/22543#discussion_r686491618,686491618,test/functional/mempool_limit.py
ShubhamPalriwala,2021-08-11 04:59:07,"Thread has been continued [here](https://github.com/bitcoin/bitcoin/pull/22543#discussion_r686491618)\n",https://github.com/bitcoin/bitcoin/pull/22543#discussion_r686491848,686491848,test/functional/mempool_limit.py
ShubhamPalriwala,2021-08-11 05:11:29,Done,https://github.com/bitcoin/bitcoin/pull/22543#discussion_r686495941,686495941,test/functional/mempool_limit.py
ShubhamPalriwala,2021-08-11 05:11:44,Done! Thanks,https://github.com/bitcoin/bitcoin/pull/22543#discussion_r686496041,686496041,test/functional/mempool_limit.py
ShubhamPalriwala,2021-08-11 05:11:58,Done!,https://github.com/bitcoin/bitcoin/pull/22543#discussion_r686496119,686496119,test/functional/mempool_limit.py
hg333,2021-08-12 06:06:10,Why is it sufficient to mine 99 blocks?,https://github.com/bitcoin/bitcoin/pull/22543#discussion_r687413483,687413483,test/functional/mempool_limit.py
DariusParvin,2021-08-14 18:51:12,nit: Maybe just me but I think `miniwallet.generate(92)` is easier to read since the comment already describes where the 92 comes from. ,https://github.com/bitcoin/bitcoin/pull/22543#discussion_r688979803,688979803,test/functional/mempool_limit.py
DariusParvin,2021-08-16 06:55:45,"I think it would be more consistent with other functions (`send_self_transfer`, `create_self_transfer`, `sendrawtransaction`) for this to be named `send_large_transactions` since it is also broadcasting them. \n\nNote that it would also make sense to change `no_of_large_tx_created` to `no_of_large_tx_sent` or `no_of_large_tx_broadcasted`.",https://github.com/bitcoin/bitcoin/pull/22543#discussion_r689280712,689280712,test/functional/test_framework/wallet.py
DariusParvin,2021-08-16 06:59:07,"I tried smaller values instead of 30 transactions per batch, and the tests pass with 22 transactions. Is there a specific reason for it to be 30? If not then it seems like 22 is better since it is faster.",https://github.com/bitcoin/bitcoin/pull/22543#discussion_r689282534,689282534,test/functional/mempool_limit.py
ShubhamPalriwala,2021-08-16 08:53:21,"Valid points! Will make suggested changes here to maintain the consistency\nEdit: Done",https://github.com/bitcoin/bitcoin/pull/22543#discussion_r689354565,689354565,test/functional/test_framework/wallet.py
ShubhamPalriwala,2021-08-16 08:54:26,"Just wanted to populate the mempool that's why went for 30, let's do 22 then!\nEdit: Done",https://github.com/bitcoin/bitcoin/pull/22543#discussion_r689355334,689355334,test/functional/mempool_limit.py
DariusParvin,2021-08-16 16:34:54,"I think it might be because the block that the coinbase utxo is included in is counted as the first block, so you'd need 99 additional blocks for it to be 100 blocks deep?\n\nBut also, is it necessary to use `generate`? I think this test can be sped up using the miniwallet function `scan_blocks` instead. There are a few examples of other functional tests using it. Note that you'd need to remove ",https://github.com/bitcoin/bitcoin/pull/22543#discussion_r689689263,689689263,test/functional/mempool_limit.py
amitiuttarwar,2021-08-16 16:40:10,"```suggestion\n        self.log.info(""Check that mempoolminfee is minrelaytxfee"")\n```",https://github.com/bitcoin/bitcoin/pull/22543#discussion_r689692932,689692932,test/functional/mempool_limit.py
amitiuttarwar,2021-08-16 16:59:17,"```suggestion\n        assert_equal(no_of_tx_created, no_of_tx_ids)\n```",https://github.com/bitcoin/bitcoin/pull/22543#discussion_r689706218,689706218,test/functional/test_framework/wallet.py
amitiuttarwar,2021-08-16 17:06:22,variable naming suggestion: replacing `no_of_tx_ids` with `num_txns` ,https://github.com/bitcoin/bitcoin/pull/22543#discussion_r689710851,689710851,test/functional/test_framework/wallet.py
amitiuttarwar,2021-08-16 17:09:18,"since this is being added as a shared helper, would be nice to add a docstring to explain what this function is doing & possibly guidance on how the callers should provide the params. ",https://github.com/bitcoin/bitcoin/pull/22543#discussion_r689712720,689712720,test/functional/test_framework/wallet.py
amitiuttarwar,2021-08-16 17:12:32,"did you mean this comment to be a line prior? since the serialization is the previous line & the sending is the next line. \n\nbut you could just get rid of this comment. generally we want to add comments if we can explain _why_ we're doing something. and let the code explain _what_ is happening. so in this case, this comment isn't adding any new information. ",https://github.com/bitcoin/bitcoin/pull/22543#discussion_r689714991,689714991,test/functional/test_framework/wallet.py
amitiuttarwar,2021-08-16 17:24:26,"I'm not really seeing the value of this local variable. if there was a way to return early in the for loop, incrementing the number could be a way to keep track of successes. but since there isn't any logic of the sort, any unsuccessful attempts would simply cause an error (eg. by `sendrawtransaction` throwing an exception). so `assert_equal(no_of_tx_created,no_of_tx_ids)` isn't actually increasin",https://github.com/bitcoin/bitcoin/pull/22543#discussion_r689722737,689722737,test/functional/test_framework/wallet.py
amitiuttarwar,2021-08-16 17:31:07,"you could move this line down to right before the for loop where it gets used \n\nto clarify, I'm talking about: `txouts = gen_return_txouts()`",https://github.com/bitcoin/bitcoin/pull/22543#discussion_r689727241,689727241,test/functional/mempool_limit.py
ShubhamPalriwala,2021-08-16 20:51:57,This assertion is itself removed now!,https://github.com/bitcoin/bitcoin/pull/22543#discussion_r689851379,689851379,test/functional/test_framework/wallet.py
ShubhamPalriwala,2021-08-16 20:52:30,Done! Thanks,https://github.com/bitcoin/bitcoin/pull/22543#discussion_r689851680,689851680,test/functional/test_framework/wallet.py
Zero-1729,2021-08-17 20:33:44,"Minor nit:\n\n```suggestion\n        # Deliberately tries to create a tx with a fee less than the minimum mempool fee to assert that it does not get added to the mempool\n```",https://github.com/bitcoin/bitcoin/pull/22543#discussion_r690702210,690702210,test/functional/mempool_limit.py
Zero-1729,2021-08-17 20:49:54,"Could consider rewording to:\n\n```suggestion\n        # Increase the tx fee rate massively to give subsequent transactions a higher priority in the mempool\n```",https://github.com/bitcoin/bitcoin/pull/22543#discussion_r690712721,690712721,test/functional/mempool_limit.py
amitiuttarwar,2021-08-18 18:36:59,unnecessary new line,https://github.com/bitcoin/bitcoin/pull/22543#discussion_r691510124,691510124,test/functional/mempool_limit.py
amitiuttarwar,2021-08-18 18:40:50,"68 is no longer accurate\n\n```suggestion\n        # Generate 77 UTXOs to flood the mempool\n```\n\nthis demonstrates one of the reasons it's better for comments to supplement reasoning rather than what the code is doing- if the code changes, it's easy for the comments to fall out of date.\n\nSo a better option would be to remove the hardcoding of the UTXO number from these comments. ",https://github.com/bitcoin/bitcoin/pull/22543#discussion_r691512702,691512702,test/functional/mempool_limit.py
amitiuttarwar,2021-08-18 18:48:13,"since you introduced this code in the last commit, it would make more sense to just style it properly there & then not retouch in the subsequent commit ",https://github.com/bitcoin/bitcoin/pull/22543#discussion_r691517640,691517640,test/functional/mempool_limit.py
theStack,2021-08-20 15:37:57,"Listing the parameters in an extra line is a style that we don't follow for function definitions, as the following search in the codebase shows:\n```\n$ cd ./test/functional\n$ git grep ""def .*($""\ntest_framework/wallet.py:    def send_large_transactions(\n```\n(the only result is the one introduced in this commit)\n\n```suggestion\n    def send_large_transactions(self, node, array_of_lar",https://github.com/bitcoin/bitcoin/pull/22543#discussion_r693041377,693041377,test/functional/test_framework/wallet.py
theStack,2021-08-20 15:48:54,"For the CTransaction case, we have an explicit helper `tx_from_hex` that is already imported (i.e. you can remove the `from_hex` import again):\n```suggestion\n            tx_instance = tx_from_hex(hex)\n```",https://github.com/bitcoin/bitcoin/pull/22543#discussion_r693048747,693048747,test/functional/test_framework/wallet.py
theStack,2021-08-20 15:50:53,"nit: probably a matter of taste, but there's no need for introducing a temporary variable:\n```suggestion\n            self.sendrawtransaction(from_node=node, tx_hex=tx_instance.serialize().hex())\n```",https://github.com/bitcoin/bitcoin/pull/22543#discussion_r693050011,693050011,test/functional/test_framework/wallet.py
theStack,2021-08-20 15:55:42,"I'd suggest grouping the `COINBASE_MATURITY` import to the (test-framework related) ones below, i.e.:\n```suggestion\nfrom decimal import Decimal\n\nfrom test_framework.blocktools import COINBASE_MATURITY\nfrom test_framework.test_framework import BitcoinTestFramework\n```",https://github.com/bitcoin/bitcoin/pull/22543#discussion_r693053005,693053005,test/functional/mempool_limit.py
theStack,2021-08-20 16:09:24,I'd in some way mention here that each batch consists of 25 transactions -- without that it is not immedately clear how you end up with the number 77.,https://github.com/bitcoin/bitcoin/pull/22543#discussion_r693061654,693061654,test/functional/mempool_limit.py
theStack,2021-08-20 16:09:51,"```suggestion\n        # Deliberately try to create a tx with a fee less than the minimum mempool fee to assert that it does not get added to the mempool\n```",https://github.com/bitcoin/bitcoin/pull/22543#discussion_r693061901,693061901,test/functional/mempool_limit.py
ShubhamPalriwala,2021-08-20 16:48:57,Updated the code below the comments as `miniwallet.generate(1 + (3 * 25) + 1)` to make it clear,https://github.com/bitcoin/bitcoin/pull/22543#discussion_r693085854,693085854,test/functional/mempool_limit.py
theStack,2021-08-25 11:11:38,"Sorry for not noticing this earlier in my last review round, but it looks like the conversion from hex-to-tx is not necessary here, since `create_self_transfer` already provides you a `CTransaction` instance (can be accessed via `['tx']`). I.e. the method can even be shorter:\n\n```diff\n--- a/test/functional/test_framework/wallet.py\n+++ b/test/functional/test_framework/wallet.py\n@@ -187,12",https://github.com/bitcoin/bitcoin/pull/22543#discussion_r695649626,695649626,test/functional/test_framework/wallet.py
MarcoFalke,2021-08-25 11:18:24,"Would be nice to use `self.generate(miniwallet, ...)` for new code",https://github.com/bitcoin/bitcoin/pull/22543#discussion_r695653992,695653992,test/functional/mempool_limit.py
MarcoFalke,2021-08-25 11:18:30,same,https://github.com/bitcoin/bitcoin/pull/22543#discussion_r695654053,695654053,test/functional/mempool_limit.py
josibake,2021-08-31 10:46:35,"in https://github.com/bitcoin/bitcoin/pull/22543/commits/4902ce86afc6b9c8a7a72b1c91466fe26a00f9b9:\n\nid suggest using a named variable (instead of just 25) to make this more clear. also, `no_of_large...` should be `num_of_large...`:\n\n```suggestion\ntx_batch_size = 25\nfor batch_of_txid in range(1, 4):\n    # Increment the tx fee rate gradually by a factor of (base_fee) for each batch\n ",https://github.com/bitcoin/bitcoin/pull/22543#discussion_r699204455,699204455,test/functional/mempool_limit.py
josibake,2021-08-31 10:50:12,"is there a reason you have this helper function returning the same variable that was passed in? personally, i find this confusing and would not expect to have to handle a returned value if i were using this in another test",https://github.com/bitcoin/bitcoin/pull/22543#discussion_r699207130,699207130,test/functional/test_framework/wallet.py
ShubhamPalriwala,2021-09-02 10:30:06,Thank you for the naming suggestion. Has been fixed,https://github.com/bitcoin/bitcoin/pull/22543#discussion_r700956653,700956653,test/functional/mempool_limit.py
ShubhamPalriwala,2021-09-02 10:31:54,"Makes sense, as pointed out by other reviewers too, I have taken this into consideration, and converted this into a void function.",https://github.com/bitcoin/bitcoin/pull/22543#discussion_r700957832,700957832,test/functional/test_framework/wallet.py
josibake,2021-09-02 11:04:44,"this should be \n```suggestion\n            num_of_large_tx_sent += tx_batch_size\n```\nper https://www.python.org/dev/peps/pep-0008/#other-recommendations",https://github.com/bitcoin/bitcoin/pull/22543#discussion_r700978781,700978781,test/functional/mempool_limit.py
ShubhamPalriwala,2021-09-02 11:35:38,"All the styling changes have been handled in e8a3ff3b586beb4e2bb2d77a3bf4d7b98a1a2df2 :))\n\nHope this answers the query",https://github.com/bitcoin/bitcoin/pull/22543#discussion_r700998339,700998339,test/functional/mempool_limit.py
josibake,2021-09-02 12:12:26,"ah, gotcha, i missed that in the second commit.\n\nin general, I would avoid re-editing the same line multiple times in different commits as it requires the reviewer to look at the same line multiple times. not a big deal tho",https://github.com/bitcoin/bitcoin/pull/22543#discussion_r701022511,701022511,test/functional/mempool_limit.py
MarcoFalke,2021-09-02 15:45:05,"It is a bit confusing to mess with the style in unrelated lines in the first commit and then fix it up in the second commit. Why touch the lines in the first place?\n\n",https://github.com/bitcoin/bitcoin/pull/22543#discussion_r701210709,701210709,test/functional/mempool_limit.py
MarcoFalke,2021-09-02 15:45:35,It is a bit confusing to add new code in the wrong style and then fix it up in the second commit. Why not add it with the right style from the beginning?,https://github.com/bitcoin/bitcoin/pull/22543#discussion_r701211151,701211151,test/functional/mempool_limit.py
MarcoFalke,2021-09-02 15:47:57,"Is this needed to be put into miniwallet?\n\nIf not, it would be better suited in the test that uses it. Either as function or inline, because it is only called once.\n\nRegardless, the interface should be cleaned up. `array_of_large_tx` is *not* an array of txs, but of txouts.",https://github.com/bitcoin/bitcoin/pull/22543#discussion_r701213066,701213066,test/functional/test_framework/wallet.py
MarcoFalke,2021-09-02 15:48:49,It is a bit confusing to review if the `self.node[0]` -> `node` replacement is done in the same commit as the miniwallet changes. Maybe split it up?,https://github.com/bitcoin/bitcoin/pull/22543#discussion_r701213849,701213849,test/functional/mempool_limit.py
MarcoFalke,2021-09-02 15:49:20,"\n\nIt is a bit confusing to add new code in the wrong style and then fix it up in the second commit. Why not add it with the right style from the beginning?\n",https://github.com/bitcoin/bitcoin/pull/22543#discussion_r701214260,701214260,test/functional/mempool_limit.py
amitiuttarwar,2021-09-02 18:54:38,"I thought it could make sense as a shared helper since I expected the functionality to be useful in different tests as well. Although this only introduces one caller, would make it easier for others to find.",https://github.com/bitcoin/bitcoin/pull/22543#discussion_r701342916,701342916,test/functional/test_framework/wallet.py
MarcoFalke,2021-09-03 07:59:36,The issue I see is that the interface isn't correct in that the passed `fee_rate` won't be the fee rate of the tx returned. Inlining it would avoid the confusion in the interface.,https://github.com/bitcoin/bitcoin/pull/22543#discussion_r701685136,701685136,test/functional/test_framework/wallet.py
amitiuttarwar,2021-09-04 16:03:19,"gotcha, yeah agreed that the interface should be self-evident if the function is kept here, or moving it over would be another option. ",https://github.com/bitcoin/bitcoin/pull/22543#discussion_r702300385,702300385,test/functional/test_framework/wallet.py
ShubhamPalriwala,2021-09-10 11:49:14,Thank you for the suggestion. I have split up the commits,https://github.com/bitcoin/bitcoin/pull/22543#discussion_r706117202,706117202,test/functional/mempool_limit.py
ShubhamPalriwala,2021-09-10 11:50:19,"Makes sense, this is a very specific case hence I have moved the helper function to the `mempool_limit.py`\nThanks for the suggestion",https://github.com/bitcoin/bitcoin/pull/22543#discussion_r706117878,706117878,test/functional/test_framework/wallet.py
MarcoFalke,2021-09-13 08:20:43,"nit in the first commit:\n\nIt could make sense to drop the `batch_of_txid` argument and instead pass the calculated fee rate. This reduces the number of arguments passed to the function and increases its flexibility.\n\nThough, an alternative would be to simply inline the function.\n\n```suggestion\n            self.send_large_txs(node, miniwallet, txouts, (batch_of_txid + 1) * base_fee, t",https://github.com/bitcoin/bitcoin/pull/22543#discussion_r707108902,707108902,test/functional/mempool_limit.py
MarcoFalke,2021-09-13 08:28:23,"in the first commit: Is the `num_of_large_tx_sent` really needed?  Wouldn't this be equal to `num_of_batches * tx_batch_size`?\n\nAlso, the mempool should be deterministic, so it could make sense to check the exact number and mention in a comment that it should be less than `90` or `num_of_batches * tx_batch_size`?",https://github.com/bitcoin/bitcoin/pull/22543#discussion_r707114717,707114717,test/functional/mempool_limit.py
ShubhamPalriwala,2021-09-13 11:20:50,Makes sense! On it,https://github.com/bitcoin/bitcoin/pull/22543#discussion_r707239936,707239936,test/functional/mempool_limit.py
ShubhamPalriwala,2021-09-13 11:54:31,"Done! Assuming one can understand that `tx_batch_size * num_of_batches` is equal to the number of transactions created, works!",https://github.com/bitcoin/bitcoin/pull/22543#discussion_r707262139,707262139,test/functional/mempool_limit.py
