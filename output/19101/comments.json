[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/635792670",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19101#issuecomment-635792670",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19101",
    "id": 635792670,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzNTc5MjY3MA==",
    "user": {
      "login": "DrahtBot",
      "id": 39886733,
      "node_id": "MDQ6VXNlcjM5ODg2NzMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/39886733?u=3c1e73d828cf5a5850dfc25c8397c1cf751db5ac&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DrahtBot",
      "html_url": "https://github.com/DrahtBot",
      "followers_url": "https://api.github.com/users/DrahtBot/followers",
      "following_url": "https://api.github.com/users/DrahtBot/following{/other_user}",
      "gists_url": "https://api.github.com/users/DrahtBot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
      "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
      "repos_url": "https://api.github.com/users/DrahtBot/repos",
      "events_url": "https://api.github.com/users/DrahtBot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-29T06:45:30Z",
    "updated_at": "2021-08-19T02:42:28Z",
    "author_association": "CONTRIBUTOR",
    "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#22100](https://github.com/bitcoin/bitcoin/pull/22100) (refactor: Clean up new wallet spend, receive files added #21207 by ryanofsky)\n* [#21206](https://github.com/bitcoin/bitcoin/pull/21206) (refactor: Make CWalletTx sync state type-safe by ryanofsky)\n* [#15719](https://github.com/bitcoin/bitcoin/pull/15719) (Wallet passive startup by ryanofsky)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/635792670/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/635962953",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19101#issuecomment-635962953",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19101",
    "id": 635962953,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzNTk2Mjk1Mw==",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-29T13:08:31Z",
    "updated_at": "2020-09-03T18:44:28Z",
    "author_association": "CONTRIBUTOR",
    "body": "Rebased 197a40317f1240d2d94a6092ccb51bbf51b9e3b1 -> 7272686491f39b31e59d9d56d93ba1c57f7a732f ([`pr/novp.1`](https://github.com/ryanofsky/bitcoin/commits/pr/novp.1) -> [`pr/novp.2`](https://github.com/ryanofsky/bitcoin/commits/pr/novp.2), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/novp.1-rebase..pr/novp.2)) with updated base prs and fixed walletcontroller lifetime bug in test\r\nRebased 7272686491f39b31e59d9d56d93ba1c57f7a732f -> 924561d98958a9ef95417b195200f3c54a6e6bfd ([`pr/novp.2`](https://github.com/ryanofsky/bitcoin/commits/pr/novp.2) -> [`pr/novp.3`](https://github.com/ryanofsky/bitcoin/commits/pr/novp.3), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/novp.2-rebase..pr/novp.3)) to fix UndefinedBehaviorSanitizer error https://travis-ci.org/github/bitcoin/bitcoin/jobs/692548214#L4281 from #19098, also making changes to fix disable wallet build errors https://travis-ci.org/github/bitcoin/bitcoin/jobs/692548213#L3864 and importwallet_rescan segfault https://travis-ci.org/github/bitcoin/bitcoin/jobs/692548218#L10769\r\nRebased 924561d98958a9ef95417b195200f3c54a6e6bfd -> f2d9af627f9fce89c7a5acb763f13a82a5ca4b48 ([`pr/novp.3`](https://github.com/ryanofsky/bitcoin/commits/pr/novp.3) -> [`pr/novp.4`](https://github.com/ryanofsky/bitcoin/commits/pr/novp.4), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/novp.3-rebase..pr/novp.4)) with no changes to avoid travis ARM buster \"sudo: unable to resolve host travis-job-bitcoin-bitcoin-69472326\" error https://travis-ci.org/github/bitcoin/bitcoin/jobs/694723263 reported in #19171\r\nRebased f2d9af627f9fce89c7a5acb763f13a82a5ca4b48 -> de89a0916424f2376a7466829166109febfde431 ([`pr/novp.4`](https://github.com/ryanofsky/bitcoin/commits/pr/novp.4) -> [`pr/novp.5`](https://github.com/ryanofsky/bitcoin/commits/pr/novp.5), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/novp.4-rebase..pr/novp.5)) with no changes after base pr #19096 merged\r\nRebased de89a0916424f2376a7466829166109febfde431 -> e805b165cc51ee6e42e49d1807e8e1627834200c ([`pr/novp.5`](https://github.com/ryanofsky/bitcoin/commits/pr/novp.5) -> [`pr/novp.6`](https://github.com/ryanofsky/bitcoin/commits/pr/novp.6), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/novp.5-rebase..pr/novp.6)) on rebased base pr #19099 pr/wclient.4\r\nRebased e805b165cc51ee6e42e49d1807e8e1627834200c -> 0b60ae5da0b1424ee060af49e528a71e5644c758 ([`pr/novp.6`](https://github.com/ryanofsky/bitcoin/commits/pr/novp.6) -> [`pr/novp.7`](https://github.com/ryanofsky/bitcoin/commits/pr/novp.7), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/novp.6-rebase..pr/novp.7)) due to conflicts with #19250 and #19261 on rebased base pr #19099 pr/wclient.5\r\nRebased 0b60ae5da0b1424ee060af49e528a71e5644c758 -> 6c9a117438ec84b56ab255abd5d88112f6a7b615 ([`pr/novp.7`](https://github.com/ryanofsky/bitcoin/commits/pr/novp.7) -> [`pr/novp.8`](https://github.com/ryanofsky/bitcoin/commits/pr/novp.8), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/novp.7-rebase..pr/novp.8)) due to conflicts with #19300\r\nRebased 6c9a117438ec84b56ab255abd5d88112f6a7b615 -> d22a0535c69acd87f11b431373a3e27b11d3d4de ([`pr/novp.8`](https://github.com/ryanofsky/bitcoin/commits/pr/novp.8) -> [`pr/novp.9`](https://github.com/ryanofsky/bitcoin/commits/pr/novp.9), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/novp.8-rebase..pr/novp.9)) on top of #19099 pr/wclient.6\r\nRebased d22a0535c69acd87f11b431373a3e27b11d3d4de -> 6f799b15203e176446fcd323255ae84265df5280 ([`pr/novp.9`](https://github.com/ryanofsky/bitcoin/commits/pr/novp.9) -> [`pr/novp.10`](https://github.com/ryanofsky/bitcoin/commits/pr/novp.10), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/novp.9-rebase..pr/novp.10)) on top of #19099 pr/wclient.7\r\nRebased 6f799b15203e176446fcd323255ae84265df5280 -> 58c9550da715a26f32c7c4f568edbc8ca8f7f0bf ([`pr/novp.10`](https://github.com/ryanofsky/bitcoin/commits/pr/novp.10) -> [`pr/novp.11`](https://github.com/ryanofsky/bitcoin/commits/pr/novp.11), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/novp.10-rebase..pr/novp.11)) due to conflict with #19334\r\nRebased 58c9550da715a26f32c7c4f568edbc8ca8f7f0bf -> a00fc5348b60db885abd1f37265f6ce710ea3a6f ([`pr/novp.11`](https://github.com/ryanofsky/bitcoin/commits/pr/novp.11) -> [`pr/novp.12`](https://github.com/ryanofsky/bitcoin/commits/pr/novp.12), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/novp.11-rebase..pr/novp.12)) on top of #19099 pr/wclient.8\r\nRebased a00fc5348b60db885abd1f37265f6ce710ea3a6f -> 7fa4e3b98ed94f81a33f240691e069b8258ed3f6 ([`pr/novp.12`](https://github.com/ryanofsky/bitcoin/commits/pr/novp.12) -> [`pr/novp.13`](https://github.com/ryanofsky/bitcoin/commits/pr/novp.13), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/novp.12-rebase..pr/novp.13)) after #19099 merge and conflicts due to bitcoin-core/gui#35 and #19099\r\nRebased 7fa4e3b98ed94f81a33f240691e069b8258ed3f6 -> 9070db91d2d688ed73bdd1f829827b6d17a2d437 ([`pr/novp.13`](https://github.com/ryanofsky/bitcoin/commits/pr/novp.13) -> [`pr/novp.14`](https://github.com/ryanofsky/bitcoin/commits/pr/novp.14), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/novp.13-rebase..pr/novp.14)) due to conflicts with #19717 and #19671\r\nRebased 9070db91d2d688ed73bdd1f829827b6d17a2d437 -> 3df8f4480bf3dec79c2acbd1068554ed513d918c ([`pr/novp.14`](https://github.com/ryanofsky/bitcoin/commits/pr/novp.14) -> [`pr/novp.15`](https://github.com/ryanofsky/bitcoin/commits/pr/novp.15), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/novp.14-rebase..pr/novp.15)) due to conflict with #19754\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/635962953/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/636548255",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19101#issuecomment-636548255",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19101",
    "id": 636548255,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzNjU0ODI1NQ==",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?u=4a9af998e1a560b3f49c3827f453e1bcbe6a5cfb&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-31T23:38:44Z",
    "updated_at": "2020-05-31T23:38:44Z",
    "author_association": "MEMBER",
    "body": "Concept ACK, need to update commits in OP.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/636548255/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/699939653",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19101#issuecomment-699939653",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19101",
    "id": 699939653,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5OTkzOTY1Mw==",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-28T11:08:07Z",
    "updated_at": "2021-06-07T17:02:11Z",
    "author_association": "CONTRIBUTOR",
    "body": "Rebased 3df8f4480bf3dec79c2acbd1068554ed513d918c -> 22efdc8bccbe0c050eaa3b3dd19b274b0bb35489 ([`pr/novp.15`](https://github.com/ryanofsky/bitcoin/commits/pr/novp.15) -> [`pr/novp.16`](https://github.com/ryanofsky/bitcoin/commits/pr/novp.16), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/novp.15-rebase..pr/novp.16)) due to conflict with #19619\r\nRebased 22efdc8bccbe0c050eaa3b3dd19b274b0bb35489 -> 5927d2f8ba51b8bf4d5cf76550596da836662a3e ([`pr/novp.16`](https://github.com/ryanofsky/bitcoin/commits/pr/novp.16) -> [`pr/novp.17`](https://github.com/ryanofsky/bitcoin/commits/pr/novp.17), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/novp.16-rebase..pr/novp.17)) due to various conflicts\r\nRebased 5927d2f8ba51b8bf4d5cf76550596da836662a3e -> 86102b657ca9d3f8a373b80bafff8a44a7367ba8 ([`pr/novp.17`](https://github.com/ryanofsky/bitcoin/commits/pr/novp.17) -> [`pr/novp.18`](https://github.com/ryanofsky/bitcoin/commits/pr/novp.18), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/novp.17-rebase..pr/novp.18)) due to conflict with #21366\r\nUpdated 86102b657ca9d3f8a373b80bafff8a44a7367ba8 -> f940e2260ab1a1459656038c9b64c622a0eefbff ([`pr/novp.18`](https://github.com/ryanofsky/bitcoin/commits/pr/novp.18) -> [`pr/novp.19`](https://github.com/ryanofsky/bitcoin/commits/pr/novp.19), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/novp.18..pr/novp.19)) including #21572 and #21574 to fix appveyor failure https://ci.appveyor.com/project/DrahtBot/bitcoin/builds/38512882\r\nRebased f940e2260ab1a1459656038c9b64c622a0eefbff -> dd50d58bf462e1193927535aefc76105b11847f5 ([`pr/novp.19`](https://github.com/ryanofsky/bitcoin/commits/pr/novp.19) -> [`pr/novp.20`](https://github.com/ryanofsky/bitcoin/commits/pr/novp.20), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/novp.19-rebase..pr/novp.20)) after #21572 and #21574 merged\r\nRebased dd50d58bf462e1193927535aefc76105b11847f5 -> d97043e047380744ccda839996ab9b73a080d3ee ([`pr/novp.20`](https://github.com/ryanofsky/bitcoin/commits/pr/novp.20) -> [`pr/novp.21`](https://github.com/ryanofsky/bitcoin/commits/pr/novp.21), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/novp.20-rebase..pr/novp.21)) to fix fuzz timeout https://cirrus-ci.com/task/6394351371681792 #21639\r\nRebased d97043e047380744ccda839996ab9b73a080d3ee -> 6a68685d2d1f87827a51b7a5389bad4dcbd94e9b ([`pr/novp.21`](https://github.com/ryanofsky/bitcoin/commits/pr/novp.21) -> [`pr/novp.22`](https://github.com/ryanofsky/bitcoin/commits/pr/novp.22), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/novp.21-rebase..pr/novp.22)) due to conflict with #21634\r\nRebased 6a68685d2d1f87827a51b7a5389bad4dcbd94e9b -> 7aca6d3ced892dea96d50708eb8cd113705a915e ([`pr/novp.22`](https://github.com/ryanofsky/bitcoin/commits/pr/novp.22) -> [`pr/novp.23`](https://github.com/ryanofsky/bitcoin/commits/pr/novp.23), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/novp.22-rebase..pr/novp.23)) due to conflict with #20773\r\nRebased 7aca6d3ced892dea96d50708eb8cd113705a915e -> 4be544c7ec08a81952fd3f4349151cbb8bdb60e8 ([`pr/novp.23`](https://github.com/ryanofsky/bitcoin/commits/pr/novp.23) -> [`pr/novp.24`](https://github.com/ryanofsky/bitcoin/commits/pr/novp.24), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/novp.23-rebase..pr/novp.24)) due to conflict with bitcoin-core/gui#346 and #21207",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/699939653/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/857707241",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19101#issuecomment-857707241",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19101",
    "id": 857707241,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg1NzcwNzI0MQ==",
    "user": {
      "login": "kiminuo",
      "id": 58662979,
      "node_id": "MDQ6VXNlcjU4NjYyOTc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58662979?u=b48a1208deda9bd1756f21a35341ce98265355c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kiminuo",
      "html_url": "https://github.com/kiminuo",
      "followers_url": "https://api.github.com/users/kiminuo/followers",
      "following_url": "https://api.github.com/users/kiminuo/following{/other_user}",
      "gists_url": "https://api.github.com/users/kiminuo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kiminuo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
      "organizations_url": "https://api.github.com/users/kiminuo/orgs",
      "repos_url": "https://api.github.com/users/kiminuo/repos",
      "events_url": "https://api.github.com/users/kiminuo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kiminuo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-09T13:44:49Z",
    "updated_at": "2021-06-09T13:44:49Z",
    "author_association": "CONTRIBUTOR",
    "body": "@ryanofsky I find your PR good. It's easier to follow for me than the code in master branch. Concept ACK.\r\n\r\nI can see that #15638 of yours added `load.h` and `load.cpp` with functions like `VerifyWallets(..)`, `LoadWallets(..)`, etc. Now this PR adds `WalletContext` struct and `WalletClient` now contains `WalletContext* context()` function. \r\n\r\nI had a look where the functions from `load.h` are used and it looks like they are used only in `WalletClientImpl` (please correct me if I'm wrong). This brings me to my original question I had when I first glanced at your PR: Is it necessary to have the context struct? I mean what would happen if the functions from `load.h` were moved to `WalletClientImpl` and a test like the following one (https://github.com/bitcoin/bitcoin/pull/19101/files#diff-0bd88ab96ab5927299eb4e0d92d63ecbf9c8ee5753b918edc4c0eef38ce5d2c7) was replaced from:\r\n\r\n```cpp\r\nWalletContext& context = *node.walletClient().context();\r\nAddWallet(context, wallet);\r\nWalletModel walletModel(interfaces::MakeWallet(context, wallet), clientModel, platformStyle.get());\r\nRemoveWallet(context, wallet, std::nullopt);\r\n```\r\n\r\nto:\r\n\r\n```cpp\r\nWalletClient& walletClient = *node.walletClient();\r\nwalletClient.AddWallet(wallet);\r\n// WalletModel walletModel(interfaces::MakeWallet(context, wallet), clientModel, platformStyle.get()); // not sure here\r\nwalletClient.RemoveWallet(wallet, std::nullopt);\r\n```\r\n\r\nI don't really know if it is possible at all, I would just love to hear your opinion on this. ",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/857707241/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/857836270",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19101#issuecomment-857836270",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19101",
    "id": 857836270,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg1NzgzNjI3MA==",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-09T16:09:00Z",
    "updated_at": "2021-06-09T16:09:00Z",
    "author_association": "CONTRIBUTOR",
    "body": "You could merge `WalletContext` and `interfaces::WalletClientImpl` and move code from `load.cpp` to `interfaces.cpp`. If anything though, I'd like to do the opposite and make `interfaces.cpp` contain as little functionality as possible so `interfaces::Wallet` just serves the limited purpose of exposing a well-defined interface to the wallet from external GUI code, and `interfaces::WalletClient` is only used to expose an interface to the wallet from external node code. I think ideally internal wallet would remain more modular (database code separate from key management code separate from syncing code separate from balance tracking code), and not reference these interfaces which tie everything together.\r\n\r\nI think I'm not understanding the advantages of the specific Qt apptest change you mentioned. Qt test code does access internals of many layers because some checks are easier to do at the GUI layer, other are easier to do at the wallet layer, etc. I think it's important for this to be possible, but in general the interfaces should be designed more to hide internals than expose them.\r\n\r\nAs for wallet load code it's true it is only called in one place. Probably it is missing some test coverage. I would like to move more wallet loading code from `wallet.cpp` to `load.cpp` and I think improve way it handles race conditions and handles errors as discussed in #19300. But whatever improvements can be made to `wallet/load.cpp` I think it does make sense for it to exist as a separate file.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/857836270/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/858053384",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19101#issuecomment-858053384",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19101",
    "id": 858053384,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg1ODA1MzM4NA==",
    "user": {
      "login": "kiminuo",
      "id": 58662979,
      "node_id": "MDQ6VXNlcjU4NjYyOTc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58662979?u=b48a1208deda9bd1756f21a35341ce98265355c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kiminuo",
      "html_url": "https://github.com/kiminuo",
      "followers_url": "https://api.github.com/users/kiminuo/followers",
      "following_url": "https://api.github.com/users/kiminuo/following{/other_user}",
      "gists_url": "https://api.github.com/users/kiminuo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kiminuo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
      "organizations_url": "https://api.github.com/users/kiminuo/orgs",
      "repos_url": "https://api.github.com/users/kiminuo/repos",
      "events_url": "https://api.github.com/users/kiminuo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kiminuo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-09T20:01:15Z",
    "updated_at": "2021-06-09T20:01:15Z",
    "author_association": "CONTRIBUTOR",
    "body": "> I think ideally internal wallet would remain more modular (database code separate from key management code separate from syncing code separate from balance tracking code), and not reference these interfaces which tie everything together.\r\n\r\nI certainly do not suggest to make code worse from modularity point of view. I wrote my comment to understand better how/why you implemented this PR as you did. Thank you for the explanation. Also I did not write the comment to suggest any modifications to this PR but to understand what would happen if instead of `function(context, parameters)` (e.g. `AddWallet(context, wallet);`) one would have `object.function(parameters)` with no context whatsoever. And again it's just a question. Your approach is certainly straightforward.\r\n\r\nI spent several hours trying to get familiar with various wallet classes and it still feels like I only scratched the surface, so that's why your insights here may be very valuable to other reviewers as well.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/858053384/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/858147400",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19101#issuecomment-858147400",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19101",
    "id": 858147400,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg1ODE0NzQwMA==",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-09T22:39:33Z",
    "updated_at": "2021-06-09T22:39:33Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thanks for asking these questions! I'm very happy to answer them, and I hope I didn't give the impression that I was disagreeing with anything. I was trying to answer \"Is it necessary to have the context struct?\" and say I don't think it's necessary, but I do think it's good because I think it's more lightweight than `WalletClient` and shouldn't get in the way of modularity.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/858147400/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/898513745",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19101#issuecomment-898513745",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19101",
    "id": 898513745,
    "node_id": "IC_kwDOABII5841jjtR",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-13T14:54:18Z",
    "updated_at": "2021-08-13T14:54:18Z",
    "author_association": "CONTRIBUTOR",
    "body": "Base PR bitcoin-core/gui#360 is now merged so this PR doesn't have any dependencies\r\n\r\n---\r\n\r\nRebased df609b1a44bad295f44bdbda3fa32a49fd745233 -> 6e6a7e1fe874f0d93de7254d0884a1b9a95f6b19 ([`pr/novp.27`](https://github.com/ryanofsky/bitcoin/commits/pr/novp.27) -> [`pr/novp.28`](https://github.com/ryanofsky/bitcoin/commits/pr/novp.28), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/novp.27-rebase..pr/novp.28)) after base PR bitcoin-core/gui#360 merged, also fixing conflict with #22359",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/898513745/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/900672885",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19101#issuecomment-900672885",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19101",
    "id": 900672885,
    "node_id": "IC_kwDOABII5841ry11",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-17T22:28:13Z",
    "updated_at": "2021-08-17T22:28:13Z",
    "author_association": "CONTRIBUTOR",
    "body": "Rebased 6e6a7e1fe874f0d93de7254d0884a1b9a95f6b19 -> 62a09a30772141ef4add2f10d29927211abf57eb ([`pr/novp.28`](https://github.com/ryanofsky/bitcoin/commits/pr/novp.28) -> [`pr/novp.29`](https://github.com/ryanofsky/bitcoin/commits/pr/novp.29), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/novp.28-rebase..pr/novp.29)) due to conflict with #22541",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/900672885/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/901533525",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19101#issuecomment-901533525",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19101",
    "id": 901533525,
    "node_id": "IC_kwDOABII5841vE9V",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?u=9791e96cd4268d48e3517bac41eaf2b1d09759fd&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-19T01:13:29Z",
    "updated_at": "2021-08-19T01:13:29Z",
    "author_association": "MEMBER",
    "body": "ACK 62a09a30772141ef4add2f10d29927211abf57eb",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/901533525/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 1,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/901544183",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19101#issuecomment-901544183",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19101",
    "id": 901544183,
    "node_id": "IC_kwDOABII5841vHj3",
    "user": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?u=a0e0040aacd7d4f0787481e8ac30b494fa429e11&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following{/other_user}",
      "gists_url": "https://api.github.com/users/fanquake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-19T01:45:34Z",
    "updated_at": "2021-08-19T01:45:34Z",
    "author_association": "MEMBER",
    "body": "@kiminuo maybe you'll want to follow up here given some of the comments up thread?",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/901544183/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/901674084",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19101#issuecomment-901674084",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19101",
    "id": 901674084,
    "node_id": "IC_kwDOABII5841vnRk",
    "user": {
      "login": "kiminuo",
      "id": 58662979,
      "node_id": "MDQ6VXNlcjU4NjYyOTc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58662979?u=b48a1208deda9bd1756f21a35341ce98265355c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kiminuo",
      "html_url": "https://github.com/kiminuo",
      "followers_url": "https://api.github.com/users/kiminuo/followers",
      "following_url": "https://api.github.com/users/kiminuo/following{/other_user}",
      "gists_url": "https://api.github.com/users/kiminuo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kiminuo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
      "organizations_url": "https://api.github.com/users/kiminuo/orgs",
      "repos_url": "https://api.github.com/users/kiminuo/repos",
      "events_url": "https://api.github.com/users/kiminuo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kiminuo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-19T07:22:51Z",
    "updated_at": "2021-08-19T07:22:51Z",
    "author_association": "CONTRIBUTOR",
    "body": "> @kiminuo maybe you'll want to follow up here given some of the comments up thread?\r\n\r\nYes, will do. Thanks for the notification.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/901674084/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/646927022",
    "pull_request_review_id": 677868877,
    "id": 646927022,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0NjkyNzAyMg==",
    "diff_hunk": "@@ -352,6 +352,17 @@ void BitcoinApplication::requestShutdown()\n     window->setClientModel(nullptr);\n     pollShutdownTimer->stop();\n \n+#ifdef ENABLE_WALLET\n+    // Delete wallet controller here manually, instead of relying on Qt\n+    // reference counting. This makes sure walletmodel m_handle_* notification",
    "path": "src/qt/bitcoin.cpp",
    "position": null,
    "original_position": 6,
    "commit_id": "62a09a30772141ef4add2f10d29927211abf57eb",
    "original_commit_id": "fe45c379898e1a418af3847974a55f936814ca2a",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "fe45c379898e1a418af3847974a55f936814ca2a\r\n\r\n> instead of relying on Qt reference counting.\r\n\r\nWhat Qt reference counting?",
    "created_at": "2021-06-07T20:43:51Z",
    "updated_at": "2021-06-07T21:24:50Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19101#discussion_r646927022",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19101",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/646927022"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/19101#discussion_r646927022"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19101"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/646927022/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 357,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/646927491",
    "pull_request_review_id": 677868877,
    "id": 646927491,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0NjkyNzQ5MQ==",
    "diff_hunk": "@@ -352,6 +352,17 @@ void BitcoinApplication::requestShutdown()\n     window->setClientModel(nullptr);\n     pollShutdownTimer->stop();\n \n+#ifdef ENABLE_WALLET\n+    // Delete wallet controller here manually, instead of relying on Qt\n+    // reference counting. This makes sure walletmodel m_handle_* notification\n+    // handlers are deleted before wallets are unloaded, which can simplify\n+    // wallet implementations. It also avoids these notifications having to be\n+    // handled while GUI objects are being destroyed, making GUI code less\n+    // fragile as well.\n+    delete m_wallet_controller;",
    "path": "src/qt/bitcoin.cpp",
    "position": null,
    "original_position": 11,
    "commit_id": "62a09a30772141ef4add2f10d29927211abf57eb",
    "original_commit_id": "fe45c379898e1a418af3847974a55f936814ca2a",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "fe45c379898e1a418af3847974a55f936814ca2a\r\n\r\nJust noting that its not necessary to check for `WalletModel::isWalletEnabled())`, `delete nullptr` is safe.",
    "created_at": "2021-06-07T20:44:38Z",
    "updated_at": "2021-06-07T21:24:50Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19101#discussion_r646927491",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19101",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/646927491"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/19101#discussion_r646927491"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19101"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/646927491/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 353,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/646946660",
    "pull_request_review_id": 677868877,
    "id": 646946660,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0Njk0NjY2MA==",
    "diff_hunk": "@@ -23,6 +34,9 @@ class Chain;\n struct WalletContext {\n     interfaces::Chain* chain{nullptr};\n     ArgsManager* args{nullptr};\n+    RecursiveMutex wallets_mutex;",
    "path": "src/wallet/context.h",
    "position": null,
    "original_position": 27,
    "commit_id": "62a09a30772141ef4add2f10d29927211abf57eb",
    "original_commit_id": "4be544c7ec08a81952fd3f4349151cbb8bdb60e8",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "4be544c7ec08a81952fd3f4349151cbb8bdb60e8\r\n\r\nIt seems this can be a `Mutex`, just a suggestion for follow-up.",
    "created_at": "2021-06-07T21:17:26Z",
    "updated_at": "2021-06-07T21:24:50Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19101#discussion_r646946660",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19101",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/646946660"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/19101#discussion_r646946660"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19101"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/646946660/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 37,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/646969689",
    "pull_request_review_id": 677923525,
    "id": 646969689,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0Njk2OTY4OQ==",
    "diff_hunk": "@@ -352,6 +352,17 @@ void BitcoinApplication::requestShutdown()\n     window->setClientModel(nullptr);\n     pollShutdownTimer->stop();\n \n+#ifdef ENABLE_WALLET\n+    // Delete wallet controller here manually, instead of relying on Qt\n+    // reference counting. This makes sure walletmodel m_handle_* notification",
    "path": "src/qt/bitcoin.cpp",
    "position": null,
    "original_position": 6,
    "commit_id": "62a09a30772141ef4add2f10d29927211abf57eb",
    "original_commit_id": "fe45c379898e1a418af3847974a55f936814ca2a",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "re: https://github.com/bitcoin/bitcoin/pull/19101#discussion_r646927022\r\n\r\n> [fe45c37](https://github.com/bitcoin/bitcoin/commit/fe45c379898e1a418af3847974a55f936814ca2a)\r\n> \r\n> > instead of relying on Qt reference counting.\r\n> \r\n> What Qt reference counting?\r\n\r\nThanks, changed \"reference counting\" to \"object tracking\" and linked to https://doc.qt.io/qt-5/objecttrees.html",
    "created_at": "2021-06-07T22:00:06Z",
    "updated_at": "2021-06-07T22:34:37Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19101#discussion_r646969689",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19101",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/646969689"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/19101#discussion_r646969689"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19101"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/646969689/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 357,
    "side": "RIGHT",
    "in_reply_to_id": 646927022
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/646977950",
    "pull_request_review_id": 677923525,
    "id": 646977950,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0Njk3Nzk1MA==",
    "diff_hunk": "@@ -23,6 +34,9 @@ class Chain;\n struct WalletContext {\n     interfaces::Chain* chain{nullptr};\n     ArgsManager* args{nullptr};\n+    RecursiveMutex wallets_mutex;",
    "path": "src/wallet/context.h",
    "position": null,
    "original_position": 27,
    "commit_id": "62a09a30772141ef4add2f10d29927211abf57eb",
    "original_commit_id": "4be544c7ec08a81952fd3f4349151cbb8bdb60e8",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "re: https://github.com/bitcoin/bitcoin/pull/19101#discussion_r646946660\r\n\r\n> [4be544c](https://github.com/bitcoin/bitcoin/commit/4be544c7ec08a81952fd3f4349151cbb8bdb60e8)\r\n> \r\n> It seems this can be a `Mutex`, just a suggestion for follow-up.\r\n\r\nThanks went ahead and made the change here. It's not an immediately obvious change because the mutex is held while calling wallet_load_fns callbacks, but looking at the callbacks registered in GUI code it seems like these will never change the list of wallets so it seems good change to get rid of the recursive mutex now to prevent more complexity in the future",
    "created_at": "2021-06-07T22:18:33Z",
    "updated_at": "2021-06-07T22:34:37Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19101#discussion_r646977950",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19101",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/646977950"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/19101#discussion_r646977950"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19101"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/646977950/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 37,
    "side": "RIGHT",
    "in_reply_to_id": 646946660
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/646986103",
    "pull_request_review_id": 677942776,
    "id": 646986103,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0Njk4NjEwMw==",
    "diff_hunk": "@@ -23,6 +34,9 @@ class Chain;\n struct WalletContext {\n     interfaces::Chain* chain{nullptr};\n     ArgsManager* args{nullptr};\n+    RecursiveMutex wallets_mutex;",
    "path": "src/wallet/context.h",
    "position": null,
    "original_position": 27,
    "commit_id": "62a09a30772141ef4add2f10d29927211abf57eb",
    "original_commit_id": "4be544c7ec08a81952fd3f4349151cbb8bdb60e8",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I also tested `Mutex` and built it with TSAN, LGTM",
    "created_at": "2021-06-07T22:37:23Z",
    "updated_at": "2021-06-07T22:37:42Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19101#discussion_r646986103",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19101",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/646986103"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/19101#discussion_r646986103"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19101"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/646986103/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 37,
    "side": "RIGHT",
    "in_reply_to_id": 646946660
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/649488690",
    "pull_request_review_id": 681205186,
    "id": 649488690,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0OTQ4ODY5MA==",
    "diff_hunk": "@@ -109,9 +109,10 @@ void TestAddAddressesToSendBook(interfaces::Node& node)\n     std::unique_ptr<const PlatformStyle> platformStyle(PlatformStyle::instantiate(\"other\"));\n     OptionsModel optionsModel;\n     ClientModel clientModel(node, &optionsModel);\n-    AddWallet(wallet);\n-    WalletModel walletModel(interfaces::MakeWallet(wallet), clientModel, platformStyle.get());\n-    RemoveWallet(wallet, std::nullopt);\n+    WalletContext& context = *node.walletClient().context();\n+    AddWallet(context, wallet);\n+    WalletModel walletModel(interfaces::MakeWallet(context, wallet), clientModel, platformStyle.get());\n+    RemoveWallet(context, wallet, std::nullopt);",
    "path": "src/qt/test/addressbooktests.cpp",
    "position": null,
    "original_position": 10,
    "commit_id": "62a09a30772141ef4add2f10d29927211abf57eb",
    "original_commit_id": "eb389b377d8e17cc146a5e71d83358d88c762297",
    "user": {
      "login": "kiminuo",
      "id": 58662979,
      "node_id": "MDQ6VXNlcjU4NjYyOTc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kiminuo",
      "html_url": "https://github.com/kiminuo",
      "followers_url": "https://api.github.com/users/kiminuo/followers",
      "following_url": "https://api.github.com/users/kiminuo/following{/other_user}",
      "gists_url": "https://api.github.com/users/kiminuo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kiminuo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
      "organizations_url": "https://api.github.com/users/kiminuo/orgs",
      "repos_url": "https://api.github.com/users/kiminuo/repos",
      "events_url": "https://api.github.com/users/kiminuo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kiminuo/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit: If this needs to be touched, may be useful for consistency:\r\n\r\n```suggestion\r\n    RemoveWallet(context, wallet, std::nullopt /* load_on_start */);\r\n```\r\n\r\n(It is on more places but I don't want to spam.)",
    "created_at": "2021-06-10T20:00:46Z",
    "updated_at": "2021-06-10T21:14:31Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19101#discussion_r649488690",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19101",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/649488690"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/19101#discussion_r649488690"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19101"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/649488690/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 115,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/649501575",
    "pull_request_review_id": 681205186,
    "id": 649501575,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0OTUwMTU3NQ==",
    "diff_hunk": "@@ -164,9 +164,10 @@ void TestGUI(interfaces::Node& node)\n     TransactionView transactionView(platformStyle.get());\n     OptionsModel optionsModel;\n     ClientModel clientModel(node, &optionsModel);\n-    AddWallet(wallet);\n-    WalletModel walletModel(interfaces::MakeWallet(wallet), clientModel, platformStyle.get());\n-    RemoveWallet(wallet, std::nullopt);\n+    WalletContext& context = *node.walletClient().context();\n+    AddWallet(context, wallet);\n+    WalletModel walletModel(interfaces::MakeWallet(context, wallet), clientModel, platformStyle.get());\n+    RemoveWallet(context, wallet, std::nullopt);",
    "path": "src/qt/test/wallettests.cpp",
    "position": null,
    "original_position": 10,
    "commit_id": "62a09a30772141ef4add2f10d29927211abf57eb",
    "original_commit_id": "eb389b377d8e17cc146a5e71d83358d88c762297",
    "user": {
      "login": "kiminuo",
      "id": 58662979,
      "node_id": "MDQ6VXNlcjU4NjYyOTc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kiminuo",
      "html_url": "https://github.com/kiminuo",
      "followers_url": "https://api.github.com/users/kiminuo/followers",
      "following_url": "https://api.github.com/users/kiminuo/following{/other_user}",
      "gists_url": "https://api.github.com/users/kiminuo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kiminuo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
      "organizations_url": "https://api.github.com/users/kiminuo/orgs",
      "repos_url": "https://api.github.com/users/kiminuo/repos",
      "events_url": "https://api.github.com/users/kiminuo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kiminuo/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "(This snippet is exactly the same as in `src/qt/test/addressbooktests.cpp` but I must say I rather double checked with my editor's text search.)",
    "created_at": "2021-06-10T20:22:52Z",
    "updated_at": "2021-06-10T21:14:31Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19101#discussion_r649501575",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19101",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/649501575"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/19101#discussion_r649501575"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19101"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/649501575/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 167,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 170,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/649524997",
    "pull_request_review_id": 681205186,
    "id": 649524997,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0OTUyNDk5Nw==",
    "diff_hunk": "@@ -552,15 +553,16 @@ class WalletClientImpl : public WalletClient\n     std::vector<std::unique_ptr<Wallet>> getWallets() override\n     {\n         std::vector<std::unique_ptr<Wallet>> wallets;\n-        for (const auto& wallet : GetWallets()) {\n-            wallets.emplace_back(MakeWallet(wallet));\n+        for (const auto& wallet : GetWallets(m_context)) {\n+            wallets.emplace_back(MakeWallet(m_context, wallet));\n         }\n         return wallets;\n     }\n     std::unique_ptr<Handler> handleLoadWallet(LoadWalletFn fn) override\n     {\n-        return HandleLoadWallet(std::move(fn));\n+        return HandleLoadWallet(m_context, std::move(fn));\n     }\n+    WalletContext* context() override  { return &m_context; }",
    "path": "src/wallet/interfaces.cpp",
    "position": 85,
    "original_position": 85,
    "commit_id": "62a09a30772141ef4add2f10d29927211abf57eb",
    "original_commit_id": "eb389b377d8e17cc146a5e71d83358d88c762297",
    "user": {
      "login": "kiminuo",
      "id": 58662979,
      "node_id": "MDQ6VXNlcjU4NjYyOTc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kiminuo",
      "html_url": "https://github.com/kiminuo",
      "followers_url": "https://api.github.com/users/kiminuo/followers",
      "following_url": "https://api.github.com/users/kiminuo/following{/other_user}",
      "gists_url": "https://api.github.com/users/kiminuo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kiminuo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
      "organizations_url": "https://api.github.com/users/kiminuo/orgs",
      "repos_url": "https://api.github.com/users/kiminuo/repos",
      "events_url": "https://api.github.com/users/kiminuo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kiminuo/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Would it be possible to pass `WalletContext` via constructor to `WalletClientImpl`? It seems that in that case, this function may not be necessary and a test can still create `WalletClientImpl`.\r\n\r\n",
    "created_at": "2021-06-10T20:53:44Z",
    "updated_at": "2021-06-10T21:14:31Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19101#discussion_r649524997",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19101",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/649524997"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/19101#discussion_r649524997"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19101"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/649524997/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 572,
    "original_line": 572,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/649537068",
    "pull_request_review_id": 681205186,
    "id": 649537068,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0OTUzNzA2OA==",
    "diff_hunk": "@@ -23,6 +34,9 @@ class Chain;\n struct WalletContext {\n     interfaces::Chain* chain{nullptr};\n     ArgsManager* args{nullptr};\n+    Mutex wallets_mutex;",
    "path": "src/wallet/context.h",
    "position": 29,
    "original_position": 27,
    "commit_id": "62a09a30772141ef4add2f10d29927211abf57eb",
    "original_commit_id": "eb389b377d8e17cc146a5e71d83358d88c762297",
    "user": {
      "login": "kiminuo",
      "id": 58662979,
      "node_id": "MDQ6VXNlcjU4NjYyOTc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kiminuo",
      "html_url": "https://github.com/kiminuo",
      "followers_url": "https://api.github.com/users/kiminuo/followers",
      "following_url": "https://api.github.com/users/kiminuo/following{/other_user}",
      "gists_url": "https://api.github.com/users/kiminuo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kiminuo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
      "organizations_url": "https://api.github.com/users/kiminuo/orgs",
      "repos_url": "https://api.github.com/users/kiminuo/repos",
      "events_url": "https://api.github.com/users/kiminuo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kiminuo/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "off topic: I noticed a very nice comment https://github.com/bitcoin/bitcoin/blob/1704bbf2263f16c720604cfab4ccb775315df690/src/node/context.h#L49 in `src/node/context.h`. Would it make sense to add the comment on L36, too?",
    "created_at": "2021-06-10T21:14:14Z",
    "updated_at": "2021-06-10T21:14:31Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19101#discussion_r649537068",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19101",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/649537068"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/19101#discussion_r649537068"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19101"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/649537068/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 37,
    "original_line": 37,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/649572794",
    "pull_request_review_id": 681310425,
    "id": 649572794,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0OTU3Mjc5NA==",
    "diff_hunk": "@@ -109,9 +109,10 @@ void TestAddAddressesToSendBook(interfaces::Node& node)\n     std::unique_ptr<const PlatformStyle> platformStyle(PlatformStyle::instantiate(\"other\"));\n     OptionsModel optionsModel;\n     ClientModel clientModel(node, &optionsModel);\n-    AddWallet(wallet);\n-    WalletModel walletModel(interfaces::MakeWallet(wallet), clientModel, platformStyle.get());\n-    RemoveWallet(wallet, std::nullopt);\n+    WalletContext& context = *node.walletClient().context();\n+    AddWallet(context, wallet);\n+    WalletModel walletModel(interfaces::MakeWallet(context, wallet), clientModel, platformStyle.get());\n+    RemoveWallet(context, wallet, std::nullopt);",
    "path": "src/qt/test/addressbooktests.cpp",
    "position": null,
    "original_position": 10,
    "commit_id": "62a09a30772141ef4add2f10d29927211abf57eb",
    "original_commit_id": "eb389b377d8e17cc146a5e71d83358d88c762297",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "re: https://github.com/bitcoin/bitcoin/pull/19101#discussion_r649488690\r\n\r\n> nit: If this needs to be touched, may be useful for consistency:\r\n> \r\n> (It is on more places but I don't want to spam.)\r\n\r\nThanks! Added change all places",
    "created_at": "2021-06-10T22:27:56Z",
    "updated_at": "2021-06-10T23:29:53Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19101#discussion_r649572794",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19101",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/649572794"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/19101#discussion_r649572794"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19101"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/649572794/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 115,
    "side": "RIGHT",
    "in_reply_to_id": 649488690
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/649575348",
    "pull_request_review_id": 681310425,
    "id": 649575348,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0OTU3NTM0OA==",
    "diff_hunk": "@@ -23,6 +34,9 @@ class Chain;\n struct WalletContext {\n     interfaces::Chain* chain{nullptr};\n     ArgsManager* args{nullptr};\n+    Mutex wallets_mutex;",
    "path": "src/wallet/context.h",
    "position": 29,
    "original_position": 27,
    "commit_id": "62a09a30772141ef4add2f10d29927211abf57eb",
    "original_commit_id": "eb389b377d8e17cc146a5e71d83358d88c762297",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "re: https://github.com/bitcoin/bitcoin/pull/19101#discussion_r649537068\r\n\r\n> off topic: I noticed a very nice comment\r\n> \r\n> https://github.com/bitcoin/bitcoin/blob/1704bbf2263f16c720604cfab4ccb775315df690/src/node/context.h#L49\r\n> in `src/node/context.h`. Would it make sense to add the comment on L36, too?\r\n\r\nSure, added this for consistency",
    "created_at": "2021-06-10T22:34:10Z",
    "updated_at": "2021-06-10T23:29:53Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19101#discussion_r649575348",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19101",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/649575348"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/19101#discussion_r649575348"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19101"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/649575348/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 37,
    "original_line": 37,
    "side": "RIGHT",
    "in_reply_to_id": 649537068
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/649579446",
    "pull_request_review_id": 681310425,
    "id": 649579446,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0OTU3OTQ0Ng==",
    "diff_hunk": "@@ -552,15 +553,16 @@ class WalletClientImpl : public WalletClient\n     std::vector<std::unique_ptr<Wallet>> getWallets() override\n     {\n         std::vector<std::unique_ptr<Wallet>> wallets;\n-        for (const auto& wallet : GetWallets()) {\n-            wallets.emplace_back(MakeWallet(wallet));\n+        for (const auto& wallet : GetWallets(m_context)) {\n+            wallets.emplace_back(MakeWallet(m_context, wallet));\n         }\n         return wallets;\n     }\n     std::unique_ptr<Handler> handleLoadWallet(LoadWalletFn fn) override\n     {\n-        return HandleLoadWallet(std::move(fn));\n+        return HandleLoadWallet(m_context, std::move(fn));\n     }\n+    WalletContext* context() override  { return &m_context; }",
    "path": "src/wallet/interfaces.cpp",
    "position": 85,
    "original_position": 85,
    "commit_id": "62a09a30772141ef4add2f10d29927211abf57eb",
    "original_commit_id": "eb389b377d8e17cc146a5e71d83358d88c762297",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "re: https://github.com/bitcoin/bitcoin/pull/19101#discussion_r649524997\r\n\r\n> Would it be possible to pass `WalletContext` via constructor to `WalletClientImpl`? It seems that in that case, this function may not be necessary and a test can still create `WalletClientImpl`.\r\n\r\nI think that could work but it seems a little better to me if instead of passing around `WalletClient` / `WalletContext` pairs, that if tests are already using `WalletClient` interfaces, they prefer using them, and only access the internal context as a fallback so they are less tied to implementation details. I think having a context method does a good job of encouraging using the external interface while making internal access still possible.",
    "created_at": "2021-06-10T22:45:03Z",
    "updated_at": "2021-06-10T23:29:53Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19101#discussion_r649579446",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19101",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/649579446"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/19101#discussion_r649579446"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19101"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/649579446/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 572,
    "original_line": 572,
    "side": "RIGHT",
    "in_reply_to_id": 649524997
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/649580437",
    "pull_request_review_id": 681310425,
    "id": 649580437,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0OTU4MDQzNw==",
    "diff_hunk": "@@ -164,9 +164,10 @@ void TestGUI(interfaces::Node& node)\n     TransactionView transactionView(platformStyle.get());\n     OptionsModel optionsModel;\n     ClientModel clientModel(node, &optionsModel);\n-    AddWallet(wallet);\n-    WalletModel walletModel(interfaces::MakeWallet(wallet), clientModel, platformStyle.get());\n-    RemoveWallet(wallet, std::nullopt);\n+    WalletContext& context = *node.walletClient().context();\n+    AddWallet(context, wallet);\n+    WalletModel walletModel(interfaces::MakeWallet(context, wallet), clientModel, platformStyle.get());\n+    RemoveWallet(context, wallet, std::nullopt);",
    "path": "src/qt/test/wallettests.cpp",
    "position": null,
    "original_position": 10,
    "commit_id": "62a09a30772141ef4add2f10d29927211abf57eb",
    "original_commit_id": "eb389b377d8e17cc146a5e71d83358d88c762297",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "re: https://github.com/bitcoin/bitcoin/pull/19101#discussion_r649501575\r\n\r\n> (This snippet is exactly the same as in `src/qt/test/addressbooktests.cpp` but I must say I rather double checked with my editor's text search.)\r\n\r\nDuplication is good to note, but it precedes this PR, and I think trying to simplify or dedup here would be more invasive and make more sense as a separate change. (This PR is just adding function parameters. Trying to replace the actual function calls would be a bigger change.)",
    "created_at": "2021-06-10T22:47:43Z",
    "updated_at": "2021-06-10T23:29:53Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19101#discussion_r649580437",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19101",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/649580437"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/19101#discussion_r649580437"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19101"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/649580437/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 167,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 170,
    "side": "RIGHT",
    "in_reply_to_id": 649501575
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/649734116",
    "pull_request_review_id": 681504390,
    "id": 649734116,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0OTczNDExNg==",
    "diff_hunk": "@@ -164,9 +164,10 @@ void TestGUI(interfaces::Node& node)\n     TransactionView transactionView(platformStyle.get());\n     OptionsModel optionsModel;\n     ClientModel clientModel(node, &optionsModel);\n-    AddWallet(wallet);\n-    WalletModel walletModel(interfaces::MakeWallet(wallet), clientModel, platformStyle.get());\n-    RemoveWallet(wallet, std::nullopt);\n+    WalletContext& context = *node.walletClient().context();\n+    AddWallet(context, wallet);\n+    WalletModel walletModel(interfaces::MakeWallet(context, wallet), clientModel, platformStyle.get());\n+    RemoveWallet(context, wallet, std::nullopt);",
    "path": "src/qt/test/wallettests.cpp",
    "position": null,
    "original_position": 10,
    "commit_id": "62a09a30772141ef4add2f10d29927211abf57eb",
    "original_commit_id": "eb389b377d8e17cc146a5e71d83358d88c762297",
    "user": {
      "login": "kiminuo",
      "id": 58662979,
      "node_id": "MDQ6VXNlcjU4NjYyOTc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kiminuo",
      "html_url": "https://github.com/kiminuo",
      "followers_url": "https://api.github.com/users/kiminuo/followers",
      "following_url": "https://api.github.com/users/kiminuo/following{/other_user}",
      "gists_url": "https://api.github.com/users/kiminuo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kiminuo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
      "organizations_url": "https://api.github.com/users/kiminuo/orgs",
      "repos_url": "https://api.github.com/users/kiminuo/repos",
      "events_url": "https://api.github.com/users/kiminuo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kiminuo/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Yes, that was just an observation. I agree that it is better to address that in another PR if at all.",
    "created_at": "2021-06-11T06:53:09Z",
    "updated_at": "2021-06-11T06:53:09Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19101#discussion_r649734116",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19101",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/649734116"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/19101#discussion_r649734116"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19101"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/649734116/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 167,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 170,
    "side": "RIGHT",
    "in_reply_to_id": 649501575
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/649734440",
    "pull_request_review_id": 681504799,
    "id": 649734440,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0OTczNDQ0MA==",
    "diff_hunk": "@@ -23,6 +34,9 @@ class Chain;\n struct WalletContext {\n     interfaces::Chain* chain{nullptr};\n     ArgsManager* args{nullptr};\n+    Mutex wallets_mutex;",
    "path": "src/wallet/context.h",
    "position": 29,
    "original_position": 27,
    "commit_id": "62a09a30772141ef4add2f10d29927211abf57eb",
    "original_commit_id": "eb389b377d8e17cc146a5e71d83358d88c762297",
    "user": {
      "login": "kiminuo",
      "id": 58662979,
      "node_id": "MDQ6VXNlcjU4NjYyOTc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kiminuo",
      "html_url": "https://github.com/kiminuo",
      "followers_url": "https://api.github.com/users/kiminuo/followers",
      "following_url": "https://api.github.com/users/kiminuo/following{/other_user}",
      "gists_url": "https://api.github.com/users/kiminuo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kiminuo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
      "organizations_url": "https://api.github.com/users/kiminuo/orgs",
      "repos_url": "https://api.github.com/users/kiminuo/repos",
      "events_url": "https://api.github.com/users/kiminuo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kiminuo/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Thanks!",
    "created_at": "2021-06-11T06:53:44Z",
    "updated_at": "2021-06-11T06:53:45Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19101#discussion_r649734440",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19101",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/649734440"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/19101#discussion_r649734440"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19101"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/649734440/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 37,
    "original_line": 37,
    "side": "RIGHT",
    "in_reply_to_id": 649537068
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/692098975",
    "pull_request_review_id": 733972131,
    "id": 692098975,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5MjA5ODk3NQ==",
    "diff_hunk": "@@ -121,41 +124,41 @@ bool LoadWallets(interfaces::Chain& chain)\n     }\n }\n \n-void StartWallets(CScheduler& scheduler, const ArgsManager& args)\n+void StartWallets(WalletContext& context, CScheduler& scheduler)\n {\n-    for (const std::shared_ptr<CWallet>& pwallet : GetWallets()) {\n+    for (const std::shared_ptr<CWallet>& pwallet : GetWallets(context)) {\n         pwallet->postInitProcess();\n     }\n \n     // Schedule periodic wallet flushes and tx rebroadcasts\n-    if (args.GetBoolArg(\"-flushwallet\", DEFAULT_FLUSHWALLET)) {\n-        scheduler.scheduleEvery(MaybeCompactWalletDB, std::chrono::milliseconds{500});\n+    if (context.args->GetBoolArg(\"-flushwallet\", DEFAULT_FLUSHWALLET)) {",
    "path": "src/wallet/load.cpp",
    "position": 59,
    "original_position": 59,
    "commit_id": "62a09a30772141ef4add2f10d29927211abf57eb",
    "original_commit_id": "62a09a30772141ef4add2f10d29927211abf57eb",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Previously this was an `Assert`, now it is UB. Obviously doesn't matter, but I wanted to point out the difference.",
    "created_at": "2021-08-19T13:15:07Z",
    "updated_at": "2021-08-19T13:15:07Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19101#discussion_r692098975",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19101",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/692098975"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/19101#discussion_r692098975"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19101"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/692098975/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 134,
    "original_line": 134,
    "side": "RIGHT"
  }
]