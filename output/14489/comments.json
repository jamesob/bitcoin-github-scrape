[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/430059469",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14489#issuecomment-430059469",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14489",
    "id": 430059469,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMDA1OTQ2OQ==",
    "user": {
      "login": "ken2812221",
      "id": 11154118,
      "node_id": "MDQ6VXNlcjExMTU0MTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/11154118?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ken2812221",
      "html_url": "https://github.com/ken2812221",
      "followers_url": "https://api.github.com/users/ken2812221/followers",
      "following_url": "https://api.github.com/users/ken2812221/following{/other_user}",
      "gists_url": "https://api.github.com/users/ken2812221/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ken2812221/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ken2812221/subscriptions",
      "organizations_url": "https://api.github.com/users/ken2812221/orgs",
      "repos_url": "https://api.github.com/users/ken2812221/repos",
      "events_url": "https://api.github.com/users/ken2812221/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ken2812221/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-10-16T00:28:25Z",
    "updated_at": "2018-10-16T00:28:25Z",
    "author_association": "CONTRIBUTOR",
    "body": "Apparently I wrote a MSVC-only code. I am going to investigate it. ",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/430059469/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/430077056",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14489#issuecomment-430077056",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14489",
    "id": 430077056,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMDA3NzA1Ng==",
    "user": {
      "login": "meshcollider",
      "id": 3211283,
      "node_id": "MDQ6VXNlcjMyMTEyODM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3211283?u=447cdc9e2966cbee415545c8ff452954ee1209af&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/meshcollider",
      "html_url": "https://github.com/meshcollider",
      "followers_url": "https://api.github.com/users/meshcollider/followers",
      "following_url": "https://api.github.com/users/meshcollider/following{/other_user}",
      "gists_url": "https://api.github.com/users/meshcollider/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/meshcollider/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/meshcollider/subscriptions",
      "organizations_url": "https://api.github.com/users/meshcollider/orgs",
      "repos_url": "https://api.github.com/users/meshcollider/repos",
      "events_url": "https://api.github.com/users/meshcollider/events{/privacy}",
      "received_events_url": "https://api.github.com/users/meshcollider/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-10-16T02:17:22Z",
    "updated_at": "2018-10-16T02:17:22Z",
    "author_association": "MEMBER",
    "body": "Related #8631",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/430077056/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/430308193",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14489#issuecomment-430308193",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14489",
    "id": 430308193,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMDMwODE5Mw==",
    "user": {
      "login": "ken2812221",
      "id": 11154118,
      "node_id": "MDQ6VXNlcjExMTU0MTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/11154118?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ken2812221",
      "html_url": "https://github.com/ken2812221",
      "followers_url": "https://api.github.com/users/ken2812221/followers",
      "following_url": "https://api.github.com/users/ken2812221/following{/other_user}",
      "gists_url": "https://api.github.com/users/ken2812221/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ken2812221/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ken2812221/subscriptions",
      "organizations_url": "https://api.github.com/users/ken2812221/orgs",
      "repos_url": "https://api.github.com/users/ken2812221/repos",
      "events_url": "https://api.github.com/users/ken2812221/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ken2812221/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-10-16T16:37:44Z",
    "updated_at": "2018-10-16T16:37:44Z",
    "author_association": "CONTRIBUTOR",
    "body": "This is ready for review",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/430308193/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/430665327",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14489#issuecomment-430665327",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14489",
    "id": 430665327,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMDY2NTMyNw==",
    "user": {
      "login": "ken2812221",
      "id": 11154118,
      "node_id": "MDQ6VXNlcjExMTU0MTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/11154118?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ken2812221",
      "html_url": "https://github.com/ken2812221",
      "followers_url": "https://api.github.com/users/ken2812221/followers",
      "following_url": "https://api.github.com/users/ken2812221/following{/other_user}",
      "gists_url": "https://api.github.com/users/ken2812221/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ken2812221/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ken2812221/subscriptions",
      "organizations_url": "https://api.github.com/users/ken2812221/orgs",
      "repos_url": "https://api.github.com/users/ken2812221/repos",
      "events_url": "https://api.github.com/users/ken2812221/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ken2812221/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-10-17T15:03:42Z",
    "updated_at": "2018-10-18T00:19:49Z",
    "author_association": "CONTRIBUTOR",
    "body": "@donaloconnor It should use mutex because it's used by the condition_variable.\r\n\r\nFor reference, you can find boost implementation for [pthread](https://github.com/boostorg/thread/blob/develop/src/pthread/thread.cpp), it acquires lock before it reads `interrupt_requested`.\r\n\r\nIf it can drop InterruptibleSleep in the future, then it's fine to switch to atomic.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/430665327/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/430910162",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14489#issuecomment-430910162",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14489",
    "id": 430910162,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMDkxMDE2Mg==",
    "user": {
      "login": "donaloconnor",
      "id": 6394033,
      "node_id": "MDQ6VXNlcjYzOTQwMzM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6394033?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/donaloconnor",
      "html_url": "https://github.com/donaloconnor",
      "followers_url": "https://api.github.com/users/donaloconnor/followers",
      "following_url": "https://api.github.com/users/donaloconnor/following{/other_user}",
      "gists_url": "https://api.github.com/users/donaloconnor/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/donaloconnor/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/donaloconnor/subscriptions",
      "organizations_url": "https://api.github.com/users/donaloconnor/orgs",
      "repos_url": "https://api.github.com/users/donaloconnor/repos",
      "events_url": "https://api.github.com/users/donaloconnor/events{/privacy}",
      "received_events_url": "https://api.github.com/users/donaloconnor/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-10-18T07:50:11Z",
    "updated_at": "2018-10-18T07:50:11Z",
    "author_association": "CONTRIBUTOR",
    "body": "@ken2812221 ah yes for the sleep. Thanks for the link to boosts impl.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/430910162/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/430975441",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14489#issuecomment-430975441",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14489",
    "id": 430975441,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMDk3NTQ0MQ==",
    "user": {
      "login": "ken2812221",
      "id": 11154118,
      "node_id": "MDQ6VXNlcjExMTU0MTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/11154118?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ken2812221",
      "html_url": "https://github.com/ken2812221",
      "followers_url": "https://api.github.com/users/ken2812221/followers",
      "following_url": "https://api.github.com/users/ken2812221/following{/other_user}",
      "gists_url": "https://api.github.com/users/ken2812221/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ken2812221/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ken2812221/subscriptions",
      "organizations_url": "https://api.github.com/users/ken2812221/orgs",
      "repos_url": "https://api.github.com/users/ken2812221/repos",
      "events_url": "https://api.github.com/users/ken2812221/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ken2812221/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-10-18T11:36:56Z",
    "updated_at": "2018-10-18T11:36:56Z",
    "author_association": "CONTRIBUTOR",
    "body": "Actually, I think it's fine to make it use both atomic and mutex at the same time. Then we don't have to lock mutex in InterruptionPoint.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/430975441/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/430979343",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14489#issuecomment-430979343",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14489",
    "id": 430979343,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMDk3OTM0Mw==",
    "user": {
      "login": "donaloconnor",
      "id": 6394033,
      "node_id": "MDQ6VXNlcjYzOTQwMzM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6394033?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/donaloconnor",
      "html_url": "https://github.com/donaloconnor",
      "followers_url": "https://api.github.com/users/donaloconnor/followers",
      "following_url": "https://api.github.com/users/donaloconnor/following{/other_user}",
      "gists_url": "https://api.github.com/users/donaloconnor/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/donaloconnor/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/donaloconnor/subscriptions",
      "organizations_url": "https://api.github.com/users/donaloconnor/orgs",
      "repos_url": "https://api.github.com/users/donaloconnor/repos",
      "events_url": "https://api.github.com/users/donaloconnor/events{/privacy}",
      "received_events_url": "https://api.github.com/users/donaloconnor/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-10-18T11:52:18Z",
    "updated_at": "2018-10-18T11:52:18Z",
    "author_association": "CONTRIBUTOR",
    "body": "In this case it might work but in practice it can cause race conditions. The value of the atomic can change from the moment the cond var is signalled and the predicate is checked (to work with spurious wakeups). Eg: false->true->notify+wakeup->false->predcheck.\r\n\r\nThe last false flag can never happen here (at least my understanding of the code) I guess so maybe it's okay.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/430979343/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/431087509",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14489#issuecomment-431087509",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14489",
    "id": 431087509,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMTA4NzUwOQ==",
    "user": {
      "login": "ken2812221",
      "id": 11154118,
      "node_id": "MDQ6VXNlcjExMTU0MTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/11154118?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ken2812221",
      "html_url": "https://github.com/ken2812221",
      "followers_url": "https://api.github.com/users/ken2812221/followers",
      "following_url": "https://api.github.com/users/ken2812221/following{/other_user}",
      "gists_url": "https://api.github.com/users/ken2812221/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ken2812221/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ken2812221/subscriptions",
      "organizations_url": "https://api.github.com/users/ken2812221/orgs",
      "repos_url": "https://api.github.com/users/ken2812221/repos",
      "events_url": "https://api.github.com/users/ken2812221/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ken2812221/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-10-18T17:05:45Z",
    "updated_at": "2018-10-18T17:05:45Z",
    "author_association": "CONTRIBUTOR",
    "body": "@donaloconnor I am not sure people would allow this solution. Now the flag contains two variable:\r\n- atomic bool read in `InterruptionPoint`\r\n- non-atomic bool read in `InterruptionSleep`",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/431087509/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/431183069",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14489#issuecomment-431183069",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14489",
    "id": 431183069,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMTE4MzA2OQ==",
    "user": {
      "login": "donaloconnor",
      "id": 6394033,
      "node_id": "MDQ6VXNlcjYzOTQwMzM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6394033?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/donaloconnor",
      "html_url": "https://github.com/donaloconnor",
      "followers_url": "https://api.github.com/users/donaloconnor/followers",
      "following_url": "https://api.github.com/users/donaloconnor/following{/other_user}",
      "gists_url": "https://api.github.com/users/donaloconnor/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/donaloconnor/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/donaloconnor/subscriptions",
      "organizations_url": "https://api.github.com/users/donaloconnor/orgs",
      "repos_url": "https://api.github.com/users/donaloconnor/repos",
      "events_url": "https://api.github.com/users/donaloconnor/events{/privacy}",
      "received_events_url": "https://api.github.com/users/donaloconnor/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-10-18T22:18:01Z",
    "updated_at": "2018-10-18T22:18:41Z",
    "author_association": "CONTRIBUTOR",
    "body": "I think it's not worth the complexity tbh. Sorry. I don't know if the perf improvement is worth the extra complexity without measurements. Maybe we should just stick to what boost did as you had in original. I think using the atomic in the cond var is okay for this case because it's state only goes from false->true.\r\n\r\nI'd prefer if others chimed in to give feedback on this..\r\n\r\nRe: spurious wakeups in the sleep. Do you think that's an issue? The sleep could get ended prematurely. Probably not a big deal. I don't know how much the code relies on accurate sleeps. ",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/431183069/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/431189440",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14489#issuecomment-431189440",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14489",
    "id": 431189440,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMTE4OTQ0MA==",
    "user": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?u=5ff13e375b40ea55ecd3c108337dd6a23f68eddf&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-10-18T22:47:57Z",
    "updated_at": "2018-10-18T22:47:57Z",
    "author_association": "CONTRIBUTOR",
    "body": "What about splitting the work in two parts?\r\n\r\nStart with the low-risk Boost replacement: that change is likely worth it in itself as long as no deviations from what Boost was doing are introduced.\r\n\r\nWhen that work is finished: continue with the risker performance improvement change you are considering.\r\n\r\nDoes that make sense?",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/431189440/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/431566556",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14489#issuecomment-431566556",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14489",
    "id": 431566556,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMTU2NjU1Ng==",
    "user": {
      "login": "DrahtBot",
      "id": 39886733,
      "node_id": "MDQ6VXNlcjM5ODg2NzMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/39886733?u=3c1e73d828cf5a5850dfc25c8397c1cf751db5ac&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DrahtBot",
      "html_url": "https://github.com/DrahtBot",
      "followers_url": "https://api.github.com/users/DrahtBot/followers",
      "following_url": "https://api.github.com/users/DrahtBot/following{/other_user}",
      "gists_url": "https://api.github.com/users/DrahtBot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
      "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
      "repos_url": "https://api.github.com/users/DrahtBot/repos",
      "events_url": "https://api.github.com/users/DrahtBot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-10-20T09:55:41Z",
    "updated_at": "2018-11-02T16:42:06Z",
    "author_association": "CONTRIBUTOR",
    "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#14624](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/14624.html) (Some simple improvements to the RNG code by sipa)\n* [#14605](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/14605.html) (Return of the Banman by dongcarl)\n* [#14252](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/14252.html) (build: Run functional tests and benchmarks under the undefined behaviour sanitizer (UBSan) by practicalswift)\n* [#13910](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/13910.html) (Trivial: Log progress while verifying blocks at level 4 by domob1812)\n* [#13743](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/13743.html) (refactor: Replace boost::bind with std::bind by ken2812221)\n* [#13389](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/13389.html) (Utils and libraries: Fix #13371 - move umask operation earlier in AppInit() by n2yen)\n* [#13382](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/13382.html) (util: Don't throw in GetTime{Millis,Micros}(). Mark as noexcept. by practicalswift)\n* [#12980](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/12980.html) (Allow quicker shutdowns during LoadBlockIndex() by jonasschnelli)\n* [#12557](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/12557.html) ([WIP] 64 bit iOs device support by Sjors)\n* [#10102](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/10102.html) ([experimental] Multiprocess bitcoin by ryanofsky)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/431566556/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/435839504",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14489#issuecomment-435839504",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14489",
    "id": 435839504,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzNTgzOTUwNA==",
    "user": {
      "login": "DrahtBot",
      "id": 39886733,
      "node_id": "MDQ6VXNlcjM5ODg2NzMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/39886733?u=3c1e73d828cf5a5850dfc25c8397c1cf751db5ac&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DrahtBot",
      "html_url": "https://github.com/DrahtBot",
      "followers_url": "https://api.github.com/users/DrahtBot/followers",
      "following_url": "https://api.github.com/users/DrahtBot/following{/other_user}",
      "gists_url": "https://api.github.com/users/DrahtBot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
      "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
      "repos_url": "https://api.github.com/users/DrahtBot/repos",
      "events_url": "https://api.github.com/users/DrahtBot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-11-05T11:16:47Z",
    "updated_at": "2018-11-05T11:16:47Z",
    "author_association": "CONTRIBUTOR",
    "body": "<!--cf906140f33d8803c4a75a2196329ecb-->Needs rebase",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/435839504/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/595963817",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14489#issuecomment-595963817",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14489",
    "id": 595963817,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU5NTk2MzgxNw==",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?u=0691974eedcc2ab5366cc1080fb1c030e87244c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-03-06T21:01:59Z",
    "updated_at": "2020-03-06T21:01:59Z",
    "author_association": "MEMBER",
    "body": "fyi, Boost::Chrono has been removed",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/595963817/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225859931",
    "pull_request_review_id": 165548645,
    "id": 225859931,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNTg1OTkzMQ==",
    "diff_hunk": "@@ -43,3 +43,30 @@ bool CThreadInterrupt::sleep_for(std::chrono::minutes rel_time)\n {\n     return sleep_for(std::chrono::duration_cast<std::chrono::milliseconds>(rel_time));\n }\n+\n+thread_local InterruptFlag* g_interrupt_flag;\n+\n+void InterruptibleThread::interrupt()\n+{\n+    {\n+        std::lock_guard<std::mutex> lock(m_interrupt_flag->m_mutex);\n+        m_interrupt_flag->m_interrupted = true;\n+    }\n+    m_interrupt_flag->m_cond.notify_one();\n+}\n+\n+void InterruptibleThread::join()\n+{\n+    m_internal.join();\n+}\n+\n+void InterruptionPoint()\n+{\n+    if (!g_interrupt_flag) { // Not interruptible thread\n+        return;\n+    }\n+    std::lock_guard<std::mutex> lock(g_interrupt_flag->m_mutex);\n+    if (g_interrupt_flag->m_interrupted) {\n+        throw ThreadInterrupted();\n+    }\n+}",
    "path": "src/threadinterrupt.cpp",
    "position": null,
    "original_position": 30,
    "commit_id": "692dee0963e06948e7e71acc597d04f71cd5b47f",
    "original_commit_id": "95fd49ae4c6b0cd45ae8a827e074af20ed75fbdf",
    "user": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Missing newline at end of file :-)",
    "created_at": "2018-10-17T10:01:58Z",
    "updated_at": "2018-11-02T15:28:04Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14489#discussion_r225859931",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14489",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225859931"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14489#discussion_r225859931"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14489"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225859931/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 72,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225867106",
    "pull_request_review_id": 165557549,
    "id": 225867106,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNTg2NzEwNg==",
    "diff_hunk": "@@ -34,4 +36,59 @@ class CThreadInterrupt\n     std::atomic<bool> flag;\n };\n \n+struct InterruptFlag {\n+    std::mutex m_mutex;\n+    std::condition_variable m_cond;\n+    bool m_interrupted = false; // GUARDED_BY(m_mutex)\n+};\n+\n+extern thread_local InterruptFlag* g_interrupt_flag;\n+\n+class InterruptibleThread\n+{\n+public:\n+    template<typename Function, typename ... Args>\n+    InterruptibleThread(Function&& func, Args&& ...args) {\n+        InterruptFlag* flag_ptr = new InterruptFlag();\n+        m_interrupt_flag = std::unique_ptr<InterruptFlag>(flag_ptr);\n+        std::promise<void> pro;\n+        m_internal = std::thread([flag_ptr, &pro](typename std::decay<Function>::type&& func, typename std::decay<Args>::type&&...args){\n+            g_interrupt_flag = flag_ptr;\n+            pro.set_value();\n+            func(std::forward<Args>(args)...);\n+        }, std::forward<Function>(func), std::forward<Args>(args)...);\n+        pro.get_future().get();\n+    }\n+\n+    void join();\n+    void interrupt();\n+\n+private:\n+    std::thread m_internal;\n+    std::unique_ptr<InterruptFlag> m_interrupt_flag;\n+};\n+\n+class ThreadInterrupted : std::exception",
    "path": "src/threadinterrupt.h",
    "position": null,
    "original_position": 45,
    "commit_id": "692dee0963e06948e7e71acc597d04f71cd5b47f",
    "original_commit_id": "95fd49ae4c6b0cd45ae8a827e074af20ed75fbdf",
    "user": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Is the nonpublic inheritance here intentional? If so, make the inheritance explicitly `private` and add a comment to clarify that this is intentional. If not, make it `public` :-)\r\n\r\nBackground:\r\n\r\n`ThreadInterrupted` won't be catched by say `catch (const std::exception& e)` since `ThreadInterrupted` has nonpublic inheritance from `std::exception`.\r\n\r\nExample:\r\n\r\n```\r\n[cling]$ #include <iostream>\r\n[cling]$ class PublicInheritanceException : public std::exception {};\r\n[cling]$ try {\r\n             throw PublicInheritanceException();\r\n         } catch (const std::exception& e) {\r\n             std::cout << \"exception catched\\n\";\r\n         }\r\nexception catched\r\n[cling]$ class PrivateByDefaultInheritanceException : std::exception {};\r\n[cling]$ try {\r\n             throw PrivateByDefaultInheritanceException();\r\n         } catch (const std::exception& e) {\r\n             std::cout << \"exception catched\\n\";\r\n         }\r\n*program terminates*\r\n```\r\n\r\n",
    "created_at": "2018-10-17T10:26:05Z",
    "updated_at": "2018-11-02T15:28:04Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14489#discussion_r225867106",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14489",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225867106"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14489#discussion_r225867106"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14489"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225867106/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 71,
    "side": "RIGHT"
  }
]