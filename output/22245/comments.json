[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/860962286",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22245#issuecomment-860962286",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22245",
    "id": 860962286,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg2MDk2MjI4Ng==",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?u=9791e96cd4268d48e3517bac41eaf2b1d09759fd&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-14T20:13:45Z",
    "updated_at": "2021-06-14T20:13:45Z",
    "author_association": "MEMBER",
    "body": "ACK ee5fb1f8dcdca66af992f05081c71703aa43fdff\r\n\r\nReviewed code and checked that the test fails on master but not on this PR.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/860962286/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 1,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/861021033",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22245#issuecomment-861021033",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22245",
    "id": 861021033,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg2MTAyMTAzMw==",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-14T21:55:06Z",
    "updated_at": "2021-06-17T21:44:14Z",
    "author_association": "MEMBER",
    "body": "~~utACK ee5fb1f8dcdca66af992f05081c71703aa43fdff~~",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/861021033/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 1,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/861359211",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22245#issuecomment-861359211",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22245",
    "id": 861359211,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg2MTM1OTIxMQ==",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-15T09:52:55Z",
    "updated_at": "2021-06-15T09:52:55Z",
    "author_association": "MEMBER",
    "body": "ACK ee5fb1f8dcdca66af992f05081c71703aa43fdff",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/861359211/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 1,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/861602046",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22245#issuecomment-861602046",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22245",
    "id": 861602046,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg2MTYwMjA0Ng==",
    "user": {
      "login": "amitiuttarwar",
      "id": 1500952,
      "node_id": "MDQ6VXNlcjE1MDA5NTI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1500952?u=f0ef8142342bcda68fe46c952d3c653456811ed4&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/amitiuttarwar",
      "html_url": "https://github.com/amitiuttarwar",
      "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
      "following_url": "https://api.github.com/users/amitiuttarwar/following{/other_user}",
      "gists_url": "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
      "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
      "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
      "events_url": "https://api.github.com/users/amitiuttarwar/events{/privacy}",
      "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-15T15:32:20Z",
    "updated_at": "2021-06-15T15:32:20Z",
    "author_association": "MEMBER",
    "body": "thank you for the reviews! I force pushed to address [marco's comment](https://github.com/bitcoin/bitcoin/pull/22245#discussion_r651510247). the [diff](https://github.com/bitcoin/bitcoin/compare/ee5fb1f8dcdca66af992f05081c71703aa43fdff..89524b25efc397b9fb89536d827df3a600b6fbdf) is very small, so hopefully should be very easy to reACK. ",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/861602046/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/861614629",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22245#issuecomment-861614629",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22245",
    "id": 861614629,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg2MTYxNDYyOQ==",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?u=0691974eedcc2ab5366cc1080fb1c030e87244c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-15T15:48:16Z",
    "updated_at": "2021-06-15T15:48:16Z",
    "author_association": "MEMBER",
    "body": "easy re-ACK 89524b25efc397b9fb89536d827df3a600b6fbdf \ud83c\udff3\r\n\r\n<details><summary>Show signature and timestamp</summary>\r\n\r\nSignature:\r\n\r\n```\r\n-----BEGIN PGP SIGNED MESSAGE-----\r\nHash: SHA512\r\n\r\neasy re-ACK 89524b25efc397b9fb89536d827df3a600b6fbdf \ud83c\udff3\r\n-----BEGIN PGP SIGNATURE-----\r\n\r\niQGzBAEBCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\r\npUi0MAv/YQTTCEElYXs2V3M0yc4sL22r/0V9G0RBxJOy95a6lFev8gkwnAhlUaTY\r\ncE5bogD3Iy5EzNXYmKQQsI/6LyaBEkgBInlraDA0YtZdJ6NDAeiEBBVT9npeaLVh\r\nLM5NG6guJaFdDPVCJHc2zdrNyJBt65B3jUCCPRb6Z10LOCRsiz43W5OsRk9vEQDx\r\npbQVNAkyfDBfrlQ8EogDTxNyeDw3yluQBghbWm4di88KNtMK0xP4NMN4FKMmnUtm\r\n5VjME2xMlBvOscp9ja4U1o4eWnS3WCT53tkh5lcoSCjARfIi4mqC+HiFZr00TRd9\r\n0tcxv+T6YW5B2292KzW+UCrmzBC2X7lj7eCfpqJ0AdKRJ2jAviHL76Tv1nUKCuLS\r\nalyKmXCgtk2bTk+0ts0lYsv59ecbvP0KW1wbkI3BlauM+vEhDxhlQ3nTQ8VCXVQa\r\nyL0LuWgY92pxx0Od/y5HJXZw0MkeZkTYsFxxy8N/7uZhL2JmPWvZ3iPP7rsG8VZI\r\nc1gEV58T\r\n=R9+p\r\n-----END PGP SIGNATURE-----\r\n```\r\n\r\n[Timestamp of file with hash `2a48f9b25bb976253d76e769baa2281f8a5327db2b65c3cb3f3e909d023e9827  -`](https://opentimestamps.org/info/?004f70656e54696d657374616d7073000050726f6f6600bf89e2e884e8929401082a48f9b25bb976253d76e769baa2281f8a5327db2b65c3cb3f3e909d023e9827f0109699b2b56791dee5a214d3810007075908fff01030a52999237e744fb0f097471313daa508f10460c8cbb3f00821a1dc58f5f2912d0083dfe30d2ef90c8e292868747470733a2f2f66696e6e65792e63616c656e6461722e657465726e69747977616c6c2e636f6dfff01084d0e89da1b4462f2e707fa606cffd1a08f10460c8cbb3f008b57a75f12f307d9f0083dfe30d2ef90c8e232268747470733a2f2f6274632e63616c656e6461722e636174616c6c6178792e636f6dfff010ea2344c5c78f94e4c414084312e3216a08f10460c8cbb3f008581d0b4bf4b127ce0083dfe30d2ef90c8e2c2b68747470733a2f2f626f622e6274632e63616c656e6461722e6f70656e74696d657374616d70732e6f7267f010fe31a7e3a9f7461d67a529232e32a11408f10460c8cbb3f0082b492929ef03dc0b0083dfe30d2ef90c8e2e2d68747470733a2f2f616c6963652e6274632e63616c656e6461722e6f70656e74696d657374616d70732e6f7267)\r\n\r\n</details>\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/861614629/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 1,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/861618500",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22245#issuecomment-861618500",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22245",
    "id": 861618500,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg2MTYxODUwMA==",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-15T15:53:14Z",
    "updated_at": "2021-06-15T15:53:14Z",
    "author_association": "MEMBER",
    "body": "ACK 89524b25efc397b9fb89536d827df3a600b6fbdf",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/861618500/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 1,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/861620517",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22245#issuecomment-861620517",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22245",
    "id": 861620517,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg2MTYyMDUxNw==",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?u=13b19d1ff2f5f914e180c41418f451a4ba6f8bd1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-15T15:55:45Z",
    "updated_at": "2021-06-15T15:55:45Z",
    "author_association": "MEMBER",
    "body": "We might want to update BIP155 for this (@vasild what do you think?). How I've always interpreted is that in principle, the `sendaddrv2` message means that the sending node supports v2 addr messages. This is orthogonal to whether it wants to receive address messages in the first place.\r\n\r\nI'm not opposed to combining these, though it's not clear to me how a node would signal it doesn't want to receive address messages at all. ",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/861620517/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/861677283",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22245#issuecomment-861677283",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22245",
    "id": 861677283,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg2MTY3NzI4Mw==",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-15T17:10:23Z",
    "updated_at": "2021-06-15T17:10:23Z",
    "author_association": "MEMBER",
    "body": "ACK 7c141b77764359dedc8815ce8484f42f87727dbe",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/861677283/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/861680794",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22245#issuecomment-861680794",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22245",
    "id": 861680794,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg2MTY4MDc5NA==",
    "user": {
      "login": "amitiuttarwar",
      "id": 1500952,
      "node_id": "MDQ6VXNlcjE1MDA5NTI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1500952?u=f0ef8142342bcda68fe46c952d3c653456811ed4&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/amitiuttarwar",
      "html_url": "https://github.com/amitiuttarwar",
      "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
      "following_url": "https://api.github.com/users/amitiuttarwar/following{/other_user}",
      "gists_url": "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
      "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
      "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
      "events_url": "https://api.github.com/users/amitiuttarwar/events{/privacy}",
      "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-15T17:14:52Z",
    "updated_at": "2021-06-15T17:14:52Z",
    "author_association": "MEMBER",
    "body": "@MarcoFalke, @jnewbery - thanks for the quick re-reviews! \r\n\r\nsorry to have force-pushed again, but looking at #22243 made me realize I was introducing potential for a race here, so I added acquiring `p2p_lock` to the new tests. \r\n\r\n@laanwj \r\n> We might want to update BIP155 for this... \r\n\r\nAre you thinking something like \"Clients are NOT RECOMMENDED to send a `sendaddrv2` message if they are not interested in participating in address relay over the connection.\"? It doesn't seem necessary to me, but also doesn't seem harmful. \r\n\r\n> though it's not clear to me how a node would signal it doesn't want to receive address messages at all.\r\n\r\nHave you seen #21528? I'm proposing a \"opt-in\" approach vs an \"opt-out\" approach for propagating addr self-announcements to inbound peers. ",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/861680794/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/861871032",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22245#issuecomment-861871032",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22245",
    "id": 861871032,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg2MTg3MTAzMg==",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?u=9791e96cd4268d48e3517bac41eaf2b1d09759fd&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-15T22:14:03Z",
    "updated_at": "2021-06-16T16:56:34Z",
    "author_association": "MEMBER",
    "body": "~~re-ACK 7c141b77764359dedc8815ce8484f42f87727dbe~~\r\n\r\nRescinding this as it seems this change is contentious.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/861871032/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/861879181",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22245#issuecomment-861879181",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22245",
    "id": 861879181,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg2MTg3OTE4MQ==",
    "user": {
      "login": "benthecarman",
      "id": 15256660,
      "node_id": "MDQ6VXNlcjE1MjU2NjYw",
      "avatar_url": "https://avatars.githubusercontent.com/u/15256660?u=eab48576b7831944b8ce7f04fcdff4154a853d50&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/benthecarman",
      "html_url": "https://github.com/benthecarman",
      "followers_url": "https://api.github.com/users/benthecarman/followers",
      "following_url": "https://api.github.com/users/benthecarman/following{/other_user}",
      "gists_url": "https://api.github.com/users/benthecarman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/benthecarman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/benthecarman/subscriptions",
      "organizations_url": "https://api.github.com/users/benthecarman/orgs",
      "repos_url": "https://api.github.com/users/benthecarman/repos",
      "events_url": "https://api.github.com/users/benthecarman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/benthecarman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-15T22:34:20Z",
    "updated_at": "2021-06-15T22:34:20Z",
    "author_association": "CONTRIBUTOR",
    "body": "re-ACK 7c141b77764359dedc8815ce8484f42f87727dbe",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/861879181/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/862044403",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22245#issuecomment-862044403",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22245",
    "id": 862044403,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg2MjA0NDQwMw==",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?u=3f68150a5f30acd541d1ed279376cd20b78046b1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-16T05:11:21Z",
    "updated_at": "2021-06-16T05:11:21Z",
    "author_association": "MEMBER",
    "body": "The current implemented behavior of sendaddrv2 is a clean binary signal: BIP155 addrv2 format support true/false.  It may be good to update BIP155 to clarify that.\r\n\r\nConsequences of the proposed widening of sendaddrv2 semantics (if my thinking isn't muddled):\r\n\r\n- loss of signal: we can no longer know if a block-relay peer does not support addrv2\r\n\r\n- irreversibility: once propagated across the network in a release, reverting the change cannot recover the lost information from peers using that release, so if we need it for a reason that we don't foresee today, we would need to introduce a new message mechanism again\r\n\r\nIt seems there should be a very compelling reason beyond \"it's harmless but currently irrelevant to block-relay peers\" to irreversibly widen the semantics from the current implementation, and that the BIP could be clarified.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/862044403/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/862246086",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22245#issuecomment-862246086",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22245",
    "id": 862246086,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg2MjI0NjA4Ng==",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-16T10:34:04Z",
    "updated_at": "2021-06-16T10:34:04Z",
    "author_association": "MEMBER",
    "body": "@jonatack this was discussed briefly in the p2p irc meeting last night: https://www.erisian.com.au/bitcoin-core-dev/log-2021-06-15.html#l-284\r\n\r\nI agree with what @sipa said in that meeting:\r\n\r\n```\r\n304 2021-06-15T21:16:13  <sipa> if you don't care about addresses, sending sendaddrv2 is just irrelevant\r\n```\r\n\r\nBIP 155 is explicit about [what the sendaddrv2 message](https://github.com/bitcoin/bips/blob/master/bip-0155.mediawiki#signaling-support-and-compatibility) means:\r\n\r\n> Introduce a new message type sendaddrv2. Sending such a message indicates that a node can understand and prefers to receive addrv2 messages instead of addr messages. I.e. \"Send me addrv2\".\r\n\r\nIf a node doesn't wish to receive any addr messages, then it shouldn't send a `sendaddrv2` message to request its peer to \"Send me addrv2\".",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/862246086/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/862279099",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22245#issuecomment-862279099",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22245",
    "id": 862279099,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg2MjI3OTA5OQ==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-16T10:53:12Z",
    "updated_at": "2021-06-16T10:53:12Z",
    "author_association": "CONTRIBUTOR",
    "body": "The `sendaddrv2` message has a very clear purpose - to announce that the peer who emitted it supports the `addrv2` format (and obviously prefers to receive `addrv2` instead of `addr`). This is [documented in BIP155](https://github.com/bitcoin/bips/blob/master/bip-0155.mediawiki#signaling-support-and-compatibility). If the semantic of `sendaddrv2` is to be changed, that should start by modifying BIP155. There must be a very compelling reason (as @jonatack mentions above) to change it, given that its already deployed and running on mainnet. Tweaks to address relay is not such a reason, IMO.\r\n\r\nThere already was a [discussion](https://github.com/bitcoin/bips/pull/907#issuecomment-686044611) whether to add extra meaning in `sendaddrv2` before it was introduced (whether to tie it to relay/not-relay). It [concluded like this](https://github.com/bitcoin/bips/pull/907#issuecomment-694471696).\r\n\r\nOn the organizational level - I think it is not a good idea to rush such a change to the code _and the protocol_ near or past the feature freeze (this PR was opened a few hours before FF).\r\n\r\nOn the technical level - I think it would be most simple and flexible to introduce a new flag \"I (don't) want unrequested addresses\". This could be done with either a new message or a service bit. Having two separate flags for the supported format (`A`) and the desire to receive gossip (`B`) would allow all 4 combinations, let's say:\r\n\r\n* `A` - support for `addrv2` (currently equal to sending `sendaddrv2`)\r\n* `B` - want unrequested addresses\r\n\r\n1. `!A` and `!B` (it follows that if you send me a reply to my `getaddr` it should be in the old `addr` format because I don't support the new `addrv2`)\r\n2. `!A` and `B`\r\n3. `A` and `!B` (it follows that if you send me a reply to my `getaddr` I prefer it to be in the `addrv2` format)\r\n4. `A` and `B`\r\n\r\nSignalling \"I want unrequested addresses\" (`B`) could mean that I either maintain an address database and/or participate in gossip. Which one it is (or both) is irrelevant to my peer who only needs to know whether to gossip to me or not.\r\n\r\nhttps://github.com/bitcoin/bitcoin/pull/17194 is related, cc @naumenkogs ",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/862279099/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/862284713",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22245#issuecomment-862284713",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22245",
    "id": 862284713,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg2MjI4NDcxMw==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-16T11:02:16Z",
    "updated_at": "2021-06-16T11:30:10Z",
    "author_association": "CONTRIBUTOR",
    "body": "> BIP 155 is explicit about [what the sendaddrv2 message](https://github.com/bitcoin/bips/blob/master/bip-0155.mediawiki#signaling-support-and-compatibility) means:\r\n> \r\n> > Introduce a new message type sendaddrv2. Sending such a message indicates that a node can understand and prefers to receive addrv2 messages instead of addr messages. I.e. \"Send me addrv2\".\r\n> \r\n> If a node doesn't wish to receive any addr messages, then it shouldn't send a `sendaddrv2` message to request its peer to \"Send me addrv2\".\r\n\r\nOh, well, I was thinking that the BIP155 wording is clear enough, but apparently it is not. The intention is to say \"send me red apples **instead** of green apples (if you are going to send me any apples at all)\", not to mandate whether I want apples or not. Edit: opened https://github.com/bitcoin/bips/pull/1134 to clarify the wording.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/862284713/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/862376493",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22245#issuecomment-862376493",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22245",
    "id": 862376493,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg2MjM3NjQ5Mw==",
    "user": {
      "login": "mzumsande",
      "id": 48763452,
      "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
      "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mzumsande",
      "html_url": "https://github.com/mzumsande",
      "followers_url": "https://api.github.com/users/mzumsande/followers",
      "following_url": "https://api.github.com/users/mzumsande/following{/other_user}",
      "gists_url": "https://api.github.com/users/mzumsande/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
      "organizations_url": "https://api.github.com/users/mzumsande/orgs",
      "repos_url": "https://api.github.com/users/mzumsande/repos",
      "events_url": "https://api.github.com/users/mzumsande/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mzumsande/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-16T13:23:20Z",
    "updated_at": "2021-06-16T13:23:20Z",
    "author_association": "CONTRIBUTOR",
    "body": "I don't think that #21528 is strictly dependent on this PR, in that it would work less well without including SENDADDRV2 in the list of messages indicating willingness to participate in addr relay. There would still be  ADDR/ADDRV2 and GETADDR left as an indication.\r\n \r\nIn the short term, it might even work more precisely, because black-hole peers that  send out SENDADDRV2 without an intent to participate in addr relay on this particular connection (notably block-relay-only connections of  v0.21 nodes) wouldn't be incorrectly identified as peers interested in addr relay.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/862376493/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/862390602",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22245#issuecomment-862390602",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22245",
    "id": 862390602,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg2MjM5MDYwMg==",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-16T13:41:26Z",
    "updated_at": "2021-06-16T13:41:26Z",
    "author_association": "MEMBER",
    "body": "> If the semantic of sendaddrv2 is to be changed, that should start by modifying BIP155\r\n\r\nThis PR is not changing the semantics of BIP155. It's simply changing the Bitcoin Core node behavior to not send a message that is irrelevant. If we ignore all addr messages on a connection, then there's absolutely no point in sending a message on that connection which says \"please send addrs in such-and-such format\".\r\n\r\n> The intention is to say \"send me red apples instead of green apples (if you are going to send me any apples at all)\", not to mandate whether I want apples or not.\r\n\r\nThis doesn't make sense to me. Why would I say \"send me red apples instead of green apples\" when I don't eat apples at all and I'm going to put all the apples in the trash?\r\n\r\nTo summarize what the current behavior is for block-relay-only connection:\r\n\r\n- we make a connection out to the peer\r\n- we send a `sendaddrv2` message\r\n- the peer sends us `addrv2` messages\r\n- we ignore those `addrv2` messages\r\n\r\nafter this PR:\r\n\r\n- we make a connection out to the peer\r\n- the peer sends us `addr` messages\r\n- we ignore those `addr` messages\r\n\r\nThere's essentially no change to our addr processing. The only change for the peer is that they'll serialize addresses as `addr` instead of `addrv2`. There are no implications or changes to the protocol.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/862390602/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/862539375",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22245#issuecomment-862539375",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22245",
    "id": 862539375,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg2MjUzOTM3NQ==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-16T16:45:16Z",
    "updated_at": "2021-06-16T16:45:16Z",
    "author_association": "CONTRIBUTOR",
    "body": "The semantic of `sendaddrv2` is to announce support for the `addrv2` format (if you find the text in BIP155 vague, refer to the code - it does exactly that and the code not vague).\r\n\r\n> > If the semantic of sendaddrv2 is to be changed, that should start by modifying BIP155\r\n> \r\n> This PR is not changing the semantics of BIP155.\r\n\r\nThis PR+https://github.com/bitcoin/bitcoin/pull/21528 change the semantic of not only BIP155 (`sendaddrv2`) but to the `getaddr`, `addr` and `addrv2` messages. I think both PRs should be considered together. The change in semantic is because, e.g. `getaddr` is changed from \"give me some addresses\" to \"give me some addresses and I participate in address relay, so if you send me addresses now or unrequested later I promise to further relay them to others, I am not a black hole\".\r\n\r\n> It's simply changing the Bitcoin Core node behavior to not send a message that is irrelevant. If we ignore all addr messages on a connection, then there's absolutely no point in sending a message on that connection which says \"please send addrs in such-and-such format\".\r\n\r\n`sendaddrv2` does not say that, see the top of this post. But anyway - looking at this PR in isolation could be misleading as the big picture is in https://github.com/bitcoin/bitcoin/pull/21528.\r\n\r\n> > The intention is to say \"send me red apples instead of green apples (if you are going to send me any apples at all)\", not to mandate whether I want apples or not.\r\n> \r\n> This doesn't make sense to me. Why would I say \"send me red apples instead of green apples\" when I don't eat apples at all and I'm going to put all the apples in the trash?\r\n\r\nYou may be eating apples after all. What if we look beyond the Bitcoin Core's block-relay mode? There may be a case where one does not want unrequested address messages, but could send `getaddr` and wants replies to that to be in `addrv2` format. This cannot be done with your interpretation of `sendaddrv2`, this PR and https://github.com/bitcoin/bitcoin/pull/21528.\r\n\r\n> To summarize what the current behavior is for block-relay-only connection:\r\n>     * we make a connection out to the peer\r\n>     * we send a `sendaddrv2` message\r\n>     * the peer sends us `addrv2` messages\r\n>     * we ignore those `addrv2` messages\r\n> \r\n> after this PR:\r\n>     * we make a connection out to the peer\r\n>     * the peer sends us `addr` messages\r\n>     * we ignore those `addr` messages\r\n> \r\n> There's essentially no change to our addr processing. The only change for the peer is that they'll serialize addresses as `addr` instead of `addrv2`. There are no implications or changes to the protocol.\r\n\r\nI agree that this PR alone looks innocent, but then if we are to look at this PR alone, the change is also pointless, so why do it?",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/862539375/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/862657075",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22245#issuecomment-862657075",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22245",
    "id": 862657075,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg2MjY1NzA3NQ==",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-16T19:33:25Z",
    "updated_at": "2021-06-16T19:36:03Z",
    "author_association": "MEMBER",
    "body": "@vasild Am I correct in interpreting your position this way: address gossip is considered to be a well-defined aspect of the P2P protocol, and given that #21528 is changing the semantics of a number of messages, including `sendaddrv2`, that change matters. It's not specifically this PR you're concerned about, but the fact that 21528 is changing semantics (which this PR relies on), and those semantics don't match BIP155.\r\n\r\nIf so, I'd counter with my view that addr gossip is only a local policy choice that every client makes, and is (so far) not the subject of any BIP at all. Network rules are defined by more than just BIPs, and expectations of network nodes matter just as much. However, in this case, given the fact that lots of actually deployed nodes on the network don't and never have participated in addr gossip at all, I think it's fair to say that choosing to not do so isn't much of a break. Because of that, I think that these PRs are best seen as only changing heuristics about what and where to relay addresses. Perhaps going further than earlier heuristics we had, but still, clients are free to relay whatever they want or nothing at all. It's not related to BIP155, because that BIP specifies addrv2 relay and announcing support for it; the choice of gossip or not is outside of its scope.\r\n\r\nI do think the lack of clarity in the situation is unfortunate, and could be improved if someone wants to put in the work of analyzing the goals and expectations of address gossip, by writing up a specification for messages for explicitly opting in or out of address relay. That would supersede all this. I don't think it's necessary to formalize this aspect of the protocol before being able to make improvements, though.\r\n\r\n> The change in semantic is because, e.g. getaddr is changed from \"give me some addresses\" to \"give me some addresses and I participate in address relay, so if you send me addresses now or unrequested later I promise to further relay them to others, I am not a black hole\".\r\n\r\nI think that interpretation is inaccurate. There is no expectation of not black holing. Even if you see it as a specification change, at best it means \"I want to be served addresses\" - the receiver is free to use them directly or not, put them in a database or not, relay them or not, or none at all and just drop them. The aim of 21528 is just not knowingly relaying to those who don't care about addresses anyway. If an attacker wants to be an intentional black hole, they can keep claiming they want addresses and ignore them.\r\n\r\n> You may be eating apples after all. What if we look beyond the Bitcoin Core's block-relay mode? There may be a case where one does not want unrequested address messages, but could send getaddr and wants replies to that to be in addrv2 format. This cannot be done with your interpretation of sendaddrv2, this PR and #21528.\r\n\r\nI think that's fine. It's a heuristic and it is expected that there can be situations where it is overly conservative. Receiving gossip is the status quo, so when there isn't a signal to infer the other party isn't interested in it, we should assume that they want it. There is no harm done, because it's the same as we do now. Nothing here prevents or worsens the ability for an actual protocol message from explicitly opting out of gossip, if that were desirable.\r\n\r\nWould it ease your concerns if the interaction with `sendaddrv2` was removed (i.e., this PR closed, and `sendaddrv2` removed from triggering gossip in #21528)? My understanding is that it is only added for consistency reasons to 21528, and that that necessitates this PR. The advantages of the current approach are that the heuristic is more conservative, so (even) less likely to miss situations where gossip is desired, and more consistent (\"you're doing something related to addr relay, you probably care about gossip\"). On the other hand, if sendaddrv2 is excluded, this PR isn't necessary, and block-only connections from 0.21 nodes will also get the benefit. Perhaps that makes sense; it's treating sendaddrv2 purely as a configuration setting then, and to opt into gossip, you have to actually ask or send addresses.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/862657075/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/862839610",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22245#issuecomment-862839610",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22245",
    "id": 862839610,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg2MjgzOTYxMA==",
    "user": {
      "login": "sdaftuar",
      "id": 7463573,
      "node_id": "MDQ6VXNlcjc0NjM1NzM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7463573?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sdaftuar",
      "html_url": "https://github.com/sdaftuar",
      "followers_url": "https://api.github.com/users/sdaftuar/followers",
      "following_url": "https://api.github.com/users/sdaftuar/following{/other_user}",
      "gists_url": "https://api.github.com/users/sdaftuar/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sdaftuar/subscriptions",
      "organizations_url": "https://api.github.com/users/sdaftuar/orgs",
      "repos_url": "https://api.github.com/users/sdaftuar/repos",
      "events_url": "https://api.github.com/users/sdaftuar/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sdaftuar/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-17T01:17:23Z",
    "updated_at": "2021-06-17T01:17:23Z",
    "author_association": "MEMBER",
    "body": "> Would it ease your concerns if the interaction with `sendaddrv2` was removed (i.e., this PR closed, and `sendaddrv2` removed from triggering gossip in #21528)? My understanding is that it is only added for consistency reasons to 21528, and that that necessitates this PR. \r\n\r\nMy take is that the approach in #21528 \u2014 of inferring addr relay heuristics from observed messages to improve network behavior \u2014 is conceptually fine, now that we\u2019ve put the work in to minimize the chance that the changes there could break other software, but that changing the way we send `sendaddrv2` to try to achieve some perceived consistency with the legacy addr messages is purely an aesthetic choice and not a functional one. So overall I think this choice doesn\u2019t matter much, but it does seem both aesthetically and functionally worse to me that we\u2019d stop sending this message as proposed here, because (a) there is some benefit as @jonatack mentioned for measuring deployment of BIP 155 by always sending and (b) even aesthetically I think that it\u2019s better that signaling of support for addrv2 should be orthogonal to addr relay negotiation itself, so in the future when I hope someone proposes some more comprehensive addr relay protocol I think we will just want to uncouple these things anyway. In general I think we don\u2019t want to have complicated interactions to reason about when different combinations of p2p messages are sent, and BIP 155 is nice and simple as it is.\r\n\r\nAnother way of putting it is if you think of the heuristics of #21528 as a sort of hack to achieve better addr behavior in the absence of protocol support for the functionality we want, then keeping that hack as small as possible seems best. I don\u2019t think anyone believes that implicit behavior (that is undocumented in any BIP) is the right way for protocol development to proceed if starting from a clean slate \u2014 so eventually I think we\u2019ll rewrite things.\r\n\r\n> Perhaps that makes sense; it's treating sendaddrv2 purely as a configuration setting then\r\n\r\nThis is precisely how I see it. (Again though I think it doesn\u2019t matter very much, this seems like mostly an aesthetic debate, though I do think this proposal is slightly worse than the alternative of leaving this logic unchanged.)\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/862839610/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/862870697",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22245#issuecomment-862870697",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22245",
    "id": 862870697,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg2Mjg3MDY5Nw==",
    "user": {
      "login": "ariard",
      "id": 23310655,
      "node_id": "MDQ6VXNlcjIzMzEwNjU1",
      "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ariard",
      "html_url": "https://github.com/ariard",
      "followers_url": "https://api.github.com/users/ariard/followers",
      "following_url": "https://api.github.com/users/ariard/following{/other_user}",
      "gists_url": "https://api.github.com/users/ariard/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ariard/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
      "organizations_url": "https://api.github.com/users/ariard/orgs",
      "repos_url": "https://api.github.com/users/ariard/repos",
      "events_url": "https://api.github.com/users/ariard/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ariard/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-17T02:37:30Z",
    "updated_at": "2021-06-17T02:37:30Z",
    "author_association": "MEMBER",
    "body": "> I do think the lack of clarity in the situation is unfortunate, and could be improved if someone wants to put in the work of analyzing the goals and expectations of address gossip, by writing up a specification for messages for explicitly opting in or out of address relay. That would supersede all this. I don't think it's necessary to formalize this aspect of the protocol before being able to make improvements, though.\r\n\r\nI think this would be a worthy specification if addr relay is more relied on in the future by lightweight clients (for e.g a wider number of BIP157 filters consumers, that Core encourage the deployment of with its current network policy). An under-specified, buggy addr gossip mechanism would lure to a poor quality of their addrman diversity, or even ease malicious poisoning of their network view.\r\n\r\nAs for now, I believe the impact of our network policy changes on the rest of the ecosystem have been well-studied in #21528, enough to clear up the concern of breaking other Bitcoin clients, and letting code improvements happening in the lack of aforementioned specification.\r\n\r\n> (a) there is some benefit as @jonatack mentioned for measuring deployment of BIP 155 by always sending\r\n\r\nOn this specific point of gathering statistics or risk of \"irreversible changes\", I don't think that's a blocker for this PR, as this only concerning our outbound block-relay peers. A bip155 deployment measuring tool could connect as an inbound full-relay peer, sends `sendaddrv2` and wait for answer to assert the support ? Though it might be more hacky to write such software for edge-cases I've not weighted in...\r\n\r\nFrom a procedural point, I agree with vasild that if this change is contentious, in the sense all technical concerns have been duly addressed, and if we're beyond feature freeze it's better to be conservative and slow down the pace, imho.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/862870697/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/862912847",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22245#issuecomment-862912847",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22245",
    "id": 862912847,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg2MjkxMjg0Nw==",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-17T04:25:15Z",
    "updated_at": "2021-06-17T04:31:36Z",
    "author_association": "MEMBER",
    "body": "Another advantage of the exclude-sendaddrv2 approach is that it removes the pressure to get this PR in for 22.0 (or at all).",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/862912847/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/863583586",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22245#issuecomment-863583586",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22245",
    "id": 863583586,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg2MzU4MzU4Ng==",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-17T21:43:48Z",
    "updated_at": "2021-06-17T21:45:44Z",
    "author_association": "MEMBER",
    "body": "Given the discussion above, I'm retracting my ACK here. There just isn't much of a need to do this if we go the direction of dropping sendaddrv2 from triggering gossip in #21528.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/863583586/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/863590937",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22245#issuecomment-863590937",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22245",
    "id": 863590937,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg2MzU5MDkzNw==",
    "user": {
      "login": "amitiuttarwar",
      "id": 1500952,
      "node_id": "MDQ6VXNlcjE1MDA5NTI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1500952?u=f0ef8142342bcda68fe46c952d3c653456811ed4&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/amitiuttarwar",
      "html_url": "https://github.com/amitiuttarwar",
      "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
      "following_url": "https://api.github.com/users/amitiuttarwar/following{/other_user}",
      "gists_url": "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
      "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
      "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
      "events_url": "https://api.github.com/users/amitiuttarwar/events{/privacy}",
      "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-17T22:01:08Z",
    "updated_at": "2021-06-17T22:01:08Z",
    "author_association": "MEMBER",
    "body": "I agree that this PR is not essential to achieving the aims of #21528, closing  this & will remove `sendaddrv2` as signal from that PR. ",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/863590937/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/863914659",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22245#issuecomment-863914659",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22245",
    "id": 863914659,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg2MzkxNDY1OQ==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-18T09:54:03Z",
    "updated_at": "2021-06-18T09:54:03Z",
    "author_association": "CONTRIBUTOR",
    "body": "Everybody, thanks for your comments! I read everything carefully, slept over this and the following scenario came to my mind:\r\n\r\n`A` (outbound, blocks only) -> `B` (inbound)\r\n\r\n* `A` does not send `sendaddrv2` (because it is blocks-only, due to this PR)\r\n* `A` does not send `getaddr` (because it is blocks-only, as in `master`)\r\n* `B` sends `sendaddrv2`\r\n\r\nSo `B` thinks that `A` does not support `addrv2`. Later `B` requests some addresses from `A` via `getaddr` (yes, Bitcoin Core does not send `getaddr` in incoming connections, but another software, or a modified Bitcoin Core may do) and gets an `addrv2` response, which comes as a surprise because `A` never announced support for `addrv2`. Currently this would not have happened because `A`, being in blocks-only mode would ignore the `getaddr` from `B`. I would say it is better to make sure we never send `addrv2` if we did not announce our support for it via `sendaddrv2`, but I see this PR is now closed, so that is irrelevant.\r\n\r\nMore importantly, I came to the realization (or delusion) that just `getaddr` is enough for the purposes of https://github.com/bitcoin/bitcoin/pull/21528, will continue the discussion there.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/863914659/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/651510247",
    "pull_request_review_id": 683635452,
    "id": 651510247,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1MTUxMDI0Nw==",
    "diff_hunk": "@@ -74,6 +74,16 @@ def run_test(self):\n \n         assert addr_receiver.addrv2_received_and_checked\n \n+        self.log.info(\"Check that the node sends a SENDADDRV2 message to outbound full relay peers\")\n+        conn = self.nodes[0].add_outbound_p2p_connection(P2PInterface(), p2p_idx=0)\n+        conn.sync_with_ping()\n+        assert_equal(conn.message_count['sendaddrv2'], 1)\n+\n+        self.log.info(\"Check that the node does not send a SENDADDRV2 message to outbound block-relay-only peers\")\n+        conn = self.nodes[0].add_outbound_p2p_connection(P2PInterface(), p2p_idx=1, connection_type=\"block-relay-only\")\n+        conn.sync_with_ping()",
    "path": "test/functional/p2p_addrv2_relay.py",
    "position": null,
    "original_position": 11,
    "commit_id": "7c141b77764359dedc8815ce8484f42f87727dbe",
    "original_commit_id": "ee5fb1f8dcdca66af992f05081c71703aa43fdff",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "question in ee5fb1f8dcdca66af992f05081c71703aa43fdff:\r\n\r\nIs there a reason for the sync_with_ping's? Ideally the `add_outbound_p2p_connection` helper should fully setup the connection (including handshake). And it seems it does do that, as there is a `p2p_conn.wait_for_verack()` and `p2p_conn.sync_with_ping()` inside.",
    "created_at": "2021-06-15T07:12:01Z",
    "updated_at": "2021-06-15T07:12:37Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22245#discussion_r651510247",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22245",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/651510247"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/22245#discussion_r651510247"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22245"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/651510247/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 84,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/651895231",
    "pull_request_review_id": 684148360,
    "id": 651895231,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1MTg5NTIzMQ==",
    "diff_hunk": "@@ -74,6 +74,16 @@ def run_test(self):\n \n         assert addr_receiver.addrv2_received_and_checked\n \n+        self.log.info(\"Check that the node sends a SENDADDRV2 message to outbound full relay peers\")\n+        conn = self.nodes[0].add_outbound_p2p_connection(P2PInterface(), p2p_idx=0)\n+        conn.sync_with_ping()\n+        assert_equal(conn.message_count['sendaddrv2'], 1)\n+\n+        self.log.info(\"Check that the node does not send a SENDADDRV2 message to outbound block-relay-only peers\")\n+        conn = self.nodes[0].add_outbound_p2p_connection(P2PInterface(), p2p_idx=1, connection_type=\"block-relay-only\")\n+        conn.sync_with_ping()",
    "path": "test/functional/p2p_addrv2_relay.py",
    "position": null,
    "original_position": 11,
    "commit_id": "7c141b77764359dedc8815ce8484f42f87727dbe",
    "original_commit_id": "ee5fb1f8dcdca66af992f05081c71703aa43fdff",
    "user": {
      "login": "amitiuttarwar",
      "id": 1500952,
      "node_id": "MDQ6VXNlcjE1MDA5NTI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/amitiuttarwar",
      "html_url": "https://github.com/amitiuttarwar",
      "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
      "following_url": "https://api.github.com/users/amitiuttarwar/following{/other_user}",
      "gists_url": "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
      "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
      "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
      "events_url": "https://api.github.com/users/amitiuttarwar/events{/privacy}",
      "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "ah, agree its not necessary. I missed that there's already a `sync_with_ping()` inside `add_outbound_p2p_connection`, so I was adding buffer.",
    "created_at": "2021-06-15T15:16:23Z",
    "updated_at": "2021-06-15T15:16:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22245#discussion_r651895231",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22245",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/651895231"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/22245#discussion_r651895231"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22245"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/651895231/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 84,
    "side": "RIGHT",
    "in_reply_to_id": 651510247
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/651909326",
    "pull_request_review_id": 684167557,
    "id": 651909326,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1MTkwOTMyNg==",
    "diff_hunk": "@@ -74,6 +74,16 @@ def run_test(self):\n \n         assert addr_receiver.addrv2_received_and_checked\n \n+        self.log.info(\"Check that the node sends a SENDADDRV2 message to outbound full relay peers\")\n+        conn = self.nodes[0].add_outbound_p2p_connection(P2PInterface(), p2p_idx=0)\n+        conn.sync_with_ping()\n+        assert_equal(conn.message_count['sendaddrv2'], 1)\n+\n+        self.log.info(\"Check that the node does not send a SENDADDRV2 message to outbound block-relay-only peers\")\n+        conn = self.nodes[0].add_outbound_p2p_connection(P2PInterface(), p2p_idx=1, connection_type=\"block-relay-only\")\n+        conn.sync_with_ping()",
    "path": "test/functional/p2p_addrv2_relay.py",
    "position": null,
    "original_position": 11,
    "commit_id": "7c141b77764359dedc8815ce8484f42f87727dbe",
    "original_commit_id": "ee5fb1f8dcdca66af992f05081c71703aa43fdff",
    "user": {
      "login": "amitiuttarwar",
      "id": 1500952,
      "node_id": "MDQ6VXNlcjE1MDA5NTI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/amitiuttarwar",
      "html_url": "https://github.com/amitiuttarwar",
      "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
      "following_url": "https://api.github.com/users/amitiuttarwar/following{/other_user}",
      "gists_url": "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
      "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
      "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
      "events_url": "https://api.github.com/users/amitiuttarwar/events{/privacy}",
      "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "removed ",
    "created_at": "2021-06-15T15:31:14Z",
    "updated_at": "2021-06-15T15:31:14Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22245#discussion_r651909326",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22245",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/651909326"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/22245#discussion_r651909326"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22245"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/651909326/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 84,
    "side": "RIGHT",
    "in_reply_to_id": 651510247
  }
]