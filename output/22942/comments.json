[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/924710480",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22942#issuecomment-924710480",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22942",
    "id": 924710480,
    "node_id": "IC_kwDOABII5843HfZQ",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?u=0691974eedcc2ab5366cc1080fb1c030e87244c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-22T08:37:54Z",
    "updated_at": "2021-09-22T08:37:54Z",
    "author_association": "MEMBER",
    "body": "> I think this can be simplified further to use only one CallOneOf but still achieve the same thing: fjahr@2ff513b. I also added some more comments there and used a constant for the initial state hash which should help the speed some more.\r\n\r\nThanks for the 2am review and code suggestion. Took ~your branch and squashed into one commit.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/924710480/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 1,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/924718067",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22942#issuecomment-924718067",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22942",
    "id": 924718067,
    "node_id": "IC_kwDOABII5843HhPz",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?u=0691974eedcc2ab5366cc1080fb1c030e87244c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-22T08:48:01Z",
    "updated_at": "2021-09-22T08:48:01Z",
    "author_association": "MEMBER",
    "body": "Speedup: Locally it now takes 29% of the original time",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/924718067/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/924892861",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22942#issuecomment-924892861",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22942",
    "id": 924892861,
    "node_id": "IC_kwDOABII5843IL69",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?u=0691974eedcc2ab5366cc1080fb1c030e87244c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-22T12:41:32Z",
    "updated_at": "2021-09-22T12:41:32Z",
    "author_association": "MEMBER",
    "body": "CI Before: 2654 s https://cirrus-ci.com/task/4629294711308288?logs=ci#L4695\r\n\r\nCI After: 1011 s https://cirrus-ci.com/task/6682329813876736?logs=ci#L4189",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/924892861/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/928351769",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22942#issuecomment-928351769",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22942",
    "id": 928351769,
    "node_id": "IC_kwDOABII5843VYYZ",
    "user": {
      "login": "fjahr",
      "id": 1322187,
      "node_id": "MDQ6VXNlcjEzMjIxODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1322187?u=348c27f90b6fff8fd72fa27232272651436a2ff0&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjahr",
      "html_url": "https://github.com/fjahr",
      "followers_url": "https://api.github.com/users/fjahr/followers",
      "following_url": "https://api.github.com/users/fjahr/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjahr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
      "organizations_url": "https://api.github.com/users/fjahr/orgs",
      "repos_url": "https://api.github.com/users/fjahr/repos",
      "events_url": "https://api.github.com/users/fjahr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjahr/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-27T22:14:28Z",
    "updated_at": "2021-09-27T22:14:28Z",
    "author_association": "CONTRIBUTOR",
    "body": "ACK 0000dca6f0e4dda212bf8adf555b68f2c7464ff8",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/928351769/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 1,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/708705726",
    "pull_request_review_id": 754513142,
    "id": 708705726,
    "node_id": "PRRC_kwDOABII584qPf2-",
    "diff_hunk": "@@ -12,52 +12,60 @@\n FUZZ_TARGET(muhash)\n {\n     FuzzedDataProvider fuzzed_data_provider{buffer.data(), buffer.size()};\n-    std::vector<uint8_t> data = ConsumeRandomLengthByteVector(fuzzed_data_provider);\n-    std::vector<uint8_t> data2 = ConsumeRandomLengthByteVector(fuzzed_data_provider);\n-    if (data.empty()) {\n-        data.resize(fuzzed_data_provider.ConsumeIntegralInRange<size_t>(1, 4096), fuzzed_data_provider.ConsumeIntegral<uint8_t>());\n-    }\n-    if (data2.empty()) {\n-        data2.resize(fuzzed_data_provider.ConsumeIntegralInRange<size_t>(1, 4096), fuzzed_data_provider.ConsumeIntegral<uint8_t>());\n-    }\n-\n-    data = ConsumeRandomLengthByteVector(fuzzed_data_provider);\n-    data2 = ConsumeRandomLengthByteVector(fuzzed_data_provider);\n+    std::vector<uint8_t> data{ConsumeRandomLengthByteVector(fuzzed_data_provider)};\n+    std::vector<uint8_t> data2{ConsumeRandomLengthByteVector(fuzzed_data_provider)};\n \n     MuHash3072 muhash;\n \n-    // Test that MuHash result is consistent independent of order of operations\n     muhash.Insert(data);\n     muhash.Insert(data2);\n \n-    uint256 out;\n-    muhash.Finalize(out);\n-\n-    muhash = MuHash3072();\n-    muhash.Insert(data2);\n-    muhash.Insert(data);\n-\n-    uint256 out2;\n-    muhash.Finalize(out2);\n-\n-    assert(out == out2);\n-    MuHash3072 muhash3;\n-    muhash3 *= muhash;\n-    uint256 out3;\n-    muhash3.Finalize(out3);\n-    assert(out == out3);\n-\n-    // Test that removing all added elements brings the object back to it's initial state\n-    muhash /= muhash;\n-    muhash.Finalize(out);\n-\n-    MuHash3072 muhash2;\n-    muhash2.Finalize(out2);\n-\n-    assert(out == out2);\n-\n-    muhash3.Remove(data);\n-    muhash3.Remove(data2);\n-    muhash3.Finalize(out3);\n-    assert(out == out3);\n+    CallOneOf(\n+        fuzzed_data_provider,\n+        [&] {\n+            // Test that MuHash result is consistent independent of order of operations\n+            uint256 out;\n+            muhash.Finalize(out);\n+            CallOneOf(\n+                fuzzed_data_provider,\n+                [&] {\n+                    MuHash3072 muhash_inverse_order;\n+                    muhash_inverse_order = MuHash3072();",
    "path": "src/test/fuzz/muhash.cpp",
    "position": null,
    "original_position": 64,
    "commit_id": "0000dca6f0e4dda212bf8adf555b68f2c7464ff8",
    "original_commit_id": "fa12ae5211f1e599d4fbf9100fee0ad09313ae1b",
    "user": {
      "login": "fjahr",
      "id": 1322187,
      "node_id": "MDQ6VXNlcjEzMjIxODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjahr",
      "html_url": "https://github.com/fjahr",
      "followers_url": "https://api.github.com/users/fjahr/followers",
      "following_url": "https://api.github.com/users/fjahr/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjahr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
      "organizations_url": "https://api.github.com/users/fjahr/orgs",
      "repos_url": "https://api.github.com/users/fjahr/repos",
      "events_url": "https://api.github.com/users/fjahr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjahr/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I think this line is redundant.",
    "created_at": "2021-09-14T22:35:11Z",
    "updated_at": "2021-09-15T00:24:13Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22942#discussion_r708705726",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22942",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/708705726"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/22942#discussion_r708705726"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22942"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/708705726/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 33,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/713719198",
    "pull_request_review_id": 760615943,
    "id": 713719198,
    "node_id": "PRRC_kwDOABII584qin2e",
    "diff_hunk": "@@ -12,52 +12,60 @@\n FUZZ_TARGET(muhash)\n {\n     FuzzedDataProvider fuzzed_data_provider{buffer.data(), buffer.size()};\n-    std::vector<uint8_t> data = ConsumeRandomLengthByteVector(fuzzed_data_provider);\n-    std::vector<uint8_t> data2 = ConsumeRandomLengthByteVector(fuzzed_data_provider);\n-    if (data.empty()) {\n-        data.resize(fuzzed_data_provider.ConsumeIntegralInRange<size_t>(1, 4096), fuzzed_data_provider.ConsumeIntegral<uint8_t>());\n-    }\n-    if (data2.empty()) {\n-        data2.resize(fuzzed_data_provider.ConsumeIntegralInRange<size_t>(1, 4096), fuzzed_data_provider.ConsumeIntegral<uint8_t>());\n-    }\n-\n-    data = ConsumeRandomLengthByteVector(fuzzed_data_provider);\n-    data2 = ConsumeRandomLengthByteVector(fuzzed_data_provider);\n+    std::vector<uint8_t> data{ConsumeRandomLengthByteVector(fuzzed_data_provider)};\n+    std::vector<uint8_t> data2{ConsumeRandomLengthByteVector(fuzzed_data_provider)};\n \n     MuHash3072 muhash;\n \n-    // Test that MuHash result is consistent independent of order of operations\n     muhash.Insert(data);\n     muhash.Insert(data2);\n \n-    uint256 out;\n-    muhash.Finalize(out);\n-\n-    muhash = MuHash3072();\n-    muhash.Insert(data2);\n-    muhash.Insert(data);\n-\n-    uint256 out2;\n-    muhash.Finalize(out2);\n-\n-    assert(out == out2);\n-    MuHash3072 muhash3;\n-    muhash3 *= muhash;\n-    uint256 out3;\n-    muhash3.Finalize(out3);\n-    assert(out == out3);\n-\n-    // Test that removing all added elements brings the object back to it's initial state\n-    muhash /= muhash;\n-    muhash.Finalize(out);\n-\n-    MuHash3072 muhash2;\n-    muhash2.Finalize(out2);\n-\n-    assert(out == out2);\n-\n-    muhash3.Remove(data);\n-    muhash3.Remove(data2);\n-    muhash3.Finalize(out3);\n-    assert(out == out3);\n+    CallOneOf(\n+        fuzzed_data_provider,\n+        [&] {\n+            // Test that MuHash result is consistent independent of order of operations\n+            uint256 out;\n+            muhash.Finalize(out);\n+            CallOneOf(\n+                fuzzed_data_provider,\n+                [&] {\n+                    MuHash3072 muhash_inverse_order;\n+                    muhash_inverse_order = MuHash3072();",
    "path": "src/test/fuzz/muhash.cpp",
    "position": null,
    "original_position": 64,
    "commit_id": "0000dca6f0e4dda212bf8adf555b68f2c7464ff8",
    "original_commit_id": "fa12ae5211f1e599d4fbf9100fee0ad09313ae1b",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "restored original code",
    "created_at": "2021-09-22T08:37:06Z",
    "updated_at": "2021-09-22T08:37:07Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22942#discussion_r713719198",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22942",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/713719198"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/22942#discussion_r713719198"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22942"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/713719198/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 33,
    "side": "RIGHT",
    "in_reply_to_id": 708705726
  }
]