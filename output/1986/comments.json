[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/10062557",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/1986#issuecomment-10062557",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/1986",
    "id": 10062557,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEwMDYyNTU3",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?u=13b19d1ff2f5f914e180c41418f451a4ba6f8bd1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2012-11-05T07:41:10Z",
    "updated_at": "2012-11-05T07:46:49Z",
    "author_association": "MEMBER",
    "body": "I agree this is useful, even with encrypted transport over SSL it's a safe precaution to not use cleartext passwords.\n\nIt's a pity though that we need to invent our own authentication scheme for this, but it looks like you evaluated the other options already.\n\nOne question: taking a quick look at the code I don't see any challenge response code in there. How well does this withstand replay attacks? Does it check the embedded date/time?\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/10062557/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/10078302",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/1986#issuecomment-10078302",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/1986",
    "id": 10078302,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEwMDc4MzAy",
    "user": {
      "login": "jgarzik",
      "id": 494411,
      "node_id": "MDQ6VXNlcjQ5NDQxMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/494411?u=0b02049ec38b6bb7d55c5c66d9bbeb0d4b822129&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jgarzik",
      "html_url": "https://github.com/jgarzik",
      "followers_url": "https://api.github.com/users/jgarzik/followers",
      "following_url": "https://api.github.com/users/jgarzik/following{/other_user}",
      "gists_url": "https://api.github.com/users/jgarzik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jgarzik/subscriptions",
      "organizations_url": "https://api.github.com/users/jgarzik/orgs",
      "repos_url": "https://api.github.com/users/jgarzik/repos",
      "events_url": "https://api.github.com/users/jgarzik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jgarzik/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2012-11-05T16:57:13Z",
    "updated_at": "2012-11-05T16:57:13Z",
    "author_association": "CONTRIBUTOR",
    "body": "Your basic impression is sound.  HTTP Digest was the preferred solution, but that introduces an additional round-trip to obtain a server nonce value, mitigating replay attacks.\n\nLacking that round trip to gain additional protection, the best one can do is make sure the embedded time is within a certain window.  Currently there are no time checks, because I wanted to get some feedback as to best time window.\n\nThe server could demand that the HTTP request time be +/- five (5) minutes of its own system clock... or one hour?  Which one takes into account broken clients etc. the best?  What is a good time window?\n\nThe smaller the window, the more secure.\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/10078302/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/10081088",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/1986#issuecomment-10081088",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/1986",
    "id": 10081088,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEwMDgxMDg4",
    "user": {
      "login": "jgarzik",
      "id": 494411,
      "node_id": "MDQ6VXNlcjQ5NDQxMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/494411?u=0b02049ec38b6bb7d55c5c66d9bbeb0d4b822129&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jgarzik",
      "html_url": "https://github.com/jgarzik",
      "followers_url": "https://api.github.com/users/jgarzik/followers",
      "following_url": "https://api.github.com/users/jgarzik/following{/other_user}",
      "gists_url": "https://api.github.com/users/jgarzik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jgarzik/subscriptions",
      "organizations_url": "https://api.github.com/users/jgarzik/orgs",
      "repos_url": "https://api.github.com/users/jgarzik/repos",
      "events_url": "https://api.github.com/users/jgarzik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jgarzik/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2012-11-05T18:08:32Z",
    "updated_at": "2012-11-05T18:08:32Z",
    "author_association": "CONTRIBUTOR",
    "body": "Just added a commit to clamp the timestamp to +/- 60 seconds.\n\nHowever, it is still open for discussion, because this is a usability issue:  users with a drifting clock will get an unfriendly, vague \"not authorized\" error message.  The window should be as small as possible... while still being wide enough to avoid most users hitting this issue.\n\n(of course, I think all users should be running or sync'ing with NTP, but that's an unrealistic opinion.....)\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/10081088/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/10082143",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/1986#issuecomment-10082143",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/1986",
    "id": 10082143,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEwMDgyMTQz",
    "user": {
      "login": "gmaxwell",
      "id": 858454,
      "node_id": "MDQ6VXNlcjg1ODQ1NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/858454?u=63e5c438c242094837a9deeda775d77988b508bf&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gmaxwell",
      "html_url": "https://github.com/gmaxwell",
      "followers_url": "https://api.github.com/users/gmaxwell/followers",
      "following_url": "https://api.github.com/users/gmaxwell/following{/other_user}",
      "gists_url": "https://api.github.com/users/gmaxwell/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
      "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
      "repos_url": "https://api.github.com/users/gmaxwell/repos",
      "events_url": "https://api.github.com/users/gmaxwell/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2012-11-05T18:37:38Z",
    "updated_at": "2012-11-05T18:37:38Z",
    "author_association": "CONTRIBUTOR",
    "body": "So why not use digest auth instead of something custom (and fragile) and solve the latency concerns by persisting the connection where you're concerned with that.  The session bring up tear down has more of those nasty round trips in any case.\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/10082143/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/10083046",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/1986#issuecomment-10083046",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/1986",
    "id": 10083046,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEwMDgzMDQ2",
    "user": {
      "login": "jgarzik",
      "id": 494411,
      "node_id": "MDQ6VXNlcjQ5NDQxMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/494411?u=0b02049ec38b6bb7d55c5c66d9bbeb0d4b822129&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jgarzik",
      "html_url": "https://github.com/jgarzik",
      "followers_url": "https://api.github.com/users/jgarzik/followers",
      "following_url": "https://api.github.com/users/jgarzik/following{/other_user}",
      "gists_url": "https://api.github.com/users/jgarzik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jgarzik/subscriptions",
      "organizations_url": "https://api.github.com/users/jgarzik/orgs",
      "repos_url": "https://api.github.com/users/jgarzik/repos",
      "events_url": "https://api.github.com/users/jgarzik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jgarzik/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2012-11-05T19:00:49Z",
    "updated_at": "2012-11-05T19:02:02Z",
    "author_association": "CONTRIBUTOR",
    "body": "\"custom and fragile\" is oversold, considering this is intentionally highly similar to Amazon S3's HMAC authentication scheme.  S3 must even deal with the same issue: picking a time window encompassing average client clock drift, without shutting out too many.  I think they chose 5 minutes.\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/10083046/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/10083337",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/1986#issuecomment-10083337",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/1986",
    "id": 10083337,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEwMDgzMzM3",
    "user": {
      "login": "gavinandresen",
      "id": 331997,
      "node_id": "MDQ6VXNlcjMzMTk5Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/331997?u=db313a954a318b81f5283d34908397d1ea3aeba3&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gavinandresen",
      "html_url": "https://github.com/gavinandresen",
      "followers_url": "https://api.github.com/users/gavinandresen/followers",
      "following_url": "https://api.github.com/users/gavinandresen/following{/other_user}",
      "gists_url": "https://api.github.com/users/gavinandresen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gavinandresen/subscriptions",
      "organizations_url": "https://api.github.com/users/gavinandresen/orgs",
      "repos_url": "https://api.github.com/users/gavinandresen/repos",
      "events_url": "https://api.github.com/users/gavinandresen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gavinandresen/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2012-11-05T19:08:17Z",
    "updated_at": "2012-11-05T19:08:17Z",
    "author_association": "CONTRIBUTOR",
    "body": "RE: times:  default should be 'as secure as possible.'  Users should sync their clocks (but an if (fDebug) printf(\"rpc timestamp out of sync...\") would be nice to make it easier to debug but not open up non -debug usage to flood-of-bad-authorization DoS attack).\n\nRE: custom and fragile:\n\nThis seems less fragile than the old, maybe-soon-to-be-broken, MD5-based HTTP digest authorization. Jeff: any reason this is highly similar to Amazon's scheme and not exactly the same?\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/10083337/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/10084019",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/1986#issuecomment-10084019",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/1986",
    "id": 10084019,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEwMDg0MDE5",
    "user": {
      "login": "gmaxwell",
      "id": 858454,
      "node_id": "MDQ6VXNlcjg1ODQ1NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/858454?u=63e5c438c242094837a9deeda775d77988b508bf&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gmaxwell",
      "html_url": "https://github.com/gmaxwell",
      "followers_url": "https://api.github.com/users/gmaxwell/followers",
      "following_url": "https://api.github.com/users/gmaxwell/following{/other_user}",
      "gists_url": "https://api.github.com/users/gmaxwell/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
      "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
      "repos_url": "https://api.github.com/users/gmaxwell/repos",
      "events_url": "https://api.github.com/users/gmaxwell/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2012-11-05T19:26:28Z",
    "updated_at": "2012-11-05T19:26:28Z",
    "author_association": "CONTRIBUTOR",
    "body": "I'm just concerned that we're solving things that weren't obvious a problem with novel cryptographic authentication protocols.   Even with authentication it is still unacceptable to run RPC across an insecure network because an active attacker can just intercept and replace RPC calls (not to mention sniffing the content)... and without connection persistence anything latency sensitive will still suffer.  And this will insert really confusing failure modes. I don't normally expect my client's clock to have to be in the right timezone.\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/10084019/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/10260979",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/1986#issuecomment-10260979",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/1986",
    "id": 10260979,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEwMjYwOTc5",
    "user": {
      "login": "gavinandresen",
      "id": 331997,
      "node_id": "MDQ6VXNlcjMzMTk5Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/331997?u=db313a954a318b81f5283d34908397d1ea3aeba3&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gavinandresen",
      "html_url": "https://github.com/gavinandresen",
      "followers_url": "https://api.github.com/users/gavinandresen/followers",
      "following_url": "https://api.github.com/users/gavinandresen/following{/other_user}",
      "gists_url": "https://api.github.com/users/gavinandresen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gavinandresen/subscriptions",
      "organizations_url": "https://api.github.com/users/gavinandresen/orgs",
      "repos_url": "https://api.github.com/users/gavinandresen/repos",
      "events_url": "https://api.github.com/users/gavinandresen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gavinandresen/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2012-11-10T22:55:21Z",
    "updated_at": "2012-11-10T22:55:46Z",
    "author_association": "CONTRIBUTOR",
    "body": "The DKIM RFC 6376 : http://www.ietf.org/rfc/rfc6376.txt ... also seems very similar.  It uses an explicit expiration time, which seems like the right thing to do.\n\nIt is overly complicated for this (e.g. we don't need multiple signature algorithms, don't need to specify which headers are part of the signature hash, etc), but I always like adopting or adapting an existing standard that experts have blessed instead of inventing our own.\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/10260979/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/10316647",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/1986#issuecomment-10316647",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/1986",
    "id": 10316647,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEwMzE2NjQ3",
    "user": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2012-11-13T05:59:01Z",
    "updated_at": "2012-11-13T05:59:01Z",
    "author_association": "MEMBER",
    "body": "Needs rebase\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/10316647/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/10434614",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/1986#issuecomment-10434614",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/1986",
    "id": 10434614,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEwNDM0NjE0",
    "user": {
      "login": "jgarzik",
      "id": 494411,
      "node_id": "MDQ6VXNlcjQ5NDQxMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/494411?u=0b02049ec38b6bb7d55c5c66d9bbeb0d4b822129&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jgarzik",
      "html_url": "https://github.com/jgarzik",
      "followers_url": "https://api.github.com/users/jgarzik/followers",
      "following_url": "https://api.github.com/users/jgarzik/following{/other_user}",
      "gists_url": "https://api.github.com/users/jgarzik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jgarzik/subscriptions",
      "organizations_url": "https://api.github.com/users/jgarzik/orgs",
      "repos_url": "https://api.github.com/users/jgarzik/repos",
      "events_url": "https://api.github.com/users/jgarzik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jgarzik/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2012-11-16T02:33:26Z",
    "updated_at": "2012-11-16T02:33:26Z",
    "author_association": "CONTRIBUTOR",
    "body": "Rebased.  Still need to address valid @gavinandresen etc. comments.\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/10434614/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/10663520",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/1986#issuecomment-10663520",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/1986",
    "id": 10663520,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEwNjYzNTIw",
    "user": {
      "login": "BitcoinPullTester",
      "id": 2110907,
      "node_id": "MDQ6VXNlcjIxMTA5MDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2110907?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/BitcoinPullTester",
      "html_url": "https://github.com/BitcoinPullTester",
      "followers_url": "https://api.github.com/users/BitcoinPullTester/followers",
      "following_url": "https://api.github.com/users/BitcoinPullTester/following{/other_user}",
      "gists_url": "https://api.github.com/users/BitcoinPullTester/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/BitcoinPullTester/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/BitcoinPullTester/subscriptions",
      "organizations_url": "https://api.github.com/users/BitcoinPullTester/orgs",
      "repos_url": "https://api.github.com/users/BitcoinPullTester/repos",
      "events_url": "https://api.github.com/users/BitcoinPullTester/events{/privacy}",
      "received_events_url": "https://api.github.com/users/BitcoinPullTester/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2012-11-23T16:02:56Z",
    "updated_at": "2012-11-23T16:02:56Z",
    "author_association": "NONE",
    "body": "Automatic sanity-testing: PASSED, see http://jenkins.bluematt.me/pull-tester/010cc65142f83b1045bc21b64cfe7cb46b8eff78 for binaries and test log.\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/10663520/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/18694001",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/1986#issuecomment-18694001",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/1986",
    "id": 18694001,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE4Njk0MDAx",
    "user": {
      "login": "jgarzik",
      "id": 494411,
      "node_id": "MDQ6VXNlcjQ5NDQxMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/494411?u=0b02049ec38b6bb7d55c5c66d9bbeb0d4b822129&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jgarzik",
      "html_url": "https://github.com/jgarzik",
      "followers_url": "https://api.github.com/users/jgarzik/followers",
      "following_url": "https://api.github.com/users/jgarzik/following{/other_user}",
      "gists_url": "https://api.github.com/users/jgarzik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jgarzik/subscriptions",
      "organizations_url": "https://api.github.com/users/jgarzik/orgs",
      "repos_url": "https://api.github.com/users/jgarzik/repos",
      "events_url": "https://api.github.com/users/jgarzik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jgarzik/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-05-30T17:00:28Z",
    "updated_at": "2013-05-30T17:00:28Z",
    "author_association": "CONTRIBUTOR",
    "body": "Closing.  Will reopen with closer integration with Amazon S3 spec, as per comments.\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/18694001/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/22891796",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/1986#issuecomment-22891796",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/1986",
    "id": 22891796,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIyODkxNzk2",
    "user": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-08-19T18:05:43Z",
    "updated_at": "2014-02-21T01:15:18Z",
    "author_association": "MEMBER",
    "body": "Found a bug. The initial request sends \"Connection: close\" header, but then if the server requests Basic auth instead, it sends the retry over the same socket (which is now closed).\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/22891796/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2031692",
    "pull_request_review_id": null,
    "id": 2031692,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwMzE2OTI=",
    "diff_hunk": "@@ -437,16 +438,101 @@ int ReadHTTP(std::basic_istream<char>& stream, map<string, string>& mapHeadersRe\n     return nStatus;\n }\n \n-bool HTTPAuthorized(map<string, string>& mapHeaders)\n+static bool HTTPAuthBasic(string& strAuth)\n {\n-    string strAuth = mapHeaders[\"authorization\"];\n-    if (strAuth.substr(0,6) != \"Basic \")\n-        return false;\n     string strUserPass64 = strAuth.substr(6); boost::trim(strUserPass64);\n     string strUserPass = DecodeBase64(strUserPass64);\n     return strUserPass == strRPCUserColonPass;\n }\n \n+static uint256 BitcoinHMAC(string& strKey, string& strText)\n+{\n+    uint256 hash;\n+\n+    // standard HMAC, using SHA256 as the hash\n+    HMAC(EVP_sha256(), strKey.c_str(), strKey.size(),\n+         (unsigned char *) strText.c_str(), strText.size(),\n+         (unsigned char *)&hash, NULL);\n+\n+    return hash;\n+}\n+\n+static uint256 BitcoinAuthHash(string &strKey, string& strUser,\n+                               string &strDate, string& strNonce,\n+                               const string &strBodyHash)\n+{\n+    // Format: username : timestamp : nonce : body double-hash (hex)\n+    string strText = strprintf(\"%s:%s:%s:%s\",\n+                               strUser.c_str(),\n+                               strDate.c_str(),\n+                               strNonce.c_str(),\n+                               strBodyHash.c_str());\n+\n+    return BitcoinHMAC(strKey, strText);\n+}\n+\n+static bool HTTPAuthBitcoin(string& strAuth, string& strRequest)\n+{\n+    // Format: Bitcoin SP $Username SP $Timestamp SP $Nonce SP $HMAC_hash (hex)\n+\n+    vector<string> vWords;\n+    boost::split(vWords, strAuth, boost::is_any_of(\" \"));\n+    if (vWords.size() != 5)\n+        return false;\n+\n+    // parse args\n+    if (vWords[0] != \"Bitcoin\")\n+        return false;\n+    string strUser = vWords[1];\n+    if (strUser != mapArgs[\"-rpcuser\"])\n+        return false;\n+    string strDate = vWords[2];",
    "path": "src/bitcoinrpc.cpp",
    "position": 75,
    "original_position": 64,
    "commit_id": "010cc65142f83b1045bc21b64cfe7cb46b8eff78",
    "original_commit_id": "5a3deedeff50a215506267b5adff76c8d4abbff7",
    "user": {
      "login": "gavinandresen",
      "id": 331997,
      "node_id": "MDQ6VXNlcjMzMTk5Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/331997?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gavinandresen",
      "html_url": "https://github.com/gavinandresen",
      "followers_url": "https://api.github.com/users/gavinandresen/followers",
      "following_url": "https://api.github.com/users/gavinandresen/following{/other_user}",
      "gists_url": "https://api.github.com/users/gavinandresen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gavinandresen/subscriptions",
      "organizations_url": "https://api.github.com/users/gavinandresen/orgs",
      "repos_url": "https://api.github.com/users/gavinandresen/repos",
      "events_url": "https://api.github.com/users/gavinandresen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gavinandresen/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "What is the format of strDate?  And shouldn't there be a check here to make sure strDate is reasonably close to the current time, to prevent replay attacks?\n",
    "created_at": "2012-11-05T16:52:00Z",
    "updated_at": "2012-11-16T02:10:44Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/1986#discussion_r2031692",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/1986",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2031692"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/1986#discussion_r2031692"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/1986"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2031692/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 528,
    "original_line": 489,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2031801",
    "pull_request_review_id": null,
    "id": 2031801,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwMzE4MDE=",
    "diff_hunk": "@@ -437,16 +438,101 @@ int ReadHTTP(std::basic_istream<char>& stream, map<string, string>& mapHeadersRe\n     return nStatus;\n }\n \n-bool HTTPAuthorized(map<string, string>& mapHeaders)\n+static bool HTTPAuthBasic(string& strAuth)\n {\n-    string strAuth = mapHeaders[\"authorization\"];\n-    if (strAuth.substr(0,6) != \"Basic \")\n-        return false;\n     string strUserPass64 = strAuth.substr(6); boost::trim(strUserPass64);\n     string strUserPass = DecodeBase64(strUserPass64);\n     return strUserPass == strRPCUserColonPass;\n }\n \n+static uint256 BitcoinHMAC(string& strKey, string& strText)\n+{\n+    uint256 hash;\n+\n+    // standard HMAC, using SHA256 as the hash\n+    HMAC(EVP_sha256(), strKey.c_str(), strKey.size(),\n+         (unsigned char *) strText.c_str(), strText.size(),\n+         (unsigned char *)&hash, NULL);\n+\n+    return hash;\n+}\n+\n+static uint256 BitcoinAuthHash(string &strKey, string& strUser,\n+                               string &strDate, string& strNonce,\n+                               const string &strBodyHash)\n+{\n+    // Format: username : timestamp : nonce : body double-hash (hex)\n+    string strText = strprintf(\"%s:%s:%s:%s\",\n+                               strUser.c_str(),\n+                               strDate.c_str(),\n+                               strNonce.c_str(),\n+                               strBodyHash.c_str());\n+\n+    return BitcoinHMAC(strKey, strText);\n+}\n+\n+static bool HTTPAuthBitcoin(string& strAuth, string& strRequest)\n+{\n+    // Format: Bitcoin SP $Username SP $Timestamp SP $Nonce SP $HMAC_hash (hex)\n+\n+    vector<string> vWords;\n+    boost::split(vWords, strAuth, boost::is_any_of(\" \"));\n+    if (vWords.size() != 5)\n+        return false;\n+\n+    // parse args\n+    if (vWords[0] != \"Bitcoin\")\n+        return false;\n+    string strUser = vWords[1];\n+    if (strUser != mapArgs[\"-rpcuser\"])\n+        return false;\n+    string strDate = vWords[2];",
    "path": "src/bitcoinrpc.cpp",
    "position": 75,
    "original_position": 64,
    "commit_id": "010cc65142f83b1045bc21b64cfe7cb46b8eff78",
    "original_commit_id": "5a3deedeff50a215506267b5adff76c8d4abbff7",
    "user": {
      "login": "jgarzik",
      "id": 494411,
      "node_id": "MDQ6VXNlcjQ5NDQxMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/494411?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jgarzik",
      "html_url": "https://github.com/jgarzik",
      "followers_url": "https://api.github.com/users/jgarzik/followers",
      "following_url": "https://api.github.com/users/jgarzik/following{/other_user}",
      "gists_url": "https://api.github.com/users/jgarzik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jgarzik/subscriptions",
      "organizations_url": "https://api.github.com/users/jgarzik/orgs",
      "repos_url": "https://api.github.com/users/jgarzik/repos",
      "events_url": "https://api.github.com/users/jgarzik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jgarzik/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "1) Format:  Unix time (number of seconds since epoch)\n\n2) Yes, there should be a check.  See main pull req discussion, querying the best time window.\n",
    "created_at": "2012-11-05T16:59:14Z",
    "updated_at": "2012-11-16T02:10:44Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/1986#discussion_r2031801",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/1986",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2031801"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/1986#discussion_r2031801"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/1986"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2031801/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 528,
    "original_line": 489,
    "side": "RIGHT"
  }
]